import{_ as O}from"./Result-DgP0Q5NP.js";import{e as Q,b as j,u as J,d as X,g as Y,h as b,L as Z,f as ee,a3 as te,a4 as ae,c as y,l as e,o as r,k as m,a as t,y as f,E as g,ab as le,w as a,q as n,t as s,p as k,F as L,v as oe,x as se,W as re,G as M,P as $,Q as B,A as ne,a6 as E,a7 as ie,R as ue}from"./index-DSqAz1aK.js";import{r as ce}from"./room-Bs-z0h-W.js";import{C as de}from"./vue3-count-to.esm-DyWadWtW.js";import{e as me}from"./eventBus-B8tShFcG.js";import{V as fe}from"./VTextField-l-FdgV9P.js";import{V as w}from"./VRow-DoMtucbK.js";import{V as d}from"./VCol-Q6N_ObRy.js";import{V as F,c as pe,a as ge}from"./VCard-DJ_zJ5IC.js";import{V as x}from"./VChip-DOXEbDsk.js";import{V as he}from"./VMenu-D73OD9NE.js";import{V as _e}from"./VList-BEO0zeM6.js";import{V as ve}from"./VSparkline-DibYNqe6.js";import{V as be}from"./VPagination-CiEfj4as.js";import"./VContainer-B5popFB1.js";/* empty css              */import"./axios-lI9Ovfql.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-9rJqgBB5.js";import"./VInput-BKyi7uEB.js";import"./VSlideGroup-BYN7qME8.js";import"./dialog-transition-BcXBGmd8.js";import"./ssrBoot-DOEArNsD.js";const ye={class:"fcc"},we={class:"fcb"},Ve={class:"fcc"},ke=["onClick"],xe={class:"text-caption text-grey"},Ce={class:"text-h3 font-weight-black"},Ne={key:1},ze={key:1},Me={key:2},Ze={__name:"index",setup(Se){const{mobile:i}=Q(),{t:l}=j(),W=J(),C=X(),N=Y(),V=b(window.innerHeight),G=()=>Math.max(2,Math.floor((V.value-204)/300)*2),u=b({gameName:"",page:1,pageSize:0}),S=b([]),T=b(0),R=b(!1),h=async()=>{R.value=!0;const c=await ce.list.get(u.value);S.value=c.data.rows||[],T.value=c.data.total,R.value=!1},H=async()=>{N.room={id:0,gameName:""},U(),await W.push("/game/base")},U=()=>{me.emit("toggleMenu",3)},q=c=>{N.room.id=c.id,N.room.gameName=c.gameName},D=c=>{if(c.length===0)return[0,0];const p=[];for(let _ of c)p.push(_.playerInfo?.length||0);return p},z=b(),I=b(0),P=()=>Math.max(2,Math.floor(V.value-120));Z(V,()=>{h()},{immediate:!1});const A=te(()=>{V.value=window.innerHeight,u.value.pageSize=G(),z.value&&(I.value=z.value.$el.offsetWidth)},200);return ee(async()=>{u.value.pageSize=G(),z.value&&(I.value=z.value.$el.offsetWidth),await h(),window.addEventListener("resize",A)}),ae(()=>{window.removeEventListener("resize",A)}),(c,p)=>{const _=O;return e(N).gameVersion.local!==0?(r(),y(L,{key:0},[m("div",ye,[t(fe,{modelValue:e(u).gameName,"onUpdate:modelValue":p[0]||(p[0]=o=>e(u).gameName=o),label:e(l)("rooms.header.input.label"),placeholder:e(l)("rooms.header.input.placeholder"),"append-inner-icon":"ri-search-line",class:"mr-4",loading:e(R),"onClick:appendInner":h,onKeyup:le(h,["enter"])},null,8,["modelValue","label","placeholder","loading"]),e(i)?g("",!0):(r(),f(k,{key:0,disabled:!e(C).userInfo.roomCreation&&e(C).userInfo.role!=="admin","prepend-icon":"ri-add-line",variant:"elevated",size:"large",class:"mr-4",onClick:H},{default:a(()=>[n(s(e(l)("rooms.header.button.create")),1)]),_:1},8,["disabled"])),e(i)?g("",!0):(r(),f(k,{key:1,"prepend-icon":"ri-refresh-line",color:"default",variant:"elevated",size:"large",onClick:h},{default:a(()=>[n(s(e(l)("rooms.header.button.refresh")),1)]),_:1})),e(i)?(r(),f(k,{key:2,disabled:!e(C).userInfo.roomCreation&&e(C).userInfo.role!=="admin",icon:"ri-add-line",class:"mr-4",onClick:H},null,8,["disabled"])):g("",!0),e(i)?(r(),f(k,{key:3,icon:"ri-refresh-line",color:"default",onClick:h})):g("",!0)]),t(w,{class:"mt-8"},{default:a(()=>[t(w,{class:"mx-1"},{default:a(()=>[(r(!0),y(L,null,oe(e(S),(o,K)=>(r(),f(d,{cols:e(i)?12:6},{default:a(()=>[t(F,{ref_for:!0,ref:v=>{K===0&&(z.value=v)},hover:!0,variant:"flat",height:e(i)?"600px":"300px"},{default:a(()=>[t(pe,null,{default:a(()=>[m("div",we,[m("div",Ve,[t(x,{color:"primary"},{default:a(()=>[n(s(e(re)(o.gameName,e(i)?8:15)),1)]),_:2},1024),t(x,{color:o.status?"success":"warning",class:"ml-4"},{default:a(()=>[n(s(o.status?e(l)("rooms.card.success.header.title.activated"):e(l)("rooms.card.success.header.title.deactivated")),1)]),_:2},1032,["color"]),e(N).room.id===o.id?(r(),f(M,{key:0,icon:"ri-crosshair-2-line",color:"info",class:"ml-4"})):g("",!0)]),t(he,null,{activator:a(({props:v})=>[t(k,ne({ref_for:!0},v,{disabled:e(R),color:"primary",icon:"ri-more-2-line"}),null,16,["disabled"])]),default:a(()=>[t(_e,null,{default:a(()=>[t($,{class:"text-success",onClick:v=>console.log(o.name)},{prepend:a(()=>[t(M,{icon:"ri-play-large-line",size:"22"})]),default:a(()=>[t(B,null,{default:a(()=>[n(s(e(l)("rooms.card.success.header.menu.activate")),1)]),_:1})]),_:1},8,["onClick"]),t($,{class:"text-warning",onClick:v=>console.log(o.name)},{prepend:a(()=>[t(M,{icon:"ri-stop-large-line",color:"warning",size:"22"})]),default:a(()=>[t(B,null,{default:a(()=>[n(s(e(l)("rooms.card.success.header.menu.deactivate")),1)]),_:1})]),_:1},8,["onClick"]),t($,{class:"text-error",onClick:v=>console.log(o.name)},{prepend:a(()=>[t(M,{icon:"ri-delete-bin-line",color:"error",size:"22"})]),default:a(()=>[t(B,null,{default:a(()=>[n(s(e(l)("rooms.card.success.header.menu.delete")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024),se((r(),f(ge,null,{default:a(()=>[o.gameName!==""?(r(),y("div",{key:0,class:"mt-4",onClick:v=>q(o)},[t(w,null,{default:a(()=>[t(d,{cols:e(i)?12:6},{default:a(()=>[t(w,null,{default:a(()=>[t(d,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.gameMode")),1)]),_:1}),t(d,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(e(l)(`game.base.step1.gameMode.modes.${o.gameMode}`)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(w,null,{default:a(()=>[t(d,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.worldNum")),1)]),_:1}),t(d,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(o.worlds.length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(w,null,{default:a(()=>[t(d,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.modNum")),1)]),_:1}),t(d,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(o.modInOne?e(E)(o.modData).length:e(E)(o.worlds[0].modData).length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(w,null,{default:a(()=>[t(d,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.playerNum")),1)]),_:1}),t(d,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(o.maxPlayer),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"]),t(d,{cols:e(i)?12:6},{default:a(()=>[t(F,{height:240,variant:"flat"},{prepend:a(()=>[t(M,{color:"primary",class:"me-8",icon:"ri-line-chart-line",size:"48"})]),title:a(()=>[m("div",xe,s(e(l)("rooms.card.success.text.right.chartTitle")),1),m("span",Ce,[t(e(de),{duration:4e3,"end-val":Math.max(...D(o.players)),"start-val":0},null,8,["end-val"])]),m("strong",null,s(e(l)("rooms.card.success.text.right.unit")),1)]),default:a(()=>[t(ie,{color:"transparent"},{default:a(()=>[t(ve,{width:e(i)?e(I):e(I)/2,gradient:["#1feaea"],"line-width":3,"model-value":D(o.players),smooth:!0,padding:"8","stroke-linecap":"round","auto-draw":""},null,8,["width","model-value"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"])]),_:2},1024)],8,ke)):(r(),y("div",Ne,[t(_,{type:"warning",height:e(i)?600:300,title:e(l)("rooms.card.warning.title"),"sub-title":e(l)("rooms.card.warning.subTitle")},null,8,["height","title","sub-title"])]))]),_:2},1024)),[[ue]])]),_:2},1032,["height"])]),_:2},1032,["cols"]))),256))]),_:1})]),_:1}),e(T)>e(u).pageSize?(r(),f(be,{key:0,modelValue:e(u).page,"onUpdate:modelValue":[p[1]||(p[1]=o=>e(u).page=o),h],length:Math.max(1,Math.ceil(e(T)/e(u).pageSize)),class:"mt-8"},null,8,["modelValue","length"])):g("",!0),e(S).length===0&&e(u).gameName!==""?(r(),y("div",ze,[t(_,{type:"warning",height:e(V),title:e(l)("rooms.result.noResult.title"),"sub-title":e(l)("rooms.result.noResult.subTitle")},null,8,["height","title","sub-title"])])):g("",!0),e(S).length===0&&e(u).gameName===""?(r(),y("div",Me,[t(_,{type:"warning",height:e(V),title:e(l)("rooms.result.noRoom.title"),"sub-title":e(l)("rooms.result.noRoom.subTitle")},null,8,["height","title","sub-title"])])):g("",!0)],64)):(r(),y(L,{key:1},[e(C).userInfo.role==="admin"?(r(),f(_,{key:0,title:e(l)("global.noGame.title"),"sub-title":e(l)("global.noGame.subTitle"),height:P(),type:"error"},{default:a(()=>[t(k,{to:"/install",class:"mt-4"},{default:a(()=>[n(s(e(l)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(r(),f(_,{key:1,title:e(l)("global.noGameNoAdmin.title"),"sub-title":e(l)("global.noGameNoAdmin.subTitle"),height:P(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{Ze as default};
