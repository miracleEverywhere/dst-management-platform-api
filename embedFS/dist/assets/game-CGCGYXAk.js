import M from"./log-BwWvnAeZ.js";import{h as _}from"./axios-dEuv8C7T.js";import{r as B}from"./room-Cfkea4h9.js";import{g as N,h as r,f as R,a8 as S,Y as k,A as q,o as D,w as o,a as t,ab as H,k as f,l as i,x as V,v as C,p as T,s as U,V as z}from"./index-CMKCSYdO.js";import{V as A}from"./VSelect-DXelBhLk.js";import{V as E}from"./VSwitch-jkY9WoMY.js";import{V as F}from"./VChip-Bk2gsPMH.js";import{V as W}from"./VRow-DoAY8C7w.js";import{V as $}from"./VSpacer-CcHR815e.js";import{V as j}from"./VCol-BFJpflil.js";import{V as P}from"./VNumberInput-9QZhnGS_.js";import"./VTextField-DSK81GDs.js";import"./index-DGBzjDo7.js";import"./VInput-BVFTscmb.js";import"./VList-BeTdI8h_.js";import"./ssrBoot-CJNhhsY7.js";import"./VDivider-Cxv4jZxD.js";import"./VMenu-iADqZB_W.js";import"./dialog-transition-1BFQW-Tr.js";import"./VSelectionControl-DRxzzoA5.js";import"./VSlideGroup-Br9BzrjI.js";/* empty css              */const Y={content:{url:"/logs/content",get:async function(v){return await _.get(this.url,v)}}},G={class:"card-header"},J={class:"fcc"},ge={__name:"game",setup(v){const g=N(),d=r(""),l=r(0),m=r(!0),a=r(0),w=()=>{if(l.value===0)return;const s={roomID:g.room.id,worldID:l.value,logType:"game",lines:a.value};Y.content.get(s).then(e=>{d.value=e.data.join(`
`)})},c=r([]),I=async()=>{const s={roomID:g.room.id},e=await B.worlds.get(s);c.value=e.data,l.value=c.value[0]?.id||0};let u=null;const L=()=>{u=setInterval(()=>{m.value&&w()},2e3)},h=()=>{u&&(clearInterval(u),u=null)},b=()=>Math.round(Math.max(2,Math.floor(p.value-390))/22.5),x=()=>Math.max(2,Math.floor(p.value-160)),p=r(window.innerHeight),y=S(()=>{p.value=window.innerHeight,a.value=b()},200);return R(async()=>{window.addEventListener("resize",y),await I(),a.value=b(),L()}),k(()=>{h(),window.removeEventListener("beforeunload",h),window.removeEventListener("resize",y)}),(s,e)=>(D(),q(z,{height:x()},{default:o(()=>[t(H,{class:"my-2"},{default:o(()=>[f("div",G,[e[5]||(e[5]=f("span",null,"游戏日志",-1)),f("div",J,[t(A,{modelValue:i(l),"onUpdate:modelValue":[e[0]||(e[0]=n=>V(l)?l.value=n:null),e[1]||(e[1]=n=>d.value="")],items:i(c),"item-title":"worldName","item-value":"id",label:"世界",density:"compact",class:"mr-4"},null,8,["modelValue","items"]),t(E,{modelValue:i(m),"onUpdate:modelValue":e[2]||(e[2]=n=>V(m)?m.value=n:null),color:"info","hide-details":""},{prepend:o(()=>[t(F,{color:"info"},{default:o(()=>[...e[4]||(e[4]=[C(" 自动刷新 ",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),_:1}),t(T,null,{default:o(()=>[t(M,{content:i(d),height:x()-150},null,8,["content","height"]),t(W,{class:"my-4"},{default:o(()=>[t($),t(j,{cols:"6",md:"2",class:"fcc"},{default:o(()=>[t(P,{modelValue:i(a),"onUpdate:modelValue":e[3]||(e[3]=n=>V(a)?a.value=n:null),label:"行","hide-details":"",density:"compact",class:"mr-4"},null,8,["modelValue"]),t(U,{onClick:w},{default:o(()=>[...e[6]||(e[6]=[C(" 刷新 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["height"]))}};export{ge as default};
