import L from"./log-BlEttoQu.js";import{l as M}from"./logs-Cl1JhOP1.js";import{r as N}from"./room-CKn3OSGJ.js";import{g as _,h as s,f as q,a3 as B,N as R,y as S,o as k,w as o,a as t,k as f,l as i,s as V,q as I,p as D}from"./index-CBjUexYG.js";import{c as H,a as T,V as U}from"./VCard-Dcae7csx.js";import{V as z}from"./VSelect-BBiWe61W.js";import{V as E}from"./VSwitch-DjpuNuAg.js";import{V as A}from"./VChip-IzQUOK91.js";import{V as F}from"./VRow-Bj3h_q5V.js";import{V as W}from"./VSpacer-BHp0DjOQ.js";import{V as $}from"./VCol-B45jb4cO.js";import{V as j}from"./VNumberInput-BWm29x0J.js";import"./axios-KbiksPFU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VTextField-DbONA2f3.js";import"./index-Cyt7-BUT.js";import"./VInput-k_ad5GzK.js";import"./VList-DnzQkVfF.js";import"./ssrBoot-Cy1jdUTU.js";import"./VMenu-uy8W7KRE.js";import"./dialog-transition-D112y9Z-.js";import"./VCheckboxBtn-Bs4X0880.js";import"./VSelectionControl-DM_cupWE.js";import"./VSlideGroup-BTJY2N2a.js";/* empty css              */const P={class:"card-header"},G={class:"fcc"},he={__name:"game",setup(J){const v=_(),u=s(""),l=s(0),m=s(!0),a=s(0),w=()=>{if(l.value===0)return;const n={roomID:v.room.id,worldID:l.value,logType:"game",lines:a.value};M.content.get(n).then(e=>{u.value=e.data.join(`
`)})},p=s([]),b=async()=>{const n={roomID:v.room.id},e=await N.worlds.get(n);p.value=e.data,l.value=p.value[0]?.id||0};let d=null;const x=()=>{d=setInterval(()=>{m.value&&w()},2e3)},g=()=>{d&&(clearInterval(d),d=null)},h=()=>Math.round(Math.max(2,Math.floor(c.value-390))/22.5),y=()=>Math.max(2,Math.floor(c.value-160)),c=s(window.innerHeight),C=B(()=>{c.value=window.innerHeight,a.value=h()},200);return q(async()=>{window.addEventListener("resize",C),await b(),a.value=h(),x()}),R(()=>{g(),window.removeEventListener("beforeunload",g),window.removeEventListener("resize",C)}),(n,e)=>(k(),S(U,{height:y()},{default:o(()=>[t(H,{class:"my-2"},{default:o(()=>[f("div",P,[e[5]||(e[5]=f("span",null,"游戏日志",-1)),f("div",G,[t(z,{modelValue:i(l),"onUpdate:modelValue":[e[0]||(e[0]=r=>V(l)?l.value=r:null),e[1]||(e[1]=r=>u.value="")],items:i(p),"item-title":"worldName","item-value":"id",label:"世界",density:"compact",class:"mr-4"},null,8,["modelValue","items"]),t(E,{modelValue:i(m),"onUpdate:modelValue":e[2]||(e[2]=r=>V(m)?m.value=r:null),color:"info","hide-details":""},{prepend:o(()=>[t(A,{color:"info"},{default:o(()=>[...e[4]||(e[4]=[I(" 自动刷新 ",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),_:1}),t(T,null,{default:o(()=>[t(L,{content:i(u),height:y()-150},null,8,["content","height"]),t(F,{class:"my-4"},{default:o(()=>[t(W),t($,{cols:"6",md:"2",class:"fcc"},{default:o(()=>[t(j,{modelValue:i(a),"onUpdate:modelValue":e[3]||(e[3]=r=>V(a)?a.value=r:null),label:"行","hide-details":"",density:"compact",class:"mr-4"},null,8,["modelValue"]),t(D,{onClick:w},{default:o(()=>[...e[6]||(e[6]=[I(" 刷新 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["height"]))}};export{he as default};
