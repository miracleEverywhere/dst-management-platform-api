import{_ as te}from"./Result-DBHzZK3h.js";import{e as ae,b as le,u as se,d as oe,g as ie,h as _,L as re,f as ne,a4 as ce,a5 as de,c as k,l as e,o as i,k as h,a,y as f,E as v,ac as ue,w as t,q as c,t as r,p as x,F as B,v as me,x as fe,W as ge,G as S,P as D,Q as G,A as he,a7 as K,a8 as pe,R as _e,B as O}from"./index-7Da7c_Ya.js";import{r as H}from"./room-BxaTXAUM.js";import{C as ve}from"./vue3-count-to.esm-DBXPiHM4.js";import{e as be}from"./eventBus-B8tShFcG.js";import{V as ye}from"./VTextField-DxxG2cPN.js";import{V as w}from"./VRow-BiQYX2vy.js";import{V as g}from"./VCol-CUWeDHjo.js";import{V as Q,c as ke,a as we}from"./VCard-CfP9hJBJ.js";import{V as C}from"./VChip-CKZVCmsW.js";import{V as Ve}from"./VMenu-s7FWuH_t.js";import{V as xe}from"./VList-Ti-qYX1c.js";import{V as Ce}from"./VSparkline-C1Z_mvjc.js";import{V as Ne}from"./VPagination-TFfaezZr.js";import"./VContainer-C3TPu6F4.js";/* empty css              */import"./axios-Cf6GdeVA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DgH_XViZ.js";import"./VInput-XKGaG4uV.js";import"./dialog-transition-r1KftaBw.js";import"./ssrBoot-CW_5PvrP.js";const ze={class:"fcc"},Se={class:"fcb"},Me={class:"fcc"},Ie=["onClick"],Re={class:"text-caption text-grey"},Le={class:"text-h3 font-weight-black"},Te={key:1},$e={key:1},Be={key:2},ot={__name:"index",setup(De){const{mobile:d}=ae(),{t:l}=le(),F=se(),N=oe(),b=ie(),V=_(window.innerHeight),A=()=>Math.max(2,Math.floor((V.value-204)/300)*2),u=_({gameName:"",page:1,pageSize:0}),M=_([]),L=_(0),I=_(!1),p=async()=>{I.value=!0;const o=await H.list.get(u.value);M.value=o.data.rows||[],L.value=o.data.total,I.value=!1},P=async()=>{b.room={id:0,gameName:""},j(),await F.push("/game/base")},j=()=>{be.emit("toggleMenu",3)},J=o=>{b.room.id=o.id,b.room.gameName=o.gameName},X=async o=>{b.room.id=o.id,b.room.gameName=o.gameName,await F.push("/dashboard")},q=o=>{if(o.length===0)return[0,0];const n=[];for(let m of o)n.push(m.playerInfo?.length||0);return n},E=(o,n)=>{switch(o){case"activate":Y(n);break;case"deactivate":Z(n);break}},T=_(!1),Y=o=>{T.value=!0;const n={roomID:o.id};H.activate.post(n).then(m=>{O(m.message),p()}).finally(()=>{T.value=!1})},$=_(!1),Z=o=>{$.value=!0;const n={roomID:o.id};H.deactivate.post(n).then(m=>{O(m.message),p()}).finally(()=>{$.value=!1})},z=_(),R=_(0),W=()=>Math.max(2,Math.floor(V.value-120));re(V,()=>{p()},{immediate:!1});const U=ce(()=>{V.value=window.innerHeight,u.value.pageSize=A(),z.value&&(R.value=z.value.$el.offsetWidth)},200);return ne(async()=>{u.value.pageSize=A(),await p(),z.value&&(R.value=z.value.$el.offsetWidth),window.addEventListener("resize",U)}),de(()=>{window.removeEventListener("resize",U)}),(o,n)=>{const m=te;return e(b).gameVersion.local!==0?(i(),k(B,{key:0},[h("div",ze,[a(ye,{modelValue:e(u).gameName,"onUpdate:modelValue":n[0]||(n[0]=s=>e(u).gameName=s),label:e(l)("rooms.header.input.label"),placeholder:e(l)("rooms.header.input.placeholder"),"append-inner-icon":"ri-search-line",class:"mr-4",loading:e(I),"onClick:appendInner":p,onKeyup:ue(p,["enter"])},null,8,["modelValue","label","placeholder","loading"]),e(d)?v("",!0):(i(),f(x,{key:0,disabled:!e(N).userInfo.roomCreation&&e(N).userInfo.role!=="admin","prepend-icon":"ri-add-line",variant:"elevated",size:"large",class:"mr-4",onClick:P},{default:t(()=>[c(r(e(l)("rooms.header.button.create")),1)]),_:1},8,["disabled"])),e(d)?v("",!0):(i(),f(x,{key:1,"prepend-icon":"ri-refresh-line",color:"default",variant:"elevated",size:"large",onClick:p},{default:t(()=>[c(r(e(l)("rooms.header.button.refresh")),1)]),_:1})),e(d)?(i(),f(x,{key:2,disabled:!e(N).userInfo.roomCreation&&e(N).userInfo.role!=="admin",icon:"ri-add-line",class:"mr-4",onClick:P},null,8,["disabled"])):v("",!0),e(d)?(i(),f(x,{key:3,icon:"ri-refresh-line",color:"default",onClick:p})):v("",!0)]),a(w,{class:"mt-8"},{default:t(()=>[a(w,{class:"mx-1"},{default:t(()=>[(i(!0),k(B,null,me(e(M),(s,ee)=>(i(),f(g,{cols:e(d)?12:6},{default:t(()=>[a(Q,{ref_for:!0,ref:y=>{ee===0&&(z.value=y)},hover:!0,variant:"flat",height:"300px"},{default:t(()=>[a(ke,null,{default:t(()=>[h("div",Se,[h("div",Me,[a(C,{color:"primary"},{default:t(()=>[c(r(e(ge)(s.gameName,e(d)?8:15)),1)]),_:2},1024),a(C,{color:s.status?"success":"warning",class:"ml-4"},{default:t(()=>[c(r(s.status?e(l)("rooms.card.success.header.title.activated"):e(l)("rooms.card.success.header.title.deactivated")),1)]),_:2},1032,["color"]),e(b).room.id===s.id?(i(),f(S,{key:0,icon:"ri-crosshair-2-line",color:"info",class:"ml-4"})):v("",!0)]),a(Ve,null,{activator:t(({props:y})=>[a(x,he({ref_for:!0},y,{disabled:e(I),loading:e(T)||e($),color:"primary",icon:"ri-more-2-line"}),null,16,["disabled","loading"])]),default:t(()=>[a(xe,null,{default:t(()=>[a(D,{class:"text-success",onClick:y=>X(s)},{prepend:t(()=>[a(S,{icon:"ri-checkbox-circle-line",size:"22"})]),default:t(()=>[a(G,null,{default:t(()=>[c(r(e(l)("rooms.card.success.header.menu.select")),1)]),_:1})]),_:1},8,["onClick"]),a(D,{class:"text-success",disabled:s.status,onClick:y=>E("activate",s)},{prepend:t(()=>[a(S,{icon:"ri-play-large-line",size:"22"})]),default:t(()=>[a(G,null,{default:t(()=>[c(r(e(l)("rooms.card.success.header.menu.activate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),a(D,{class:"text-warning",disabled:!s.status,onClick:y=>E("deactivate",s)},{prepend:t(()=>[a(S,{icon:"ri-stop-large-line",color:"warning",size:"22"})]),default:t(()=>[a(G,null,{default:t(()=>[c(r(e(l)("rooms.card.success.header.menu.deactivate")),1)]),_:1})]),_:1},8,["disabled","onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024),fe((i(),f(we,null,{default:t(()=>[s.gameName!==""?(i(),k("div",{key:0,class:"mt-4",onClick:y=>J(s)},[a(w,null,{default:t(()=>[a(g,{cols:e(d)?12:6},{default:t(()=>[a(w,null,{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[h("span",null,r(e(l)("rooms.card.success.text.left.gameMode")),1)]),_:1}),a(g,{cols:"6"},{default:t(()=>[a(C,{color:"info",label:""},{default:t(()=>[c(r(e(l)(`game.base.step1.gameMode.modes.${s.gameMode}`)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(w,null,{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[h("span",null,r(e(l)("rooms.card.success.text.left.worldNum")),1)]),_:1}),a(g,{cols:"6"},{default:t(()=>[a(C,{color:"info",label:""},{default:t(()=>[c(r(s.worlds.length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(w,null,{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[h("span",null,r(e(l)("rooms.card.success.text.left.modNum")),1)]),_:1}),a(g,{cols:"6"},{default:t(()=>[a(C,{color:"info",label:""},{default:t(()=>[c(r(s.modInOne?e(K)(s.modData).length:e(K)(s.worlds[0].modData).length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(w,null,{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[h("span",null,r(e(l)("rooms.card.success.text.left.playerNum")),1)]),_:1}),a(g,{cols:"6"},{default:t(()=>[a(C,{color:"info",label:""},{default:t(()=>[c(r(s.maxPlayer),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"]),e(d)?v("",!0):(i(),f(g,{key:0,cols:e(d)?12:6},{default:t(()=>[a(Q,{height:240,variant:"flat"},{prepend:t(()=>[a(S,{color:"primary",class:"me-8",icon:"ri-line-chart-line",size:"48"})]),title:t(()=>[h("div",Re,r(e(l)("rooms.card.success.text.right.chartTitle")),1),h("span",Le,[a(e(ve),{duration:4e3,"end-val":Math.max(...q(s.players)),"start-val":0},null,8,["end-val"])]),h("strong",null,r(e(l)("rooms.card.success.text.right.unit")),1)]),default:t(()=>[a(pe,{color:"transparent"},{default:t(()=>[a(Ce,{width:e(d)?e(R):e(R)/2,gradient:["#1feaea"],"line-width":3,"model-value":q(s.players),smooth:!0,padding:"8","stroke-linecap":"round","auto-draw":""},null,8,["width","model-value"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"]))]),_:2},1024)],8,Ie)):(i(),k("div",Te,[a(m,{type:"warning",height:e(d)?600:300,title:e(l)("rooms.card.warning.title"),"sub-title":e(l)("rooms.card.warning.subTitle")},null,8,["height","title","sub-title"])]))]),_:2},1024)),[[_e]])]),_:2},1536)]),_:2},1032,["cols"]))),256))]),_:1})]),_:1}),e(L)>e(u).pageSize?(i(),f(Ne,{key:0,modelValue:e(u).page,"onUpdate:modelValue":[n[1]||(n[1]=s=>e(u).page=s),p],length:Math.max(1,Math.ceil(e(L)/e(u).pageSize)),class:"mt-8"},null,8,["modelValue","length"])):v("",!0),e(M).length===0&&e(u).gameName!==""?(i(),k("div",$e,[a(m,{type:"warning",height:e(V),title:e(l)("rooms.result.noResult.title"),"sub-title":e(l)("rooms.result.noResult.subTitle")},null,8,["height","title","sub-title"])])):v("",!0),e(M).length===0&&e(u).gameName===""?(i(),k("div",Be,[a(m,{type:"warning",height:e(V),title:e(l)("rooms.result.noRoom.title"),"sub-title":e(l)("rooms.result.noRoom.subTitle")},null,8,["height","title","sub-title"])])):v("",!0)],64)):(i(),k(B,{key:1},[e(N).userInfo.role==="admin"?(i(),f(m,{key:0,title:e(l)("global.noGame.title"),"sub-title":e(l)("global.noGame.subTitle"),height:W(),type:"error"},{default:t(()=>[a(x,{to:"/install",class:"mt-4"},{default:t(()=>[c(r(e(l)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(i(),f(m,{key:1,title:e(l)("global.noGameNoAdmin.title"),"sub-title":e(l)("global.noGameNoAdmin.subTitle"),height:W(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{ot as default};
