import{_ as he}from"./Result-CwhhmzAu.js";import{ac as H,ad as M,h as S,j as x,ae as X,a,k as I,af as W,F as B,A as G,an as Y,cv as be,ak as F,al as Ve,cc as N,P as Z,H as we,p as J,a9 as Ie,z as ye,G as D,aH as ke,aI as xe,cw as z,aQ as Le,as as Ce,U as _e,Z as Ae,$ as k,am as te,ar as Pe,Y as Te,e as Se,b as Ge,g as Be,d as Re,a1 as ne,f as De,a3 as Oe,r as je,c as $,l,o as _,w as u,a7 as ze,E as ae,t as R,s as K,y as j,q,B as Q}from"./index-CSEZG5G6.js";import{r as $e}from"./room-D-nKwFXb.js";import{V as le}from"./VCol-B2984NQ-.js";import{V as qe,a as Ee}from"./VToolbar-BM71y270.js";import{V as Fe}from"./VDialog-CT3sbCH0.js";import{V as Ne,a as Ue}from"./VCard-BL1j-OcQ.js";import{V as He}from"./VAlert-CEvD-mRx.js";import{V as Me,a as ie}from"./VRadioGroup-BZTkxwKN.js";import{V as Ke}from"./VChip-DXlk2YaI.js";import{V as Qe,a as E}from"./VExpansionPanels-BnMUaO_L.js";import{V as oe}from"./VRow-Da0Ja_x_.js";import{b as re,c as We,a as Ye,d as Ze,V as se,e as Je}from"./VList-DWSnpUg8.js";import{V as ce}from"./VListItemAction-NVJANE1o.js";import{V as Xe}from"./VCheckboxBtn-C1zLx64S.js";import{u as et,m as tt}from"./filter-M1OkVObf.js";import"./VContainer-CcX6R_Cm.js";/* empty css              */import"./axios-B1uS2EtD.js";import"./index-BTquysF0.js";import"./dialog-transition-Cta2BUts.js";import"./VSelectionControl-CzrMTBrL.js";import"./VInput-DzbtYzdA.js";import"./ssrBoot-CO9u9Llw.js";function nt(e){let{depth:m,isLast:t,isLastGroup:h,leafLinks:b,separateRoots:s,parentIndentLines:i,variant:v}=e;const n=t&&(!h||s||m>1);return!i||!m?{leaf:void 0,node:void 0,children:i,footer:i&&(!n||v==="simple")?[...i,s?"none":"line"]:["none"]}:v==="simple"?{leaf:[...i,"line"],node:[...i,"line"],children:[...i,"line"],footer:[...i,"line","line"]}:{leaf:[...i,n?"last-leaf":"leaf",...b?["leaf-link"]:[]],node:[...i,n?"last-leaf":"leaf"],children:[...i,n?"none":"line"],footer:[...i,n?"none":"line"]}}const at=M({...Y(We({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand"}),["subgroup"])},"VTreeviewGroup"),de=H()({name:"VTreeviewGroup",props:at(),setup(e,m){let{slots:t}=m;const h=S(),b=x(()=>h.value?.isOpen?e.collapseIcon:e.expandIcon),s=x(()=>({VTreeviewItem:{prependIcon:void 0,appendIcon:void 0,toggleIcon:b.value}}));return X(()=>{const i=re.filterProps(e);return a(re,G(i,{ref:h,class:["v-treeview-group",e.class],subgroup:!0}),{...t,activator:t.activator?v=>I(B,null,[a(W,{defaults:s.value},{default:()=>[t.activator?.(v)]})]):void 0})}),{}}}),ve=Symbol.for("vuetify:v-treeview"),fe=M({loading:Boolean,hideActions:Boolean,hasCustomPrepend:Boolean,indentLines:Array,toggleIcon:F,...be({slim:!0})},"VTreeviewItem"),ue=H()({name:"VTreeviewItem",props:fe(),emits:{toggleExpand:e=>!0},setup(e,m){let{slots:t,emit:h}=m;const b=Ve(ve,{visibleIds:S()}).visibleIds,s=S(),i=x(()=>s.value?.root.activatable.value&&s.value?.isGroupActivator),v=x(()=>s.value?.link.isClickable.value||e.value!=null&&!!s.value?.list),n=x(()=>!e.disabled&&e.link!==!1&&(e.link||v.value||i.value)),g=x(()=>b.value&&!b.value.has(N(s.value?.id)));function A(o){n.value&&i.value&&s.value?.activate(!s.value?.isActivated,o)}function w(o){o.preventDefault(),o.stopPropagation(),h("toggleExpand",o)}return X(()=>{const o=Z.filterProps(e),y=t.prepend||e.toggleIcon||e.indentLines||e.prependIcon||e.prependAvatar;return a(Z,G({ref:s},o,{active:s.value?.isActivated||void 0,class:["v-treeview-item",{"v-treeview-item--activatable-group-activator":i.value,"v-treeview-item--filtered":g.value},e.class],ripple:!1,onClick:A}),{...t,prepend:y?P=>I(B,null,[e.indentLines&&e.indentLines.length>0?I("div",{key:"indent-lines",class:"v-treeview-indent-lines",style:{"--v-indent-parts":e.indentLines.length}},[e.indentLines.map(L=>I("div",{class:we(`v-treeview-indent-line v-treeview-indent-line--${L}`)},null))]):"",!e.hideActions&&a(ce,{start:!0},{default:()=>[e.toggleIcon?I(B,null,[t.toggle?a(W,{key:"prepend-defaults",defaults:{VBtn:{density:"compact",icon:e.toggleIcon,variant:"text",loading:e.loading},VProgressCircular:{indeterminate:"disable-shrink",size:20,width:2}}},{default:()=>[t.toggle({...P,loading:e.loading,props:{onClick:w}})]}):a(J,{key:"prepend-toggle",density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text",onClick:w},{loader:()=>a(Ie,{indeterminate:"disable-shrink",size:"20",width:"2"},null)})]):I("div",{class:"v-treeview-item__level"},null)]}),e.hasCustomPrepend?a(W,{key:"prepend-defaults",defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{start:!0}}},{default:()=>[t.prepend?.(P)]}):I(B,null,[t.prepend?.(P),e.prependAvatar&&a(ye,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&a(D,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]):void 0})}),ke({},s)}}),pe=M({fluid:Boolean,disabled:Boolean,loadChildren:Function,loadingIcon:{type:String,default:"$loading"},items:Array,openOnClick:{type:Boolean,default:void 0},indeterminateIcon:{type:F,default:"$checkboxIndeterminate"},falseIcon:F,trueIcon:F,returnObject:Boolean,activatable:Boolean,selectable:Boolean,selectedColor:String,selectStrategy:[String,Function,Object],index:Number,isLastGroup:Boolean,separateRoots:Boolean,parentIndentLines:Array,indentLinesVariant:String,path:{type:Array,default:()=>[]},...Ce(fe(),["hideActions"]),...Le()},"VTreeviewChildren"),U=H()({name:"VTreeviewChildren",props:pe(),setup(e,m){let{slots:t}=m;const h=xe(new Set),b=S([]),s=x(()=>!e.disabled&&(e.openOnClick!=null?e.openOnClick:e.selectable&&!e.activatable));async function i(n){try{if(!e.items?.length||!e.loadChildren)return;n?.children?.length===0&&(h.add(n.value),await e.loadChildren(n.raw))}finally{h.delete(n.value)}}function v(n,g){e.selectable&&n(g)}return()=>t.default?.()??e.items?.map((n,g,A)=>{const{children:w,props:o}=n,y=h.has(n.value),P=!!A.at(g+1)?.children,L=e.path?.length??0,O=A.length-1===g,V={index:g,depth:L,isFirst:g===0,isLast:O,path:[...e.path,g],hideAction:e.hideActions},p=nt({depth:L,isLast:O,isLastGroup:e.isLastGroup,leafLinks:!e.hideActions&&!e.fluid,separateRoots:e.separateRoots,parentIndentLines:e.parentIndentLines,variant:e.indentLinesVariant}),T={toggle:t.toggle?d=>t.toggle?.({...d,...V,item:n.raw,internalItem:n,loading:y}):void 0,prepend:d=>I(B,null,[e.selectable&&(!w||w&&!["leaf","single-leaf"].includes(e.selectStrategy))&&a(ce,{start:!0},{default:()=>[a(Xe,{key:n.value,modelValue:d.isSelected,disabled:e.disabled||o.disabled,loading:y,color:e.selectedColor,density:e.density,indeterminate:d.isIndeterminate,indeterminateIcon:e.indeterminateIcon,falseIcon:e.falseIcon,trueIcon:e.trueIcon,"onUpdate:modelValue":C=>v(d.select,C),onClick:C=>C.stopPropagation(),onKeydown:C=>{["Enter","Space"].includes(C.key)&&(C.stopPropagation(),v(d.select,d.isSelected))}},null)]}),t.prepend?.({...d,...V,item:n.raw,internalItem:n})]),append:t.append?d=>t.append?.({...d,...V,item:n.raw,internalItem:n}):void 0,title:t.title?d=>t.title?.({...d,item:n.raw,internalItem:n}):void 0,subtitle:t.subtitle?d=>t.subtitle?.({...d,item:n.raw,internalItem:n}):void 0},f=de.filterProps(o),r=U.filterProps({...e,...V}),c={hideActions:e.hideActions,indentLines:p.footer};return w?a(de,G(f,{value:e.returnObject?n.raw:f?.value,rawId:f?.value}),{activator:d=>{let{props:C}=d;const ee={...o,...C,value:o?.value,hideActions:e.hideActions,indentLines:p.node,onToggleExpand:[()=>i(n),C.onClick],onClick:e.disabled||o.disabled?void 0:s.value?[()=>i(n),C.onClick]:()=>v(b.value[g]?.select,!b.value[g]?.isSelected)};return z(t.header,{props:ee,item:n.raw,internalItem:n,loading:y},()=>a(ue,G({ref:ge=>b.value[g]=ge},ee,{hasCustomPrepend:!!t.prepend,value:e.returnObject?n.raw:o.value,loading:y}),T))},default:()=>I(B,null,[a(U,G(r,{items:w,indentLinesVariant:e.indentLinesVariant,parentIndentLines:p.children,isLastGroup:P,returnObject:e.returnObject}),t),t.footer?.({props:c,item:n.raw,internalItem:n,loading:y})])}):z(t.item,{props:o,item:n.raw,internalItem:n},()=>n.type==="divider"?z(t.divider,{props:n.raw},()=>a(_e,n.props,null)):n.type==="subheader"?z(t.subheader,{props:n.raw},()=>a(Ye,n.props,null)):a(ue,G(o,{hasCustomPrepend:!!t.prepend,hideActions:e.hideActions,indentLines:p.leaf,value:e.returnObject?N(n.raw):o.value}),T))})}});function me(e){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];for(const t of e)m.push(t),t.children&&me(t.children,m);return m}const lt=M({openAll:Boolean,indentLines:[Boolean,String],search:String,hideNoData:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},...tt({filterKeys:["title"]}),...Y(pe(),["index","path","indentLinesVariant","parentIndentLines","isLastGroup"]),...Y(Je({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand",slim:!0}),["nav","openStrategy"]),modelValue:Array},"VTreeview"),it=H()({name:"VTreeview",props:lt(),emits:{"update:opened":e=>!0,"update:activated":e=>!0,"update:selected":e=>!0,"update:modelValue":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,m){let{slots:t,emit:h}=m;const{t:b}=Ae(),{items:s}=Ze(e),i=k(()=>e.activeColor),v=k(()=>e.baseColor),n=k(()=>e.color),g=te(e,"activated"),A=te(e,"selected"),w=x({get:()=>e.modelValue??A.value,set(f){A.value=f,h("update:modelValue",f)}}),o=S(),y=x(()=>e.openAll?T(s.value):e.opened),P=x(()=>me(s.value)),L=k(()=>e.search),{filteredItems:O}=et(e,P,L),V=x(()=>{if(!L.value)return null;const f=o.value?.getPath;return f?new Set(O.value.flatMap(r=>{const c=e.returnObject?r.raw:r.props.value;return[...f(c),...p(c)].map(N)})):null});function p(f){const r=[],c=(o.value?.children.get(f)??[]).slice();for(;c.length;){const d=c.shift();d&&(r.push(d),c.push(...(o.value?.children.get(d)??[]).slice()))}return r}function T(f){let r=[];for(const c of f)c.children&&(r.push(e.returnObject?N(c.raw):c.value),c.children&&(r=r.concat(T(c.children))));return r}return Te(ve,{visibleIds:V}),Pe({VTreeviewGroup:{activeColor:i,baseColor:v,color:n,collapseIcon:k(()=>e.collapseIcon),expandIcon:k(()=>e.expandIcon)},VTreeviewItem:{activeClass:k(()=>e.activeClass),activeColor:i,baseColor:v,color:n,density:k(()=>e.density),disabled:k(()=>e.disabled),lines:k(()=>e.lines),variant:k(()=>e.variant)}}),X(()=>{const f=se.filterProps(e),r=U.filterProps(e),c=typeof e.indentLines=="boolean"?"default":e.indentLines;return a(se,G({ref:o},f,{class:["v-treeview",{"v-treeview--fluid":e.fluid},e.class],openStrategy:"multiple",style:e.style,opened:y.value,activated:g.value,"onUpdate:activated":d=>g.value=d,selected:w.value,"onUpdate:selected":d=>w.value=d}),{default:()=>[V.value?.size===0&&!e.hideNoData&&(t["no-data"]?.()??a(Z,{key:"no-data",title:b(e.noDataText)},null)),a(U,G(r,{density:e.density,returnObject:e.returnObject,items:s.value,parentIndentLines:e.indentLines?[]:void 0,indentLinesVariant:c}),t)]})}),{}}}),ot={key:0},rt={class:"text-error"},st={class:"text-error"},dt={class:"text-error"},Rt={__name:"index",setup(e){const{mobile:m}=Se(),{t}=Ge(),h=Be(),b=Re(),s=S(window.innerHeight),i=S(!1),v=S(!1),n=S(""),g=V=>/\.zip$/i.test(V.name),A=()=>b.userInfo.role==="admin"?!0:b.userInfo.roomCreation,w=V=>{if(n.value!=="old"&&n.value!=="new"){Q(t("upload.dialog.uploadTypeTip"),"error");return}if(!g(V)){Q(t("upload.dialog.zipTip"),"error"),v.value=!1;return}i.value=!0;const p=new FormData;p.append("file",V),n.value==="old"&&p.append("roomID",h.room.id),$e.upload.post(p).then(T=>{Q(T.message)}).finally(()=>{v.value=!1,i.value=!1})},o=ne([1,14]),y=ne({ini:"ri-file-settings-line",lua:"ri-file-code-line",txt:"ri-file-text-line"}),P=[{id:1,title:"xxxxx.zip",children:[{id:2,title:"adminlist.txt",file:"txt"},{id:3,title:"blocklist.txt",file:"txt"},{id:4,title:t("upload.tree.caves"),children:[{id:5,title:"backup"},{id:6,title:"leveldataoverride.lua",file:"lua",required:!0},{id:7,title:"modoverrides.lua",file:"lua"},{id:8,title:"save",required:!0},{id:9,title:"server_chat_log.txt",file:"txt"},{id:10,title:"server.ini",file:"ini",required:!0},{id:11,title:"server_log.txt",file:"txt"}]},{id:12,title:"cluster.ini",file:"ini",required:!0},{id:13,title:"cluster_token.txt",file:"txt"},{id:14,title:"Master",children:[{id:15,title:"backup"},{id:16,title:"leveldataoverride.lua",file:"lua",required:!0},{id:17,title:"modoverrides.lua",file:"lua"},{id:18,title:"save",required:!0},{id:19,title:"server_chat_log.txt",file:"txt"},{id:20,title:"server.ini",file:"ini",required:!0},{id:21,title:"server_log.txt",file:"txt"}],required:!0},{id:22,title:"whitelist.txt",file:"txt"}]}],L=Oe(()=>{s.value=window.innerHeight},200),O=()=>Math.max(2,Math.floor(s.value-150));return De(()=>{L(),window.addEventListener("resize",L)}),(V,p)=>{const T=je("v-file-upload"),f=he;return l(h).gameVersion.local!==0?(_(),$(B,{key:0},[a(oe,null,{default:u(()=>[a(le,null,{default:u(()=>[a(ze,{border:"",rounded:""},{default:u(()=>[a(qe,{flat:""},{default:u(()=>[a(Ee,null,{default:u(()=>[a(D,{icon:"ri-contacts-book-upload-line",start:""}),l(m)?ae("",!0):(_(),$("span",ot,R(l(t)("upload.title")),1))]),_:1}),a(Fe,{modelValue:l(v),"onUpdate:modelValue":p[1]||(p[1]=r=>K(v)?v.value=r:null),persistent:l(i),class:"flex-wrap",width:l(m)?"90%":"40%"},{activator:u(({props:r})=>[a(J,G({class:"mr-2",color:"primary","prepend-icon":"ri-upload-line"},r),{default:u(()=>[q(R(l(t)("upload.button")),1)]),_:1},16)]),default:u(({isActive:r})=>[a(Ne,{title:l(t)("upload.dialog.title"),"min-height":"500"},{default:u(()=>[a(Ue,null,{default:u(()=>[l(i)?(_(),j(f,{key:1,height:400,type:"info",title:l(t)("upload.dialog.uploadingTitle"),"sub-title":l(t)("upload.dialog.uploadingSubTitle")},null,8,["title","sub-title"])):(_(),$(B,{key:0},[a(He,{color:"warning",density:"compact",class:"mt-2 mb-2"},{default:u(()=>[q(R(l(t)("upload.dialog.tip")),1)]),_:1}),a(Me,{modelValue:l(n),"onUpdate:modelValue":p[0]||(p[0]=c=>K(n)?n.value=c:null),inline:"",color:"primary",class:"my-4"},{prepend:u(()=>[a(Ke,null,{default:u(()=>[q(R(l(t)("upload.dialog.uploadType")),1)]),_:1})]),default:u(()=>[a(ie,{label:l(t)("upload.dialog.uploadNew"),disabled:!A(),value:"new"},null,8,["label","disabled"]),a(ie,{label:l(t)("upload.dialog.uploadOld"),disabled:l(h).room.id===0,value:"old"},null,8,["label","disabled"])]),_:1},8,["modelValue"]),a(T,{density:"default",icon:"ri-upload-cloud-2-line","onUpdate:modelValue":w})],64))]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue","persistent","width"])]),_:1}),a(Qe,null,{default:u(()=>[a(E,{text:l(t)("upload.expansions.panel1.text")},{title:u(()=>[a(D,{icon:"ri-error-warning-line",start:"",color:"error"}),I("span",rt,R(l(t)("upload.expansions.panel1.title")),1)]),_:1},8,["text"]),a(E,{text:l(t)("upload.expansions.panel2.text")},{title:u(()=>[a(D,{icon:"ri-error-warning-line",start:"",color:"error"}),I("span",st,R(l(t)("upload.expansions.panel2.title")),1)]),_:1},8,["text"]),a(E,{text:l(t)("upload.expansions.panel3.text")},{title:u(()=>[a(D,{icon:"ri-error-warning-line",start:"",color:"error"}),I("span",dt,R(l(t)("upload.expansions.panel3.title")),1)]),_:1},8,["text"]),a(E,{title:l(t)("upload.expansions.panel4.title"),text:l(t)("upload.expansions.panel4.text")},null,8,["title","text"])]),_:1})]),_:1})]),_:1})]),_:1}),a(oe,null,{default:u(()=>[a(le,null,{default:u(()=>[a(it,{opened:l(o),"onUpdate:opened":p[2]||(p[2]=r=>K(o)?o.value=r:null),items:P,"item-value":"id",variant:"flat",density:"compact",activatable:"","open-on-click":"","no-filter":""},{prepend:u(({item:r,isOpen:c})=>[r.file?(_(),j(D,{key:1,icon:l(y)[r.file]},null,8,["icon"])):(_(),j(D,{key:0,icon:c?"ri-folder-open-fill":"ri-folder-fill"},null,8,["icon"]))]),append:u(({item:r})=>[r.required?(_(),j(D,{key:0,icon:"ri-pushpin-fill",color:"error"})):ae("",!0)]),_:1},8,["opened"])]),_:1})]),_:1})],64)):(_(),$(B,{key:1},[l(b).userInfo.role==="admin"?(_(),j(f,{key:0,title:l(t)("global.noGame.title"),"sub-title":l(t)("global.noGame.subTitle"),height:O(),type:"error"},{default:u(()=>[a(J,{to:"/install",class:"mt-4"},{default:u(()=>[q(R(l(t)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(_(),j(f,{key:1,title:l(t)("global.noGameNoAdmin.title"),"sub-title":l(t)("global.noGameNoAdmin.subTitle"),height:O(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{Rt as default};
