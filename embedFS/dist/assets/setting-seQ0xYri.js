import{_ as se}from"./Result-DPFXOLoS.js";import ne from"./settingForm-DN55bEiM.js";import{m as P}from"./mod-BL5TPofj.js";import{ad as re,ae as ue,an as de,f as s,aG as ce,af as me,aH as ge,a as d,B as J,aI as he,ao as ve,g as fe,b as pe,e as Ve,j as ye,c as B,o as t,y as a,A as f,w as l,F as Z,v as K,k as D,t as L,l as c,p as Q,q as N,U as Ce,x as j,V as X,aa as be,R as G,C as Y}from"./index-Dqn-Y2oB.js";import{r as _e}from"./room-BvASRXIp.js";import{a as ke,V as we}from"./VRadioGroup-CflZCica.js";import{V as ee}from"./VCol-CLsovYBZ.js";import{V as H,c as De,a as O}from"./VCard-CumNZJ-p.js";import{V as W}from"./VContainer-Dvie4nEE.js";import{V as te,m as xe}from"./VCheckboxBtn-m1_jbKa5.js";import{u as Ie,V as ae,m as Me}from"./VInput-9jI7hnYY.js";import{V as le}from"./VChip-CmX9MwQH.js";import{V as Fe}from"./VRow-WVD6uv65.js";import"./VForm-BbEqUJ4t.js";import"./VSelect-DUXeLbex.js";import"./VTextField-CUS8BVbK.js";import"./index-BMOSmf1z.js";import"./VList-DRSt5aEc.js";import"./ssrBoot-BQTaxE_h.js";import"./VMenu-iu9xRO9i.js";import"./dialog-transition-qclFC1zN.js";import"./index-CD3H4IwR.js";import"./VTooltip-Bjc0UPOi.js";import"./axios-BhyVtIKS.js";import"./VSelectionControl-B4F8mx-8.js";/* empty css              */const Re=ue({...Me(),...ve(xe(),["inline"])},"VCheckbox"),Pe=re()({name:"VCheckbox",inheritAttrs:!1,props:Re(),emits:{"update:modelValue":m=>!0,"update:focused":m=>!0},setup(m,u){let{attrs:h,slots:n}=u;const p=de(m,"modelValue"),{isFocused:V,focus:y,blur:C}=Ie(m),g=s(),v=ce();return me(()=>{const[S,F]=ge(h),U=ae.filterProps(m),b=te.filterProps(m);return d(ae,J({ref:g,class:["v-checkbox",m.class]},S,U,{modelValue:p.value,"onUpdate:modelValue":_=>p.value=_,id:m.id||`checkbox-${v}`,focused:V.value,style:m.style}),{...n,default:_=>{let{id:$,messagesId:q,isDisabled:k,isReadonly:x,isValid:I}=_;return d(te,J(b,{id:$.value,"aria-describedby":q.value,disabled:k.value,readonly:x.value},F,{error:I.value===!1,modelValue:p.value,"onUpdate:modelValue":w=>p.value=w,onFocus:y,onBlur:C}),n)}})}),he({},g)}}),Be={class:"card-header"},Le={style:{height:"120px"}},Se={class:"fcc"},Ae=["onClick"],Ne={class:"d-flex align-center justify-center fill-height"},Ue={class:"w-66 d-flex justify-start align-center ml-4"},$e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#9FCFF8"><path d="M21 11.6736C20.0907 11.2417 19.0736 11 18 11C14.134 11 11 14.134 11 18C11 19.4872 11.4638 20.8662 12.2547 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918C3 2.44405 3.44495 2 3.9934 2H16L21 7V11.6736ZM18 23C15.2386 23 13 20.7614 13 18C13 15.2386 15.2386 13 18 13C20.7614 13 23 15.2386 23 18C23 20.7614 20.7614 23 18 23ZM16.7066 20.7076C17.0982 20.895 17.5369 21 18 21C19.6569 21 21 19.6569 21 18C21 17.5369 20.895 17.0982 20.7076 16.7066L16.7066 20.7076ZM15.2924 19.2934L19.2934 15.2924C18.9018 15.105 18.4631 15 18 15C16.3431 15 15 16.3431 15 18C15 18.4631 15.105 18.9018 15.2924 19.2934Z"></path></svg>',ct={__name:"setting",props:{height:{type:Number,default:0}},setup(m){const u=m,h=fe(),{t:n}=pe(),{mobile:p}=Ve(),V=s(!1),y=s(!1),C=s(!1),g=s(0),v=s(!0),S=s({}),F=s([]),U=async()=>{if(h.room.id!==0){const o=await _e.base.get({id:h.room.id});S.value=o.data.roomData,F.value=o.data.worldData,S.value.modInOne||(g.value=F.value[0].id,v.value=!1)}},b=async()=>{y.value=!0,M.value=[],x.value=[],I.value=[],w.value="";const o={roomID:h.room.id,worldID:g.value},i=await P.setting.enabledMods.get(o);k.value=i.data||[],y.value=!1,V.value=!1},_=async(o,i,r,e)=>{V.value=!0,C.value=!0,z.value=i,T.value=o,w.value="",o===0?(w.value=n("game.mod.setting.clientModsDisabled"),x.value=[],I.value=[]):(await Promise.all([$(o,i,r),q(o,i,r)]),w.value=e),C.value=!1},$=async(o,i,r)=>{const e={roomID:h.room.id,worldID:i,id:o,file_url:r},R=await P.setting.modConfigStruct.get(e);x.value=R.data||[]},q=async(o,i,r)=>{const e={roomID:h.room.id,worldID:i,id:o,file_url:r},R=await P.setting.modConfigValue.get(e);I.value=R.data?.configuration_options||{}},k=s([]),x=s([]),I=s([]),w=s(""),z=s(0),T=s(0),oe=o=>{const i={roomID:h.room.id,worldID:g.value,id:T.value,modORConfig:{configuration_options:o.formData,enabled:!0}};P.setting.modConfigValue.put(i).then(r=>{Y(r.message)})},M=s([]),E=s(!1),ie=async()=>{if(!M.value.length){Y(n("game.mod.setting.tip.selectModToDisable"),"error");return}E.value=!0;for(let o of M.value){const i={roomID:h.room.id,id:o};await P.setting.disableMod.post(i)}M.value=[],E.value=!1,await b()};return ye(async()=>{await U(),await b()}),(o,i)=>{const r=se;return t(),B(Z,null,[v.value?f("",!0):(t(),a(we,{key:0,modelValue:g.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>g.value=e),b],inline:"",class:"mb-2"},{default:l(()=>[(t(!0),B(Z,null,K(F.value,e=>(t(),a(ke,{label:e.worldName,value:e.id,class:"mr-4"},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])),d(Fe,null,{default:l(()=>[d(ee,{cols:"12",md:"4"},{default:l(()=>[d(H,{disabled:y.value,loading:y.value},{default:l(()=>[d(De,null,{default:l(()=>[D("div",Be,[D("span",null,L(c(n)("game.mod.setting.enabledMods")),1),D("div",null,[c(p)?f("",!0):(t(),a(Q,{key:0,"prepend-icon":"ri-prohibited-2-line",color:"error",variant:"text",loading:E.value,onClick:ie},{default:l(()=>[N(L(c(n)("game.mod.setting.multiDisable")),1)]),_:1},8,["loading"])),d(Q,{"prepend-icon":"ri-refresh-line",color:"default",variant:"text",loading:y.value,onClick:b},{default:l(()=>[N(L(c(n)("game.mod.setting.refresh")),1)]),_:1},8,["loading"])])])]),_:1}),d(O,null,{default:l(()=>[k.value.length!==0?(t(),a(W,{key:0,height:v.value?u.height:u.height-48,style:{"overflow-y":"auto"}},{default:l(()=>[(t(!0),B(Z,null,K(k.value,(e,R)=>(t(),B("div",Le,[R!==0?(t(),a(Ce,{key:0})):f("",!0),D("div",Se,[j((t(),B("div",{class:"w-33 cursor-pointer",onClick:A=>_(e.id,g.value,e.file_url,e.name)},[e.id!==0?(t(),a(X,{key:0,cover:"",rounded:"",width:100,height:100,"aspect-ratio":"1/1",src:e.preview_url,class:"ma-2"},{placeholder:l(()=>[D("div",Ne,[d(be,{color:"grey-lighten-4",indeterminate:""})])]),_:1},8,["src"])):(t(),a(X,{key:1,width:100,height:100,"aspect-ratio":"1/1",src:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent($e)}`,class:"ma-2"},null,8,["src"]))],8,Ae)),[[G]]),D("div",Ue,[c(p)?f("",!0):(t(),a(Pe,{key:0,modelValue:M.value,"onUpdate:modelValue":i[1]||(i[1]=A=>M.value=A),value:e.id,class:"mr-2"},null,8,["modelValue","value"])),e.id!==0?j((t(),a(le,{key:1,color:"info",label:"",onClick:A=>_(e.id,g.value,e.file_url,e.name)},{default:l(()=>[N(L(e.name),1)]),_:2},1032,["onClick"])),[[G]]):j((t(),a(le,{key:2,color:"info",label:"",onClick:A=>_(e.id,g.value,e.file_url,e.name)},{default:l(()=>[N(L(c(n)("game.mod.setting.clientModsDisabled")),1)]),_:1},8,["onClick"])),[[G]])])])]))),256))]),_:1},8,["height"])):f("",!0),k.value.length===0&&!v.value?(t(),a(W,{key:1,height:u.height-48,style:{"overflow-y":"auto"}},{default:l(()=>[d(r,{type:"info",title:c(n)("game.mod.setting.tip.noEnabledMods"),height:u.height-48-38},null,8,["title","height"])]),_:1},8,["height"])):f("",!0),k.value.length===0&&v.value?(t(),a(W,{key:2,height:u.height,style:{"overflow-y":"auto"}},{default:l(()=>[d(r,{type:"info",title:c(n)("game.mod.setting.tip.noEnabledMods"),height:u.height-48},null,8,["title","height"])]),_:1},8,["height"])):f("",!0)]),_:1})]),_:1},8,["disabled","loading"])]),_:1}),d(ee,{cols:"12",md:"8"},{default:l(()=>[D("div",null,[V.value&&!C.value?(t(),a(ne,{key:0,fields:x.value,"initial-data":I.value,height:v.value?u.height:u.height-48,title:w.value,"room-i-d":c(h).room.id,"world-i-d":z.value,"mod-i-d":T.value,onChange:oe,onDisableRefresh:b},null,8,["fields","initial-data","height","title","room-i-d","world-i-d","mod-i-d"])):f("",!0),V.value&&C.value?(t(),a(H,{key:1},{default:l(()=>[d(O,null,{default:l(()=>[v.value?(t(),a(r,{key:0,type:"info",title:c(n)("game.mod.setting.tip.fetching"),height:u.height+34},null,8,["title","height"])):(t(),a(r,{key:1,type:"info",title:c(n)("game.mod.setting.tip.fetching"),height:u.height-12},null,8,["title","height"]))]),_:1})]),_:1})):f("",!0),!V.value&&!C.value?(t(),a(H,{key:2},{default:l(()=>[d(O,null,{default:l(()=>[v.value?(t(),a(r,{key:0,type:"info",title:c(n)("game.mod.setting.tip.selectMod"),height:u.height+34},null,8,["title","height"])):(t(),a(r,{key:1,type:"info",title:c(n)("game.mod.setting.tip.selectMod"),height:u.height-12},null,8,["title","height"]))]),_:1})]),_:1})):f("",!0)])]),_:1})]),_:1})],64)}}};export{ct as default};
