import{_ as ee}from"./Result-BHILQUe0.js";import{_ as te,c as w,o as u,t as n,e as ae,b as le,u as se,d as ie,g as re,h as S,W as oe,f as ne,a7 as ue,a8 as ce,l as e,k as p,a,A as g,I as y,ae as de,w as l,v as d,s as D,F as q,y as me,V as W,z as he,aa as fe,$ as pe,P as $,D as ge,p as Ve,ab as K,R as _e}from"./index-Dko6h61I.js";import{r as be}from"./room-aOLB6bOU.js";import{e as ye}from"./eventBus-B8tShFcG.js";import{V as we}from"./VTextField-K3ZSwZys.js";import{V as C}from"./VRow-DxU3FRie.js";import{V as f}from"./VCol-DJGLoFn6.js";import{V as F}from"./VChip-Cpf9DcpK.js";import{V as ve}from"./VMenu-C2Sx5jJs.js";import{V as xe,a as I,b as B}from"./VList-X8Eeynlb.js";import{V as ke}from"./VSheet-BR6HhwHd.js";import{V as Se}from"./VSparkline-k76gyBPY.js";import{V as Ce}from"./VPagination-CVIlQR-i.js";import"./VContainer-OY6vEFFH.js";/* empty css              */import"./axios-CaD9VQvn.js";import"./index-qFXpRsB7.js";import"./VInput-DNPZQ_Sd.js";import"./VSlideGroup-COGSulbt.js";import"./dialog-transition-CSPvW42u.js";import"./ssrBoot-BhLlNBfX.js";import"./VDivider-BSTmirna.js";let U=0;const J="webkit moz ms o".split(" ");let V,_;const Ne=typeof window>"u";if(Ne)V=function(){},_=function(){};else{V=window.requestAnimationFrame,_=window.cancelAnimationFrame;let i;for(let s=0;s<J.length&&!(V&&_);s++)i=J[s],V=V||window[i+"RequestAnimationFrame"],_=_||window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"];(!V||!_)&&(V=function(s){const t=new Date().getTime(),o=Math.max(0,16-(t-U)),c=window.setTimeout(()=>{s(t+o)},o);return U=t+o,c},_=function(s){window.clearTimeout(s)})}const Te={props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:2017},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:0,validator(i){return i>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default(i,s,t,o){return t*(-Math.pow(2,-10*i/o)+1)*1024/1023+s}}},data(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown(){return this.startVal>this.endVal}},watch:{startVal(){this.autoplay&&this.start()},endVal(){this.autoplay&&this.start()}},mounted(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=V(this.count)},pauseResume(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause(){_(this.rAF)},resume(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,V(this.count)},reset(){this.startTime=null,_(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count(i){this.startTime||(this.startTime=i),this.timestamp=i;const s=i-this.startTime;this.remaining=this.localDuration-s,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(s,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(s,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(s/this.localDuration):this.printVal=this.localStartVal+(this.endVal-this.localStartVal)*(s/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),s<this.localDuration?this.rAF=V(this.count):this.$emit("callback")},isNumber(i){return!isNaN(parseFloat(i))},formatNumber(i){i=i.toFixed(this.decimals),i+="";const s=i.split(".");let t=s[0];const o=s.length>1?this.decimal+s[1]:"",c=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;c.test(t);)t=t.replace(c,"$1"+this.separator+"$2");return this.prefix+t+o+this.suffix}},destroyed(){_(this.rAF)}};function De(i,s,t,o,c,N){return u(),w("span",null,n(c.displayValue),1)}const R=te(Te,[["render",De]]);function Fe(i,s,t){return s in i?Object.defineProperty(i,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[s]=t,i}function Q(i,s){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);s&&(o=o.filter((function(c){return Object.getOwnPropertyDescriptor(i,c).enumerable}))),t.push.apply(t,o)}return t}R.unmounted=R.destroyed,Reflect.deleteProperty(R,"destroyed");var Oe=(function(i){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?arguments[s]:{};s%2?Q(Object(t),!0).forEach((function(o){Fe(i,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach((function(o){Object.defineProperty(i,o,Object.getOwnPropertyDescriptor(t,o))}))}return i})({name:"CountTo",emits:["callback","mountedCallback"]},R);const $e={class:"fcc"},ze={class:"fcb"},Ae={class:"fcc"},Me=["onClick"],Re={class:"text-caption text-grey"},Pe={class:"text-h3 font-weight-black"},qe={key:1},Ie={key:1},Be={key:2},ut={__name:"index",setup(i){const{mobile:s}=ae(),{t}=le(),o=se(),c=ie(),N=re(),T=S(window.innerHeight),L=()=>Math.max(2,Math.floor((T.value-204)/300)*2),m=S({gameName:"",page:1,pageSize:6}),z=S([]),P=S(0),A=S(!1),v=async()=>{A.value=!0;const h=await be.list.get(m.value);z.value=h.data.rows||[],P.value=h.data.total,A.value=!1},j=async()=>{N.room={id:0,gameName:""},X(),await o.push("/game/base")},X=()=>{ye.emit("toggleMenu",3)},Y=h=>{N.room.id=h.id,N.room.gameName=h.gameName},E=h=>{if(h.length===0)return[0,0];const b=[];for(let x of h)b.push(x.playerInfo?.length||0);return b},O=S(null),M=S(0),H=()=>Math.max(2,Math.floor(T.value-120));oe(T,()=>{v()},{immediate:!0});const G=ue(()=>{T.value=window.innerHeight,m.value.pageSize=L(),O.value&&(M.value=O.value.$el.offsetWidth)},200);return ne(async()=>{await v(),m.value.pageSize=L(),O.value&&(M.value=O.value.$el.offsetWidth),window.addEventListener("resize",G)}),ce(()=>{window.removeEventListener("resize",G)}),(h,b)=>{const x=ee;return e(N).gameVersion.local!==0?(u(),w(q,{key:0},[p("div",$e,[a(we,{modelValue:e(m).gameName,"onUpdate:modelValue":b[0]||(b[0]=r=>e(m).gameName=r),label:e(t)("rooms.header.input.label"),placeholder:e(t)("rooms.header.input.placeholder"),"append-inner-icon":"ri-search-line",class:"mr-4",loading:e(A),"onClick:appendInner":v,onKeyup:de(v,["enter"])},null,8,["modelValue","label","placeholder","loading"]),e(s)?y("",!0):(u(),g(D,{key:0,disabled:!e(c).userInfo.roomCreation&&e(c).userInfo.role!=="admin","prepend-icon":"ri-add-line",variant:"elevated",size:"large",class:"mr-4",onClick:j},{default:l(()=>[d(n(e(t)("rooms.header.button.create")),1)]),_:1},8,["disabled"])),e(s)?y("",!0):(u(),g(D,{key:1,"prepend-icon":"ri-refresh-line",color:"default",variant:"elevated",size:"large",onClick:v},{default:l(()=>[d(n(e(t)("rooms.header.button.refresh")),1)]),_:1})),e(s)?(u(),g(D,{key:2,disabled:!e(c).userInfo.roomCreation&&e(c).userInfo.role!=="admin",icon:"ri-add-line",class:"mr-4",onClick:j},null,8,["disabled"])):y("",!0),e(s)?(u(),g(D,{key:3,icon:"ri-refresh-line",color:"default",onClick:v})):y("",!0)]),a(C,{class:"mt-8"},{default:l(()=>[a(C,null,{default:l(()=>[(u(!0),w(q,null,me(e(z),(r,Z)=>(u(),g(f,{cols:e(s)?12:6},{default:l(()=>[a(W,{ref_for:!0,ref:k=>{Z===0&&(O.value=k)},hover:!0,variant:"flat",height:e(s)?"600px":"300px"},{default:l(()=>[a(fe,null,{default:l(()=>[p("div",ze,[p("div",Ae,[a(F,{color:"primary"},{default:l(()=>[d(n(e(pe)(r.gameName,e(s)?8:15)),1)]),_:2},1024),a(F,{color:r.status?"success":"warning",class:"ml-4"},{default:l(()=>[d(n(r.status?e(t)("rooms.card.success.header.title.activated"):e(t)("rooms.card.success.header.title.deactivated")),1)]),_:2},1032,["color"]),e(N).room.id===r.id?(u(),g($,{key:0,icon:"ri-crosshair-2-line",color:"info",class:"ml-4"})):y("",!0)]),a(ve,null,{activator:l(({props:k})=>[a(D,ge({ref_for:!0},k,{disabled:e(A),color:"primary",icon:"ri-more-2-line"}),null,16,["disabled"])]),default:l(()=>[a(xe,null,{default:l(()=>[a(I,{class:"text-success",onClick:k=>console.log(r.name)},{prepend:l(()=>[a($,{icon:"ri-play-large-line",size:"22"})]),default:l(()=>[a(B,null,{default:l(()=>[d(n(e(t)("rooms.card.success.header.menu.activate")),1)]),_:1})]),_:1},8,["onClick"]),a(I,{class:"text-warning",onClick:k=>console.log(r.name)},{prepend:l(()=>[a($,{icon:"ri-stop-large-line",color:"warning",size:"22"})]),default:l(()=>[a(B,null,{default:l(()=>[d(n(e(t)("rooms.card.success.header.menu.deactivate")),1)]),_:1})]),_:1},8,["onClick"]),a(I,{class:"text-error",onClick:k=>console.log(r.name)},{prepend:l(()=>[a($,{icon:"ri-delete-bin-line",color:"error",size:"22"})]),default:l(()=>[a(B,null,{default:l(()=>[d(n(e(t)("rooms.card.success.header.menu.delete")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024),he((u(),g(Ve,null,{default:l(()=>[r.gameName!==""?(u(),w("div",{key:0,class:"mt-4",onClick:k=>Y(r)},[a(C,null,{default:l(()=>[a(f,{cols:e(s)?12:6},{default:l(()=>[a(C,null,{default:l(()=>[a(f,{cols:"6"},{default:l(()=>[p("span",null,n(e(t)("rooms.card.success.text.left.gameMode")),1)]),_:1}),a(f,{cols:"6"},{default:l(()=>[a(F,{color:"info",label:""},{default:l(()=>[d(n(e(t)(`game.base.step1.gameMode.modes.${r.gameMode}`)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(C,null,{default:l(()=>[a(f,{cols:"6"},{default:l(()=>[p("span",null,n(e(t)("rooms.card.success.text.left.worldNum")),1)]),_:1}),a(f,{cols:"6"},{default:l(()=>[a(F,{color:"info",label:""},{default:l(()=>[d(n(r.worlds.length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(C,null,{default:l(()=>[a(f,{cols:"6"},{default:l(()=>[p("span",null,n(e(t)("rooms.card.success.text.left.modNum")),1)]),_:1}),a(f,{cols:"6"},{default:l(()=>[a(F,{color:"info",label:""},{default:l(()=>[d(n(r.modInOne?e(K)(r.modData).length:e(K)(r.worlds[0].modData).length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(C,null,{default:l(()=>[a(f,{cols:"6"},{default:l(()=>[p("span",null,n(e(t)("rooms.card.success.text.left.playerNum")),1)]),_:1}),a(f,{cols:"6"},{default:l(()=>[a(F,{color:"info",label:""},{default:l(()=>[d(n(r.maxPlayer),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"]),a(f,{cols:e(s)?12:6},{default:l(()=>[a(W,{height:240,variant:"flat"},{prepend:l(()=>[a($,{color:"primary",class:"me-8",icon:"ri-line-chart-line",size:"48"})]),title:l(()=>[p("div",Re,n(e(t)("rooms.card.success.text.right.chartTitle")),1),p("span",Pe,[a(e(Oe),{duration:4e3,"end-val":Math.max(...E(r.players)),"start-val":0},null,8,["end-val"])]),p("strong",null,n(e(t)("rooms.card.success.text.right.unit")),1)]),default:l(()=>[a(ke,{color:"transparent"},{default:l(()=>[a(Se,{width:e(s)?e(M):e(M)/2,gradient:["#1feaea"],"line-width":3,"model-value":E(r.players),smooth:!0,padding:"8","stroke-linecap":"round","auto-draw":""},null,8,["width","model-value"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"])]),_:2},1024)],8,Me)):(u(),w("div",qe,[a(x,{type:"warning",height:e(s)?600:300,title:e(t)("rooms.card.warning.title"),"sub-title":e(t)("rooms.card.warning.subTitle")},null,8,["height","title","sub-title"])]))]),_:2},1024)),[[_e]])]),_:2},1032,["height"])]),_:2},1032,["cols"]))),256))]),_:1})]),_:1}),e(P)>e(m).pageSize?(u(),g(Ce,{key:0,modelValue:e(m).page,"onUpdate:modelValue":[b[1]||(b[1]=r=>e(m).page=r),v],length:Math.max(1,Math.ceil(e(P)/e(m).pageSize)),class:"mt-8"},null,8,["modelValue","length"])):y("",!0),e(z).length===0&&e(m).gameName!==""?(u(),w("div",Ie,[a(x,{type:"warning",height:e(T),title:e(t)("rooms.result.noResult.title"),"sub-title":e(t)("rooms.result.noResult.subTitle")},null,8,["height","title","sub-title"])])):y("",!0),e(z).length===0&&e(m).gameName===""?(u(),w("div",Be,[a(x,{type:"warning",height:e(T),title:e(t)("rooms.result.noRoom.title"),"sub-title":e(t)("rooms.result.noRoom.subTitle")},null,8,["height","title","sub-title"])])):y("",!0)],64)):(u(),w(q,{key:1},[e(c).userInfo.role==="admin"?(u(),g(x,{key:0,title:e(t)("global.noGame.title"),"sub-title":e(t)("global.noGame.subTitle"),height:H(),type:"error"},{default:l(()=>[a(D,{to:"/install",class:"mt-4"},{default:l(()=>[d(n(e(t)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(u(),g(x,{key:1,title:e(t)("global.noGameNoAdmin.title"),"sub-title":e(t)("global.noGameNoAdmin.subTitle"),height:H(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{ut as default};
