import M from"./log-bhkhwHQ3.js";import{h as _}from"./axios-CIK0f--r.js";import{r as B}from"./room-zzDCRBaJ.js";import{g as N,h as r,f as R,a7 as S,Y as k,A as q,o as D,w as o,a as t,aa as H,k as f,l as i,x as V,v as I,p as T,s as U,V as z}from"./index-DeHbA_nE.js";import{V as A}from"./VSelect-Bf2-hd3n.js";import{V as E}from"./VSwitch-51UxlYB-.js";import{V as F}from"./VChip-Ces28v7J.js";import{V as W}from"./VRow-BQEmeM4E.js";import{V as $}from"./VSpacer-C26-bQd5.js";import{V as j}from"./VCol--aHUdhvn.js";import{V as P}from"./VNumberInput-Dk0Yb5G2.js";import"./VTextField-CP4jc6f6.js";import"./index-Dcq4ln1t.js";import"./VInput-BJqQ64aj.js";import"./VList-DImB9Izd.js";import"./ssrBoot-DIT1QZZO.js";import"./VDivider-BMDGpAqT.js";import"./VMenu-eNSqB-Lk.js";import"./dialog-transition-jWvVTuJL.js";import"./VSelectionControl-DqDk1AMu.js";import"./VSlideGroup-ZbKB6ob3.js";/* empty css              */const Y={content:{url:"/logs/content",get:async function(v){return await _.get(this.url,v)}}},G={class:"card-header"},J={class:"fcc"},ge={__name:"game",setup(v){const g=N(),d=r(""),a=r(0),m=r(!0),l=r(0),w=()=>{if(a.value===0)return;const s={roomID:g.room.id,worldID:a.value,logType:"game",lines:l.value};Y.content.get(s).then(e=>{d.value=e.data.join(`
`)})},c=r([]),b=async()=>{const s={roomID:g.room.id},e=await B.worlds.get(s);c.value=e.data,a.value=c.value[0]?.id||0};let u=null;const L=()=>{u=setInterval(()=>{m.value&&w()},2e3)},h=()=>{u&&(clearInterval(u),u=null)},x=()=>Math.round(Math.max(2,Math.floor(p.value-390))/22.5),y=()=>Math.max(2,Math.floor(p.value-160)),p=r(window.innerHeight),C=S(()=>{p.value=window.innerHeight,l.value=x()},200);return R(async()=>{window.addEventListener("resize",C),await b(),l.value=x(),L()}),k(()=>{h(),window.removeEventListener("beforeunload",h),window.removeEventListener("resize",C)}),(s,e)=>(D(),q(z,{height:y()},{default:o(()=>[t(H,{class:"my-2"},{default:o(()=>[f("div",G,[e[5]||(e[5]=f("span",null,"游戏日志",-1)),f("div",J,[t(A,{modelValue:i(a),"onUpdate:modelValue":[e[0]||(e[0]=n=>V(a)?a.value=n:null),e[1]||(e[1]=n=>d.value="")],items:i(c),"item-title":"worldName","item-value":"id",label:"世界",density:"compact",class:"mr-4"},null,8,["modelValue","items"]),t(E,{modelValue:i(m),"onUpdate:modelValue":e[2]||(e[2]=n=>V(m)?m.value=n:null),color:"info","hide-details":""},{prepend:o(()=>[t(F,{color:"info"},{default:o(()=>[...e[4]||(e[4]=[I(" 自动刷新 ",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),_:1}),t(T,null,{default:o(()=>[t(M,{content:i(d),height:y()-150},null,8,["content","height"]),t(W,{class:"my-4"},{default:o(()=>[t($),t(j,{cols:"6",md:"2",class:"fcc"},{default:o(()=>[t(P,{modelValue:i(l),"onUpdate:modelValue":e[3]||(e[3]=n=>V(l)?l.value=n:null),label:"行","hide-details":"",density:"compact",class:"mr-4"},null,8,["modelValue"]),t(U,{onClick:w},{default:o(()=>[...e[6]||(e[6]=[I(" 刷新 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["height"]))}};export{ge as default};
