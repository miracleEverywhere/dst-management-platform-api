import{_ as R}from"./Result-xqSnAKSL.js";import{_ as $}from"./ConfirmBox-C6ULR34i.js";import{t as B}from"./tools-DXH5-QJ9.js";import{g as A,d as q,e as H,b as M,f as i,j as U,a4 as P,a5 as j,c as b,l as e,o as r,y as V,F as k,a,w as o,k as u,t as l,G as D,s as G,p as h,q as m,cw as J,a9 as K,A as O,a8 as Q,C as W}from"./index-CkNbSyGh.js";import{a as X,V as Y}from"./VExpansionPanels-oMASpfeA.js";import{V as Z}from"./VDataTable-rXtQItL3.js";import{V as w}from"./VChip-BYgMm5U1.js";import{V as ee,a as te}from"./VToolbar-CpVJajtM.js";import{V as oe}from"./VSkeletonLoader-CiMs7sWU.js";import"./VContainer-DphP_HXU.js";/* empty css              */import"./VCard-Chgb7NQr.js";import"./VAlert-RuRU4Tlv.js";import"./VSpacer-Dtma9HxP.js";import"./VDialog-YMDmpeZ_.js";import"./dialog-transition-CkYDvwCe.js";import"./axios-D9wugClK.js";import"./index-C_E8fDh9.js";import"./VPagination-DyeMdUEe.js";import"./VSelect-CCrSk_bo.js";import"./VInput-DAl67pJ-.js";import"./VTextField-CIbt9Jw8.js";import"./VList-B4ZoK83V.js";import"./ssrBoot-vMFB3qzm.js";import"./VMenu-D2l1j7S0.js";import"./VCheckboxBtn-DTkK2TZk.js";import"./VSelectionControl-CV465D96.js";import"./VTable-DW-OVTmL.js";import"./filter-D10Qczcc.js";const ae={class:"mb-2"},le={class:"mb-2"},ne={class:"mb-2"},se={class:"mb-2 text-error"},ie={key:0},Ae={__name:"snapshot",setup(re){const d=A(),N=q(),{mobile:E}=H(),{t}=M(),S=i(window.innerHeight),T=i([]),f=i(!1),g=()=>{if(d.room.id===0)return;f.value=!0;const p={roomID:d.room.id};B.snapshot.get(p).then(s=>{T.value=s.data||[]}).finally(()=>{f.value=!1})},_=i([{key:"name",order:"desc"}]),F=[{key:"name",title:t("tools.snapshot.table.header.name")},{key:"size",title:t("tools.snapshot.table.header.size")},{key:"modTime",title:t("tools.snapshot.table.header.modTime")},{key:"actions",title:t("tools.snapshot.table.header.actions")}],c=i(!1),y=i(!1),C=i(""),I=()=>{y.value=!0;const p={roomID:d.room.id,name:C.value};B.snapshot.delete(p).then(s=>{W(s.message),c.value=!1,g()}).finally(()=>{y.value=!1})},z=P(()=>{S.value=window.innerHeight},200),v=()=>Math.max(2,Math.floor(S.value-150));return U(()=>{g(),window.addEventListener("resize",z)}),j(()=>{window.removeEventListener("resize",z)}),(p,s)=>{const L=$,x=R;return e(d).gameVersion.local!==0?(r(),b(k,{key:0},[e(d).room.id!==0?(r(),b(k,{key:0},[a(Y,null,{default:o(()=>[a(X,null,{title:o(()=>[a(D,{icon:"ri-information-line",start:""}),u("span",null,l(e(t)("tools.snapshot.expansion.title")),1)]),text:o(()=>[u("div",ae,l(e(t)("tools.snapshot.expansion.text1")),1),u("div",le,l(e(t)("tools.snapshot.expansion.text2")),1),u("div",ne,l(e(t)("tools.snapshot.expansion.text3")),1),u("div",se,l(e(t)("tools.snapshot.expansion.text4")),1)]),_:1})]),_:1}),a(Q,{border:"",rounded:"",class:"mt-4"},{default:o(()=>[a(Z,{"sort-by":e(_),"onUpdate:sortBy":s[0]||(s[0]=n=>G(_)?_.value=n:null),headers:F,items:e(T),loading:e(f)},{loading:o(()=>[a(oe,{type:"table-row@10"})]),top:o(()=>[a(ee,{flat:""},{default:o(()=>[a(te,null,{default:o(()=>[a(D,{icon:"ri-flip-horizontal-line",start:""}),e(E)?O("",!0):(r(),b("span",ie,l(e(t)("tools.snapshot.title")),1))]),_:1}),a(h,{"prepend-icon":"ri-refresh-line",loading:e(f),color:"default",onClick:g},{default:o(()=>[m(l(e(t)("platform.user.table.refresh")),1)]),_:1},8,["loading"])]),_:1})]),"item.name":o(({value:n})=>[a(w,{label:"",color:"info"},{default:o(()=>[m(l(n),1)]),_:2},1024)]),"item.size":o(({value:n})=>[a(w,{label:"",color:"default"},{default:o(()=>[m(l(e(K)(n)),1)]),_:2},1024)]),"item.modTime":o(({value:n})=>[a(w,{label:"",color:"primary"},{default:o(()=>[m(l(e(J)(n)),1)]),_:2},1024)]),"item.actions":o(({item:n})=>[a(h,{variant:"text",color:"error","prepend-icon":"ri-delete-bin-line",onClick:me=>{C.value=n.name,c.value=!0}},{default:o(()=>[m(l(e(t)("tools.snapshot.table.delete")),1)]),_:1},8,["onClick"])]),_:1},8,["sort-by","items","loading"])]),_:1}),a(L,{modelValue:e(c),"onUpdate:modelValue":s[1]||(s[1]=n=>G(c)?c.value=n:null),type:"warning",title:e(t)("global.confirm.title"),content:e(t)("global.confirm.content"),"confirm-text":e(t)("global.confirm.confirm"),"cancel-text":e(t)("global.confirm.cancel"),"confirm-loading":e(y),onConfirm:I,onCancel:s[2]||(s[2]=n=>c.value=!1)},null,8,["modelValue","title","content","confirm-text","cancel-text","confirm-loading"])],64)):(r(),V(x,{key:1,title:e(t)("global.noRoomSelected.title"),"sub-title":e(t)("global.noRoomSelected.subTitle"),type:"error",height:v()},{default:o(()=>[a(h,{to:"/rooms",class:"mt-4"},{default:o(()=>[m(l(e(t)("global.noRoomSelected.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"]))],64)):(r(),b(k,{key:1},[e(N).userInfo.role==="admin"?(r(),V(x,{key:0,title:e(t)("global.noGame.title"),"sub-title":e(t)("global.noGame.subTitle"),height:v(),type:"error"},{default:o(()=>[a(h,{to:"/install",class:"mt-4"},{default:o(()=>[m(l(e(t)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(r(),V(x,{key:1,title:e(t)("global.noGameNoAdmin.title"),"sub-title":e(t)("global.noGameNoAdmin.subTitle"),height:v(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{Ae as default};
