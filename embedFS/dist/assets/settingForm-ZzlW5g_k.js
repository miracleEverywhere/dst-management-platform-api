import{_ as Y}from"./Result-BrGP0UtE.js";import{m as Z}from"./mod-CJQBgVpM.js";import{_ as w,b as f,aJ as A,i as K,j as N,y as v,o as p,w as u,a as l,k as tt,q as j,t as D,p as C,l as n,c as _,F as k,v as I,x,A as et,P as ot,B as rt,C as at}from"./index-w_zQfLyl.js";import{c as nt,a as st,V as ct}from"./VCard-YShCZBj4.js";import{V as lt}from"./VForm-B1rjm5tn.js";import{V as mt}from"./VContainer-5GWv7mNe.js";import{V as it}from"./VRow-BUWrDU1g.js";import{V as U}from"./VCol-DgFmhumR.js";import{V as ut}from"./VSelect-jY-bhflm.js";import{T as $}from"./index--UypWN9N.js";import{V as O}from"./VTextField-DIo56yci.js";import"./axios-BrZt5i3R.js";import"./VInput-BS3IgblF.js";import"./index-CXror5ua.js";/* empty css              */import"./VList-Cjac50mS.js";import"./ssrBoot-Du27dwoI.js";import"./VMenu-Dps4khho.js";import"./dialog-transition-C0Jeixy8.js";import"./VCheckboxBtn-DAaKE1AM.js";import"./VSelectionControl-DqPHYJ6W.js";import"./VChip-BWlxUOQZ.js";import"./VTooltip-plzQbOmR.js";const pt={class:"card-header"},gt={key:0,class:"array-field mt-4"},ht={key:1,class:"object-field mt-4"},bt={__name:"settingForm",props:{fields:{type:Array,required:!0,default:()=>[]},initialData:{type:Object,default:()=>({})},height:{type:Number,default:0},title:{type:String,default:""},roomID:{type:Number,default:0},worldID:{type:Number,default:0},modID:{type:Number,default:0}},emits:["change","disableRefresh"],setup(T,{expose:B,emit:S}){const g=T,F=S,{t:y}=f(),a=A({}),o=A({}),m=A({}),V=K(()=>g.fields),q=t=>Array.isArray(a[t]),E=t=>{const e=a[t];return e&&typeof e=="object"&&!Array.isArray(e)},R=t=>typeof t=="number"?"number":"text",L=()=>{Object.keys(g.initialData).length===0?(V.value||(V.value=[]),V.value.forEach(t=>{const e=t.default;a[t.name]=e,Array.isArray(e)?(o[t.name]=[...e],m[t.name]=[]):e&&typeof e=="object"?(o[t.name]={...e},m[t.name]=Object.keys(o[t.name])):o[t.name]=e})):Object.entries(g.initialData).forEach(([t,e])=>{a[t]=e,Array.isArray(e)?(o[t]=[...e],m[t]=[]):e&&typeof e=="object"?(o[t]={...e},m[t]=Object.keys(o[t])):o[t]=e})},M=(t,e)=>{a[t]=e,Array.isArray(e)?(o[t]=e.length>0?[...e]:[],m[t]=[]):e&&typeof e=="object"?(o[t]={...e},m[t]=Object.keys(o[t])):o[t]=e,h(t,e)},P=(t,e,i)=>{o[t][e]=i,a[t]=[...o[t]],h(t,a[t])},z=t=>{o[t]||(o[t]=[]),o[t].push(""),a[t]=[...o[t]],h(t,a[t])},J=(t,e)=>{o[t].splice(e,1),a[t]=[...o[t]],h(t,a[t])},G=(t,e,i,r)=>{if(e===r||!r)return;const c={...o[t]},s=c[e];delete c[e],c[r]=s,o[t]=c,m[t][i]=r,a[t]={...c},h(t,a[t])},H=(t,e,i)=>{!isNaN(i)&&i!==""?o[t][e]=Number(i):o[t][e]=i,a[t]={...o[t]},h(t,a[t])},Q=t=>{o[t]||(o[t]={},m[t]=[]);const e=`key${Object.keys(o[t]).length+1}`;o[t][e]="",m[t].push(e),a[t]={...o[t]},h(t,a[t])},W=(t,e)=>{delete o[t][e];const i=m[t].indexOf(e);i>-1&&m[t].splice(i,1),a[t]={...o[t]},h(t,a[t])},h=(t,e)=>{F("change",{field:t,value:e,formData:{...a}})},X=()=>{const t={roomID:g.roomID,id:g.modID};Z.setting.disableMod.post(t).then(e=>{at(e.message),F("disableRefresh")})};return B({getFormData:()=>({...a})}),N(()=>{L()}),(t,e)=>{const i=Y;return p(),v(ct,null,{default:u(()=>[l(nt,null,{default:u(()=>[tt("div",pt,[j(D(g.title)+" ",1),l(C,{variant:"text",color:"error","prepend-icon":"ri-prohibited-2-line",onClick:X},{default:u(()=>[j(D(n(y)("game.mod.setting.disable")),1)]),_:1})])]),_:1}),l(st,null,{default:u(()=>[l(lt,null,{default:u(()=>[l(mt,{height:g.height,style:{"overflow-y":"auto"}},{default:u(()=>[l(it,null,{default:u(()=>[n(V).length!==0?(p(!0),_(k,{key:0},I(n(V),r=>(p(),v(U,{key:r.name,cols:"12"},{default:u(()=>[x((p(),v(ut,{modelValue:n(a)[r.name],"onUpdate:modelValue":[c=>n(a)[r.name]=c,c=>M(r.name,c)],items:r.options,"item-title":"description","item-value":"data",label:r.label,variant:"outlined"},{item:u(({props:c,item:s})=>[x(l(ot,rt({ref_for:!0},c),null,16),[[$,s.raw.hover]])]),_:1},8,["modelValue","onUpdate:modelValue","items","label"])),[[$,r.hover]]),q(r.name)?(p(),_("div",gt,[(p(!0),_(k,null,I(n(o)[r.name],(c,s)=>(p(),_("div",{key:s,class:"d-flex align-center mb-2"},[l(O,{modelValue:n(o)[r.name][s],"onUpdate:modelValue":[b=>n(o)[r.name][s]=b,b=>P(r.name,s,b)],label:`${n(y)("game.mod.setting.item")} ${s+1}`,variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","label"]),l(C,{icon:"ri-close-line",variant:"text",color:"error",class:"ml-2",onClick:b=>J(r.name,s)},null,8,["onClick"])]))),128)),l(C,{color:"success","prepend-icon":"ri-add-line",onClick:c=>z(r.name)},{default:u(()=>[j(D(n(y)("game.mod.setting.add")),1)]),_:1},8,["onClick"])])):E(r.name)?(p(),_("div",ht,[(p(!0),_(k,null,I(n(o)[r.name],(c,s,b)=>(p(),_("div",{key:s,class:"d-flex align-center mb-2"},[l(O,{modelValue:n(m)[r.name][b],"onUpdate:modelValue":[d=>n(m)[r.name][b]=d,d=>G(r.name,s,b,d)],label:n(y)("game.mod.setting.key"),variant:"outlined",class:"mr-2"},null,8,["modelValue","onUpdate:modelValue","label"]),l(O,{modelValue:n(o)[r.name][s],"onUpdate:modelValue":[d=>n(o)[r.name][s]=d,d=>H(r.name,s,d)],label:n(y)("game.mod.setting.value"),variant:"outlined",class:"mr-2",type:R(c)},null,8,["modelValue","onUpdate:modelValue","label","type"]),l(C,{icon:"ri-close-line",variant:"text",color:"error",onClick:d=>W(r.name,s)},null,8,["onClick"])]))),128)),l(C,{color:"success","prepend-icon":"ri-add-line",onClick:c=>Q(r.name)},{default:u(()=>[j(D(n(y)("game.mod.setting.add")),1)]),_:1},8,["onClick"])])):et("",!0)]),_:2},1024))),128)):(p(),v(U,{key:1},{default:u(()=>[l(i,{type:"warning",title:n(y)("game.mod.setting.tip.noConfig"),height:g.height-32},null,8,["title","height"])]),_:1}))]),_:1})]),_:1},8,["height"])]),_:1})]),_:1})]),_:1})}}},Pt=w(bt,[["__scopeId","data-v-c0dc599b"]]);export{Pt as default};
