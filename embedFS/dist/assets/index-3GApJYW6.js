import{_ as O}from"./Result-BwoN2Uld.js";import{e as j,b as J,u as Q,d as X,g as Y,h as b,W as Z,f as ee,a8 as te,a9 as ae,c as y,l as e,o as r,k as m,a as t,A as f,I as g,ah as le,w as a,v as n,t as s,s as k,F as $,y as oe,V as F,z as se,ab as re,$ as ne,P as M,D as ie,p as ue,ad as W,R as de}from"./index-CMKCSYdO.js";import{r as ce}from"./room-Cfkea4h9.js";import{C as me}from"./vue3-count-to.esm-CGLiyhPG.js";import{e as fe}from"./eventBus-B8tShFcG.js";import{V as pe}from"./VTextField-DSK81GDs.js";import{V}from"./VRow-DoAY8C7w.js";import{V as c}from"./VCol-BFJpflil.js";import{V as x}from"./VChip-Bk2gsPMH.js";import{V as ge}from"./VMenu-iADqZB_W.js";import{V as he,a as L,b as B}from"./VList-BeTdI8h_.js";import{V as _e}from"./VSheet-Ba81t4RC.js";import{V as ve}from"./VSparkline-D64Yxelb.js";import{V as be}from"./VPagination-Cc6OLUvh.js";import"./VContainer-dfBEfeXA.js";/* empty css              */import"./axios-dEuv8C7T.js";import"./index-DGBzjDo7.js";import"./VInput-BVFTscmb.js";import"./VSlideGroup-Br9BzrjI.js";import"./dialog-transition-1BFQW-Tr.js";import"./ssrBoot-CJNhhsY7.js";import"./VDivider-Cxv4jZxD.js";const ye={class:"fcc"},Ve={class:"fcb"},we={class:"fcc"},ke=["onClick"],xe={class:"text-caption text-grey"},Ce={class:"text-h3 font-weight-black"},Ne={key:1},ze={key:1},Me={key:2},Ze={__name:"index",setup(Se){const{mobile:i}=j(),{t:l}=J(),E=Q(),C=X(),N=Y(),w=b(window.innerHeight),H=()=>Math.max(2,Math.floor((w.value-204)/300)*2),u=b({gameName:"",page:1,pageSize:0}),S=b([]),T=b(0),I=b(!1),h=async()=>{I.value=!0;const d=await ce.list.get(u.value);S.value=d.data.rows||[],T.value=d.data.total,I.value=!1},D=async()=>{N.room={id:0,gameName:""},U(),await E.push("/game/base")},U=()=>{fe.emit("toggleMenu",3)},K=d=>{N.room.id=d.id,N.room.gameName=d.gameName},G=d=>{if(d.length===0)return[0,0];const p=[];for(let _ of d)p.push(_.playerInfo?.length||0);return p},z=b(),R=b(0),P=()=>Math.max(2,Math.floor(w.value-120));Z(w,()=>{h()},{immediate:!1});const A=te(()=>{w.value=window.innerHeight,u.value.pageSize=H(),z.value&&(R.value=z.value.$el.offsetWidth)},200);return ee(async()=>{u.value.pageSize=H(),z.value&&(R.value=z.value.$el.offsetWidth),await h(),window.addEventListener("resize",A)}),ae(()=>{window.removeEventListener("resize",A)}),(d,p)=>{const _=O;return e(N).gameVersion.local!==0?(r(),y($,{key:0},[m("div",ye,[t(pe,{modelValue:e(u).gameName,"onUpdate:modelValue":p[0]||(p[0]=o=>e(u).gameName=o),label:e(l)("rooms.header.input.label"),placeholder:e(l)("rooms.header.input.placeholder"),"append-inner-icon":"ri-search-line",class:"mr-4",loading:e(I),"onClick:appendInner":h,onKeyup:le(h,["enter"])},null,8,["modelValue","label","placeholder","loading"]),e(i)?g("",!0):(r(),f(k,{key:0,disabled:!e(C).userInfo.roomCreation&&e(C).userInfo.role!=="admin","prepend-icon":"ri-add-line",variant:"elevated",size:"large",class:"mr-4",onClick:D},{default:a(()=>[n(s(e(l)("rooms.header.button.create")),1)]),_:1},8,["disabled"])),e(i)?g("",!0):(r(),f(k,{key:1,"prepend-icon":"ri-refresh-line",color:"default",variant:"elevated",size:"large",onClick:h},{default:a(()=>[n(s(e(l)("rooms.header.button.refresh")),1)]),_:1})),e(i)?(r(),f(k,{key:2,disabled:!e(C).userInfo.roomCreation&&e(C).userInfo.role!=="admin",icon:"ri-add-line",class:"mr-4",onClick:D},null,8,["disabled"])):g("",!0),e(i)?(r(),f(k,{key:3,icon:"ri-refresh-line",color:"default",onClick:h})):g("",!0)]),t(V,{class:"mt-8"},{default:a(()=>[t(V,null,{default:a(()=>[(r(!0),y($,null,oe(e(S),(o,q)=>(r(),f(c,{cols:e(i)?12:6},{default:a(()=>[t(F,{ref_for:!0,ref:v=>{q===0&&(z.value=v)},hover:!0,variant:"flat",height:e(i)?"600px":"300px"},{default:a(()=>[t(re,null,{default:a(()=>[m("div",Ve,[m("div",we,[t(x,{color:"primary"},{default:a(()=>[n(s(e(ne)(o.gameName,e(i)?8:15)),1)]),_:2},1024),t(x,{color:o.status?"success":"warning",class:"ml-4"},{default:a(()=>[n(s(o.status?e(l)("rooms.card.success.header.title.activated"):e(l)("rooms.card.success.header.title.deactivated")),1)]),_:2},1032,["color"]),e(N).room.id===o.id?(r(),f(M,{key:0,icon:"ri-crosshair-2-line",color:"info",class:"ml-4"})):g("",!0)]),t(ge,null,{activator:a(({props:v})=>[t(k,ie({ref_for:!0},v,{disabled:e(I),color:"primary",icon:"ri-more-2-line"}),null,16,["disabled"])]),default:a(()=>[t(he,null,{default:a(()=>[t(L,{class:"text-success",onClick:v=>console.log(o.name)},{prepend:a(()=>[t(M,{icon:"ri-play-large-line",size:"22"})]),default:a(()=>[t(B,null,{default:a(()=>[n(s(e(l)("rooms.card.success.header.menu.activate")),1)]),_:1})]),_:1},8,["onClick"]),t(L,{class:"text-warning",onClick:v=>console.log(o.name)},{prepend:a(()=>[t(M,{icon:"ri-stop-large-line",color:"warning",size:"22"})]),default:a(()=>[t(B,null,{default:a(()=>[n(s(e(l)("rooms.card.success.header.menu.deactivate")),1)]),_:1})]),_:1},8,["onClick"]),t(L,{class:"text-error",onClick:v=>console.log(o.name)},{prepend:a(()=>[t(M,{icon:"ri-delete-bin-line",color:"error",size:"22"})]),default:a(()=>[t(B,null,{default:a(()=>[n(s(e(l)("rooms.card.success.header.menu.delete")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024),se((r(),f(ue,null,{default:a(()=>[o.gameName!==""?(r(),y("div",{key:0,class:"mt-4",onClick:v=>K(o)},[t(V,null,{default:a(()=>[t(c,{cols:e(i)?12:6},{default:a(()=>[t(V,null,{default:a(()=>[t(c,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.gameMode")),1)]),_:1}),t(c,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(e(l)(`game.base.step1.gameMode.modes.${o.gameMode}`)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(V,null,{default:a(()=>[t(c,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.worldNum")),1)]),_:1}),t(c,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(o.worlds.length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(V,null,{default:a(()=>[t(c,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.modNum")),1)]),_:1}),t(c,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(o.modInOne?e(W)(o.modData).length:e(W)(o.worlds[0].modData).length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(V,null,{default:a(()=>[t(c,{cols:"6"},{default:a(()=>[m("span",null,s(e(l)("rooms.card.success.text.left.playerNum")),1)]),_:1}),t(c,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[n(s(o.maxPlayer),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"]),t(c,{cols:e(i)?12:6},{default:a(()=>[t(F,{height:240,variant:"flat"},{prepend:a(()=>[t(M,{color:"primary",class:"me-8",icon:"ri-line-chart-line",size:"48"})]),title:a(()=>[m("div",xe,s(e(l)("rooms.card.success.text.right.chartTitle")),1),m("span",Ce,[t(e(me),{duration:4e3,"end-val":Math.max(...G(o.players)),"start-val":0},null,8,["end-val"])]),m("strong",null,s(e(l)("rooms.card.success.text.right.unit")),1)]),default:a(()=>[t(_e,{color:"transparent"},{default:a(()=>[t(ve,{width:e(i)?e(R):e(R)/2,gradient:["#1feaea"],"line-width":3,"model-value":G(o.players),smooth:!0,padding:"8","stroke-linecap":"round","auto-draw":""},null,8,["width","model-value"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"])]),_:2},1024)],8,ke)):(r(),y("div",Ne,[t(_,{type:"warning",height:e(i)?600:300,title:e(l)("rooms.card.warning.title"),"sub-title":e(l)("rooms.card.warning.subTitle")},null,8,["height","title","sub-title"])]))]),_:2},1024)),[[de]])]),_:2},1032,["height"])]),_:2},1032,["cols"]))),256))]),_:1})]),_:1}),e(T)>e(u).pageSize?(r(),f(be,{key:0,modelValue:e(u).page,"onUpdate:modelValue":[p[1]||(p[1]=o=>e(u).page=o),h],length:Math.max(1,Math.ceil(e(T)/e(u).pageSize)),class:"mt-8"},null,8,["modelValue","length"])):g("",!0),e(S).length===0&&e(u).gameName!==""?(r(),y("div",ze,[t(_,{type:"warning",height:e(w),title:e(l)("rooms.result.noResult.title"),"sub-title":e(l)("rooms.result.noResult.subTitle")},null,8,["height","title","sub-title"])])):g("",!0),e(S).length===0&&e(u).gameName===""?(r(),y("div",Me,[t(_,{type:"warning",height:e(w),title:e(l)("rooms.result.noRoom.title"),"sub-title":e(l)("rooms.result.noRoom.subTitle")},null,8,["height","title","sub-title"])])):g("",!0)],64)):(r(),y($,{key:1},[e(C).userInfo.role==="admin"?(r(),f(_,{key:0,title:e(l)("global.noGame.title"),"sub-title":e(l)("global.noGame.subTitle"),height:P(),type:"error"},{default:a(()=>[t(k,{to:"/install",class:"mt-4"},{default:a(()=>[n(s(e(l)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(r(),f(_,{key:1,title:e(l)("global.noGameNoAdmin.title"),"sub-title":e(l)("global.noGameNoAdmin.subTitle"),height:P(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{Ze as default};
