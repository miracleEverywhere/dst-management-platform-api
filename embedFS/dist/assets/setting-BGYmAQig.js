import{_ as z}from"./Result-_4bJ9fXr.js";import J from"./settingForm-hZ4ph9-s.js";import{m as I}from"./mod-ZF27zciD.js";import{g as K,b as Q,h as n,f as X,c as b,o as e,y as o,E as g,a as d,w as a,F as S,v as U,k as v,t as x,l as m,p as Y,q as B,x as ee,U as te,V as Z,a9 as ae,R as oe,B as le}from"./index-CDcWfGDJ.js";import{r as ie}from"./room-C4fPaH6c.js";import{a as se,V as ne}from"./VRadioGroup-Hoie8LG6.js";import{V as $}from"./VCol-DeigZOGo.js";import{V as L,c as re,a as N}from"./VCard-BouBlXSm.js";import{V as q}from"./VContainer-BoKUoFFr.js";import{V as O}from"./VChip-Dku4Yyu4.js";import{V as de}from"./VRow-p1Sjh_dt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VForm-QXtRIWxr.js";import"./VInput-G0w3PBPn.js";import"./index-DpLahWRr.js";import"./VSelect-BNmCSL0R.js";import"./VTextField-DmrWhRLR.js";import"./VList-D8GqwDvf.js";import"./ssrBoot-DgnhOsXk.js";import"./VMenu-xIC2NBar.js";import"./dialog-transition-QRikj67Z.js";import"./VCheckboxBtn-6Huv9Ei8.js";import"./VSelectionControl-Bq8e-kuH.js";import"./index-Dk7TO_po.js";import"./VTooltip-D7LLOHHa.js";import"./axios-BurQrId6.js";/* empty css              */const ue={class:"card-header"},me={style:{height:"120px"}},ce=["onClick"],ge={class:"w-33"},he={class:"d-flex align-center justify-center fill-height"},fe={class:"w-66 d-flex justify-start align-center ml-4"},ve='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#9FCFF8"><path d="M21 11.6736C20.0907 11.2417 19.0736 11 18 11C14.134 11 11 14.134 11 18C11 19.4872 11.4638 20.8662 12.2547 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918C3 2.44405 3.44495 2 3.9934 2H16L21 7V11.6736ZM18 23C15.2386 23 13 20.7614 13 18C13 15.2386 15.2386 13 18 13C20.7614 13 23 15.2386 23 18C23 20.7614 20.7614 23 18 23ZM16.7066 20.7076C17.0982 20.895 17.5369 21 18 21C19.6569 21 21 19.6569 21 18C21 17.5369 20.895 17.0982 20.7076 16.7066L16.7066 20.7076ZM15.2924 19.2934L19.2934 15.2924C18.9018 15.105 18.4631 15 18 15C16.3431 15 15 16.3431 15 18C15 18.4631 15.105 18.9018 15.2924 19.2934Z"></path></svg>',He={__name:"setting",props:{height:{type:Number,default:0}},setup(j){const r=j,h=K(),{t:u}=Q(),p=n(!1),_=n(!1),y=n(!1),f=n(0),c=n(!0),E=n({}),F=n([]),A=async()=>{if(h.room.id!==0){const l=await ie.base.get({id:h.room.id});E.value=l.data.roomData,F.value=l.data.worldData,E.value.modInOne||(f.value=F.value[0].id,c.value=!1)}},k=async()=>{_.value=!0,D.value=[],M.value=[],V.value="";const l={roomID:h.room.id,worldID:f.value},s=await I.setting.enabledMods.get(l);C.value=s.data||[],_.value=!1,p.value=!1},G=async(l,s,i,t)=>{p.value=!0,y.value=!0,T.value=s,R.value=l,V.value="",l===0?(V.value=u("game.mod.setting.clientModsDisabled"),D.value=[],M.value=[]):(await Promise.all([H(l,s,i),P(l,s,i)]),V.value=t),y.value=!1},H=async(l,s,i)=>{const t={roomID:h.room.id,worldID:s,id:l,file_url:i},w=await I.setting.modConfigStruct.get(t);D.value=w.data||[]},P=async(l,s,i)=>{const t={roomID:h.room.id,worldID:s,id:l,file_url:i},w=await I.setting.modConfigValue.get(t);M.value=w.data?.configuration_options||{}},C=n([]),D=n([]),M=n([]),V=n(""),T=n(0),R=n(0),W=l=>{const s={roomID:h.room.id,worldID:f.value,id:R.value,modORConfig:{configuration_options:l.formData,enabled:!0}};I.setting.modConfigValue.put(s).then(i=>{le(i.message)})};return X(async()=>{await A(),await k()}),(l,s)=>{const i=z;return e(),b(S,null,[c.value?g("",!0):(e(),o(ne,{key:0,modelValue:f.value,"onUpdate:modelValue":[s[0]||(s[0]=t=>f.value=t),k],inline:"",class:"mb-2"},{default:a(()=>[(e(!0),b(S,null,U(F.value,t=>(e(),o(se,{label:t.worldName,value:t.id,class:"mr-4"},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])),d(de,null,{default:a(()=>[d($,{cols:"12",md:"4"},{default:a(()=>[d(L,{disabled:_.value,loading:_.value},{default:a(()=>[d(re,null,{default:a(()=>[v("div",ue,[v("span",null,x(m(u)("game.mod.setting.enabledMods")),1),d(Y,{"prepend-icon":"ri-refresh-line",color:"default",variant:"text",loading:_.value,onClick:k},{default:a(()=>[B(x(m(u)("game.mod.setting.refresh")),1)]),_:1},8,["loading"])])]),_:1}),d(N,null,{default:a(()=>[C.value.length!==0?(e(),o(q,{key:0,height:c.value?r.height:r.height-48,style:{"overflow-y":"auto"}},{default:a(()=>[(e(!0),b(S,null,U(C.value,(t,w)=>(e(),b("div",me,[w!==0?(e(),o(te,{key:0})):g("",!0),ee((e(),b("div",{class:"fcc cursor-pointer",onClick:pe=>G(t.id,f.value,t.file_url,t.name)},[v("div",ge,[t.id!==0?(e(),o(Z,{key:0,cover:"",rounded:"",width:100,height:100,"aspect-ratio":"1/1",src:t.preview_url,class:"ma-2"},{placeholder:a(()=>[v("div",he,[d(ae,{color:"grey-lighten-4",indeterminate:""})])]),_:1},8,["src"])):(e(),o(Z,{key:1,width:100,height:100,"aspect-ratio":"1/1",src:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(ve)}`,class:"ma-2"},null,8,["src"]))]),v("div",fe,[t.id!==0?(e(),o(O,{key:0,color:"info",label:""},{default:a(()=>[B(x(t.name),1)]),_:2},1024)):(e(),o(O,{key:1,color:"info",label:""},{default:a(()=>[B(x(m(u)("game.mod.setting.clientModsDisabled")),1)]),_:1}))])],8,ce)),[[oe]])]))),256))]),_:1},8,["height"])):g("",!0),C.value.length===0&&!c.value?(e(),o(q,{key:1,height:r.height-48,style:{"overflow-y":"auto"}},{default:a(()=>[d(i,{type:"info",title:m(u)("game.mod.setting.tip.noEnabledMods"),height:r.height-48-38},null,8,["title","height"])]),_:1},8,["height"])):g("",!0),C.value.length===0&&c.value?(e(),o(q,{key:2,height:r.height,style:{"overflow-y":"auto"}},{default:a(()=>[d(i,{type:"info",title:m(u)("game.mod.setting.tip.noEnabledMods"),height:r.height-48},null,8,["title","height"])]),_:1},8,["height"])):g("",!0)]),_:1})]),_:1},8,["disabled","loading"])]),_:1}),d($,{cols:"12",md:"8"},{default:a(()=>[v("div",null,[p.value&&!y.value?(e(),o(J,{key:0,fields:D.value,"initial-data":M.value,height:c.value?r.height:r.height-48,title:V.value,"room-i-d":m(h).room.id,"world-i-d":T.value,"mod-i-d":R.value,onChange:W,onDisableRefresh:k},null,8,["fields","initial-data","height","title","room-i-d","world-i-d","mod-i-d"])):g("",!0),p.value&&y.value?(e(),o(L,{key:1},{default:a(()=>[d(N,null,{default:a(()=>[c.value?(e(),o(i,{key:0,type:"info",title:m(u)("game.mod.setting.tip.fetching"),height:r.height+34},null,8,["title","height"])):(e(),o(i,{key:1,type:"info",title:m(u)("game.mod.setting.tip.fetching"),height:r.height-12},null,8,["title","height"]))]),_:1})]),_:1})):g("",!0),!p.value&&!y.value?(e(),o(L,{key:2},{default:a(()=>[d(N,null,{default:a(()=>[c.value?(e(),o(i,{key:0,type:"info",title:m(u)("game.mod.setting.tip.selectMod"),height:r.height+34},null,8,["title","height"])):(e(),o(i,{key:1,type:"info",title:m(u)("game.mod.setting.tip.selectMod"),height:r.height-12},null,8,["title","height"]))]),_:1})]),_:1})):g("",!0)])]),_:1})]),_:1})],64)}}};export{He as default};
