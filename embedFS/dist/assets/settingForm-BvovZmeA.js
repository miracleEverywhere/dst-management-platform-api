import{_ as Y}from"./Result-BwoN2Uld.js";import{m as Z}from"./mod-Dh2bBxzH.js";import{_ as f,b as w,aR as A,j as K,f as N,A as C,o as p,w as u,a as l,ab as tt,k as et,v as j,t as D,s as v,l as n,p as ot,c as _,F as k,y as I,z as x,I as rt,D as at,V as nt,E as st}from"./index-CMKCSYdO.js";import{V as ct}from"./VForm-DoitQom2.js";import{V as lt}from"./VContainer-dfBEfeXA.js";import{V as mt}from"./VRow-DoAY8C7w.js";import{V as U}from"./VCol-BFJpflil.js";import{V as it}from"./VSelect-DXelBhLk.js";import{a as ut}from"./VList-BeTdI8h_.js";import{T as $}from"./index-DdU_lRdx.js";import{V as O}from"./VTextField-DSK81GDs.js";import"./axios-dEuv8C7T.js";import"./VInput-BVFTscmb.js";import"./index-DGBzjDo7.js";/* empty css              */import"./VMenu-iADqZB_W.js";import"./dialog-transition-1BFQW-Tr.js";import"./VDivider-Cxv4jZxD.js";import"./VSelectionControl-DRxzzoA5.js";import"./VChip-Bk2gsPMH.js";import"./VSlideGroup-Br9BzrjI.js";import"./ssrBoot-CJNhhsY7.js";import"./VTooltip-TkMGmhqz.js";const pt={class:"card-header"},gt={key:0,class:"array-field mt-4"},ht={key:1,class:"object-field mt-4"},bt={__name:"settingForm",props:{fields:{type:Array,required:!0,default:()=>[]},initialData:{type:Object,default:()=>({})},height:{type:Number,default:0},title:{type:String,default:""},roomID:{type:Number,default:0},worldID:{type:Number,default:0},modID:{type:Number,default:0}},emits:["change","disableRefresh"],setup(T,{expose:B,emit:S}){const g=T,F=S,{t:y}=w(),a=A({}),o=A({}),m=A({}),V=K(()=>g.fields),E=t=>Array.isArray(a[t]),R=t=>{const e=a[t];return e&&typeof e=="object"&&!Array.isArray(e)},q=t=>typeof t=="number"?"number":"text",z=()=>{Object.keys(g.initialData).length===0?(V.value||(V.value=[]),V.value.forEach(t=>{const e=t.default;a[t.name]=e,Array.isArray(e)?(o[t.name]=[...e],m[t.name]=[]):e&&typeof e=="object"?(o[t.name]={...e},m[t.name]=Object.keys(o[t.name])):o[t.name]=e})):Object.entries(g.initialData).forEach(([t,e])=>{a[t]=e,Array.isArray(e)?(o[t]=[...e],m[t]=[]):e&&typeof e=="object"?(o[t]={...e},m[t]=Object.keys(o[t])):o[t]=e})},L=(t,e)=>{a[t]=e,Array.isArray(e)?(o[t]=e.length>0?[...e]:[],m[t]=[]):e&&typeof e=="object"?(o[t]={...e},m[t]=Object.keys(o[t])):o[t]=e,h(t,e)},M=(t,e,i)=>{o[t][e]=i,a[t]=[...o[t]],h(t,a[t])},P=t=>{o[t]||(o[t]=[]),o[t].push(""),a[t]=[...o[t]],h(t,a[t])},G=(t,e)=>{o[t].splice(e,1),a[t]=[...o[t]],h(t,a[t])},H=(t,e,i,r)=>{if(e===r||!r)return;const c={...o[t]},s=c[e];delete c[e],c[r]=s,o[t]=c,m[t][i]=r,a[t]={...c},h(t,a[t])},J=(t,e,i)=>{!isNaN(i)&&i!==""?o[t][e]=Number(i):o[t][e]=i,a[t]={...o[t]},h(t,a[t])},Q=t=>{o[t]||(o[t]={},m[t]=[]);const e=`key${Object.keys(o[t]).length+1}`;o[t][e]="",m[t].push(e),a[t]={...o[t]},h(t,a[t])},W=(t,e)=>{delete o[t][e];const i=m[t].indexOf(e);i>-1&&m[t].splice(i,1),a[t]={...o[t]},h(t,a[t])},h=(t,e)=>{F("change",{field:t,value:e,formData:{...a}})},X=()=>{const t={roomID:g.roomID,id:g.modID};Z.setting.disableMod.post(t).then(e=>{st(e.message),F("disableRefresh")})};return B({getFormData:()=>({...a})}),N(()=>{z()}),(t,e)=>{const i=Y;return p(),C(nt,null,{default:u(()=>[l(tt,null,{default:u(()=>[et("div",pt,[j(D(g.title)+" ",1),l(v,{variant:"text",color:"error","prepend-icon":"ri-prohibited-2-line",onClick:X},{default:u(()=>[j(D(n(y)("game.mod.setting.disable")),1)]),_:1})])]),_:1}),l(ot,null,{default:u(()=>[l(ct,null,{default:u(()=>[l(lt,{height:g.height,style:{"overflow-y":"auto"}},{default:u(()=>[l(mt,null,{default:u(()=>[n(V).length!==0?(p(!0),_(k,{key:0},I(n(V),r=>(p(),C(U,{key:r.name,cols:"12"},{default:u(()=>[x((p(),C(it,{modelValue:n(a)[r.name],"onUpdate:modelValue":[c=>n(a)[r.name]=c,c=>L(r.name,c)],items:r.options,"item-title":"description","item-value":"data",label:r.label,variant:"outlined"},{item:u(({props:c,item:s})=>[x(l(ut,at({ref_for:!0},c),null,16),[[$,s.raw.hover]])]),_:1},8,["modelValue","onUpdate:modelValue","items","label"])),[[$,r.hover]]),E(r.name)?(p(),_("div",gt,[(p(!0),_(k,null,I(n(o)[r.name],(c,s)=>(p(),_("div",{key:s,class:"d-flex align-center mb-2"},[l(O,{modelValue:n(o)[r.name][s],"onUpdate:modelValue":[b=>n(o)[r.name][s]=b,b=>M(r.name,s,b)],label:`${n(y)("game.mod.setting.item")} ${s+1}`,variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","label"]),l(v,{icon:"ri-close-line",variant:"text",color:"error",class:"ml-2",onClick:b=>G(r.name,s)},null,8,["onClick"])]))),128)),l(v,{color:"success","prepend-icon":"ri-add-line",onClick:c=>P(r.name)},{default:u(()=>[j(D(n(y)("game.mod.setting.add")),1)]),_:1},8,["onClick"])])):R(r.name)?(p(),_("div",ht,[(p(!0),_(k,null,I(n(o)[r.name],(c,s,b)=>(p(),_("div",{key:s,class:"d-flex align-center mb-2"},[l(O,{modelValue:n(m)[r.name][b],"onUpdate:modelValue":[d=>n(m)[r.name][b]=d,d=>H(r.name,s,b,d)],label:n(y)("game.mod.setting.key"),variant:"outlined",class:"mr-2"},null,8,["modelValue","onUpdate:modelValue","label"]),l(O,{modelValue:n(o)[r.name][s],"onUpdate:modelValue":[d=>n(o)[r.name][s]=d,d=>J(r.name,s,d)],label:n(y)("game.mod.setting.value"),variant:"outlined",class:"mr-2",type:q(c)},null,8,["modelValue","onUpdate:modelValue","label","type"]),l(v,{icon:"ri-close-line",variant:"text",color:"error",onClick:d=>W(r.name,s)},null,8,["onClick"])]))),128)),l(v,{color:"success","prepend-icon":"ri-add-line",onClick:c=>Q(r.name)},{default:u(()=>[j(D(n(y)("game.mod.setting.add")),1)]),_:1},8,["onClick"])])):rt("",!0)]),_:2},1024))),128)):(p(),C(U,{key:1},{default:u(()=>[l(i,{type:"warning",title:n(y)("game.mod.setting.tip.noConfig"),height:g.height-32},null,8,["title","height"])]),_:1}))]),_:1})]),_:1},8,["height"])]),_:1})]),_:1})]),_:1})}}},Mt=f(bt,[["__scopeId","data-v-c0dc599b"]]);export{Mt as default};
