import{_ as se}from"./Result-CYRmgfzl.js";import ne from"./settingForm-BYfFD-3g.js";import{m as P}from"./mod-a62V8x39.js";import{ah as re,ai as ue,ar as de,f as s,aK as ce,aj as me,aL as ge,a as d,E as K,aM as he,as as ve,g as fe,b as pe,e as Ve,j as ye,c as B,o as t,A as a,D as f,w as l,F as j,y as Y,V as Z,aa as Ce,k as D,t as L,l as c,s as J,v as N,p as G,Y as be,z as O,m as Q,ae as _e,R as H,G as X}from"./index-ClrSl1t3.js";import{r as ke}from"./room-Ey6piun-.js";import{a as we,V as De}from"./VRadioGroup-C8htqHE2.js";import{V as ee}from"./VCol-sdmSdw58.js";import{V as W}from"./VContainer-D204xFB2.js";import{V as te,m as Me}from"./VCheckboxBtn-CD061qxM.js";import{u as xe,V as ae,m as Ie}from"./VInput-Dh0vzV9z.js";import{V as le}from"./VChip-DSSyFDgp.js";import{V as Fe}from"./VRow-CbuO1l1g.js";import"./VForm-CIWyr5ey.js";import"./VSelect-HjFTEHVC.js";import"./VTextField-C20ssUm5.js";import"./index-rIMhUL3t.js";import"./VList-CRtGEhVV.js";import"./ssrBoot-4_sUra1R.js";import"./VMenu-DVaqAgsw.js";import"./dialog-transition-BOVVgIJg.js";import"./index-B1lLXV_1.js";import"./VTooltip-DCsw7vZM.js";import"./axios-DEwtRmaY.js";import"./VSelectionControl-DRns-ek4.js";/* empty css              */const Re=ue({...Ie(),...ve(Me(),["inline"])},"VCheckbox"),Pe=re()({name:"VCheckbox",inheritAttrs:!1,props:Re(),emits:{"update:modelValue":m=>!0,"update:focused":m=>!0},setup(m,u){let{attrs:h,slots:n}=u;const p=de(m,"modelValue"),{isFocused:V,focus:y,blur:C}=xe(m),g=s(),v=ce();return me(()=>{const[S,F]=ge(h),$=ae.filterProps(m),b=te.filterProps(m);return d(ae,K({ref:g,class:["v-checkbox",m.class]},S,$,{modelValue:p.value,"onUpdate:modelValue":_=>p.value=_,id:m.id||`checkbox-${v}`,focused:V.value,style:m.style}),{...n,default:_=>{let{id:T,messagesId:U,isDisabled:k,isReadonly:M,isValid:x}=_;return d(te,K(b,{id:T.value,"aria-describedby":U.value,disabled:k.value,readonly:M.value},F,{error:x.value===!1,modelValue:p.value,"onUpdate:modelValue":w=>p.value=w,onFocus:y,onBlur:C}),n)}})}),he({},g)}}),Be={class:"card-header"},Le={style:{height:"120px"}},Se={class:"fcc"},Ae=["onClick"],Ne={class:"d-flex align-center justify-center fill-height"},$e={class:"w-66 d-flex justify-start align-center ml-4"},Te='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#9FCFF8"><path d="M21 11.6736C20.0907 11.2417 19.0736 11 18 11C14.134 11 11 14.134 11 18C11 19.4872 11.4638 20.8662 12.2547 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918C3 2.44405 3.44495 2 3.9934 2H16L21 7V11.6736ZM18 23C15.2386 23 13 20.7614 13 18C13 15.2386 15.2386 13 18 13C20.7614 13 23 15.2386 23 18C23 20.7614 20.7614 23 18 23ZM16.7066 20.7076C17.0982 20.895 17.5369 21 18 21C19.6569 21 21 19.6569 21 18C21 17.5369 20.895 17.0982 20.7076 16.7066L16.7066 20.7076ZM15.2924 19.2934L19.2934 15.2924C18.9018 15.105 18.4631 15 18 15C16.3431 15 15 16.3431 15 18C15 18.4631 15.105 18.9018 15.2924 19.2934Z"></path></svg>',dt={__name:"setting",props:{height:{type:Number,default:0}},setup(m){const u=m,h=fe(),{t:n}=pe(),{mobile:p}=Ve(),V=s(!1),y=s(!1),C=s(!1),g=s(0),v=s(!0),S=s({}),F=s([]),$=async()=>{if(h.room.id!==0){const o=await ke.base.get({id:h.room.id});S.value=o.data.roomData,F.value=o.data.worldData,S.value.modInOne||(g.value=F.value[0].id,v.value=!1)}},b=async()=>{y.value=!0,I.value=[],M.value=[],x.value=[],w.value="";const o={roomID:h.room.id,worldID:g.value},i=await P.setting.enabledMods.get(o);k.value=i.data||[],y.value=!1,V.value=!1},_=async(o,i,r,e)=>{V.value=!0,C.value=!0,z.value=i,q.value=o,w.value="",o===0?(w.value=n("game.mod.setting.clientModsDisabled"),M.value=[],x.value=[]):(await Promise.all([T(o,i,r),U(o,i,r)]),w.value=e),C.value=!1},T=async(o,i,r)=>{const e={roomID:h.room.id,worldID:i,id:o,file_url:r},R=await P.setting.modConfigStruct.get(e);M.value=R.data||[]},U=async(o,i,r)=>{const e={roomID:h.room.id,worldID:i,id:o,file_url:r},R=await P.setting.modConfigValue.get(e);x.value=R.data?.configuration_options||{}},k=s([]),M=s([]),x=s([]),w=s(""),z=s(0),q=s(0),oe=o=>{const i={roomID:h.room.id,worldID:g.value,id:q.value,modORConfig:{configuration_options:o.formData,enabled:!0}};P.setting.modConfigValue.put(i).then(r=>{X(r.message)})},I=s([]),E=s(!1),ie=async()=>{if(!I.value.length){X(n("game.mod.setting.tip.selectModToDisable"),"error");return}E.value=!0;for(let o of I.value){const i={roomID:h.room.id,id:o};await P.setting.disableMod.post(i)}I.value=[],E.value=!1,await b()};return ye(async()=>{await $(),await b()}),(o,i)=>{const r=se;return t(),B(j,null,[v.value?f("",!0):(t(),a(De,{key:0,modelValue:g.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>g.value=e),b],inline:"",class:"mb-2"},{default:l(()=>[(t(!0),B(j,null,Y(F.value,e=>(t(),a(we,{label:e.worldName,value:e.id,class:"mr-4"},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])),d(Fe,null,{default:l(()=>[d(ee,{cols:"12",md:"4"},{default:l(()=>[d(Z,{disabled:y.value,loading:y.value},{default:l(()=>[d(Ce,null,{default:l(()=>[D("div",Be,[D("span",null,L(c(n)("game.mod.setting.enabledMods")),1),D("div",null,[c(p)?f("",!0):(t(),a(J,{key:0,"prepend-icon":"ri-prohibited-2-line",color:"error",variant:"text",loading:E.value,onClick:ie},{default:l(()=>[N(L(c(n)("game.mod.setting.multiDisable")),1)]),_:1},8,["loading"])),d(J,{"prepend-icon":"ri-refresh-line",color:"default",variant:"text",loading:y.value,onClick:b},{default:l(()=>[N(L(c(n)("game.mod.setting.refresh")),1)]),_:1},8,["loading"])])])]),_:1}),d(G,null,{default:l(()=>[k.value.length!==0?(t(),a(W,{key:0,height:v.value?u.height:u.height-48,style:{"overflow-y":"auto"}},{default:l(()=>[(t(!0),B(j,null,Y(k.value,(e,R)=>(t(),B("div",Le,[R!==0?(t(),a(be,{key:0})):f("",!0),D("div",Se,[O((t(),B("div",{class:"w-33 cursor-pointer",onClick:A=>_(e.id,g.value,e.file_url,e.name)},[e.id!==0?(t(),a(Q,{key:0,cover:"",rounded:"",width:100,height:100,"aspect-ratio":"1/1",src:e.preview_url,class:"ma-2"},{placeholder:l(()=>[D("div",Ne,[d(_e,{color:"grey-lighten-4",indeterminate:""})])]),_:1},8,["src"])):(t(),a(Q,{key:1,width:100,height:100,"aspect-ratio":"1/1",src:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(Te)}`,class:"ma-2"},null,8,["src"]))],8,Ae)),[[H]]),D("div",$e,[c(p)?f("",!0):(t(),a(Pe,{key:0,modelValue:I.value,"onUpdate:modelValue":i[1]||(i[1]=A=>I.value=A),value:e.id,class:"mr-2"},null,8,["modelValue","value"])),e.id!==0?O((t(),a(le,{key:1,color:"info",label:"",onClick:A=>_(e.id,g.value,e.file_url,e.name)},{default:l(()=>[N(L(e.name),1)]),_:2},1032,["onClick"])),[[H]]):O((t(),a(le,{key:2,color:"info",label:"",onClick:A=>_(e.id,g.value,e.file_url,e.name)},{default:l(()=>[N(L(c(n)("game.mod.setting.clientModsDisabled")),1)]),_:1},8,["onClick"])),[[H]])])])]))),256))]),_:1},8,["height"])):f("",!0),k.value.length===0&&!v.value?(t(),a(W,{key:1,height:u.height-48,style:{"overflow-y":"auto"}},{default:l(()=>[d(r,{type:"info",title:c(n)("game.mod.setting.tip.noEnabledMods"),height:u.height-48-38},null,8,["title","height"])]),_:1},8,["height"])):f("",!0),k.value.length===0&&v.value?(t(),a(W,{key:2,height:u.height,style:{"overflow-y":"auto"}},{default:l(()=>[d(r,{type:"info",title:c(n)("game.mod.setting.tip.noEnabledMods"),height:u.height-48},null,8,["title","height"])]),_:1},8,["height"])):f("",!0)]),_:1})]),_:1},8,["disabled","loading"])]),_:1}),d(ee,{cols:"12",md:"8"},{default:l(()=>[D("div",null,[V.value&&!C.value?(t(),a(ne,{key:0,fields:M.value,"initial-data":x.value,height:v.value?u.height:u.height-48,title:w.value,"room-i-d":c(h).room.id,"world-i-d":z.value,"mod-i-d":q.value,onChange:oe,onDisableRefresh:b},null,8,["fields","initial-data","height","title","room-i-d","world-i-d","mod-i-d"])):f("",!0),V.value&&C.value?(t(),a(Z,{key:1},{default:l(()=>[d(G,null,{default:l(()=>[v.value?(t(),a(r,{key:0,type:"info",title:c(n)("game.mod.setting.tip.fetching"),height:u.height+34},null,8,["title","height"])):(t(),a(r,{key:1,type:"info",title:c(n)("game.mod.setting.tip.fetching"),height:u.height-12},null,8,["title","height"]))]),_:1})]),_:1})):f("",!0),!V.value&&!C.value?(t(),a(Z,{key:2},{default:l(()=>[d(G,null,{default:l(()=>[v.value?(t(),a(r,{key:0,type:"info",title:c(n)("game.mod.setting.tip.selectMod"),height:u.height+34},null,8,["title","height"])):(t(),a(r,{key:1,type:"info",title:c(n)("game.mod.setting.tip.selectMod"),height:u.height-12},null,8,["title","height"]))]),_:1})]),_:1})):f("",!0)])]),_:1})]),_:1})],64)}}};export{dt as default};
