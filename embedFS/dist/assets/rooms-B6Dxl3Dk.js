import{_ as te}from"./ConfirmBox-DU-Fw8Ql.js";import{e as le,b as oe,g as re,h as u,c as M,o as g,a as t,w as e,l as a,ab as se,s as q,a7 as ne,p as R,q as n,t as s,P as S,Q as N,G as h,a6 as E,y as k,E as z,k as B,F as K,v as ie,B as I}from"./index-y7gjWuPm.js";import{r as L}from"./room-6pGSGymX.js";import{p as G}from"./platform-3u3_zjWQ.js";import{a as O,V as Q,c as me}from"./VCard-3t1lA3T-.js";import{V as y}from"./VRow-DSxK_lZ_.js";import{V as v}from"./VCol-umKj9uol.js";import{V as de}from"./VTextField-uMFdyion.js";import{V as ue}from"./VDataTableServer-CWiz4lWm.js";import{V as pe}from"./VMenu-DsEiLSfo.js";import{V as fe}from"./VList-Dq7nw64W.js";import{V as p}from"./VChip-wyhN0sI-.js";import{V as ce,a as ge}from"./VToolbar-C7qPBPBy.js";import{V as W}from"./VAlert-CvkfT0jV.js";import{V as ve}from"./VDialog-Dt6YkoTe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSpacer-Mg5KYyj9.js";/* empty css              */import"./axios-BmRfRVbX.js";import"./index-MCHUliHX.js";import"./VInput-MzIIapS-.js";import"./VDataTable-BBItooe0.js";import"./VPagination-gpFCmWP7.js";import"./VSelect-Dpmldz1w.js";import"./VCheckboxBtn-D2boHj3Q.js";import"./VSelectionControl-BnRoO89R.js";import"./dialog-transition-BlTEFOz9.js";import"./VTable-BaoQrwGq.js";import"./filter-BjJC9dtU.js";import"./ssrBoot-DoU4Hx8y.js";import"./VSlideGroup-C6UwHDjq.js";const _e={key:0},Je={__name:"rooms",setup(be){const{mobile:U}=le(),{t:r}=oe(),H=re(),P=u(""),i=u({rows:[],page:1,pageSize:10,total:0}),x=u(!1),_=({page:m,itemsPerPage:o,sortBy:f})=>{const l={gameName:P.value,page:m,pageSize:o};x.value=!0,L.list.get(l).then(d=>{i.value=d.data,i.value.rows=d.data.rows||[]}).finally(()=>{x.value=!1})},J=[{title:"ID",value:"id"},{title:r("platform.rooms.headers.gameName"),value:"gameName"},{title:r("platform.rooms.headers.status"),value:"status"},{title:r("platform.rooms.headers.maxPlayer"),value:"maxPlayer",minWidth:120},{title:r("platform.rooms.headers.worldNum"),value:"worldNum"},{title:r("platform.rooms.headers.modNum"),value:"modNum"},{title:r("platform.rooms.headers.serverPort"),value:"serverPort"},{title:r("platform.rooms.headers.actions"),value:"actions"}],C=u(!1),c=u({id:void 0,gameName:"",gameMode:"",ports:[],screens:[]}),A=u(!1),X=async m=>{C.value=!0,A.value=!0;const o={roomID:H.room.id},f=[],l=await G.screen.running.get(o);for(let V of l.data)V!==""&&f.push(V);const d=[];d.push(m.masterPort);for(let V of m.worlds)d.push(V.serverPort),d.push(V.masterServerPort),d.push(V.authenticationPort);c.value={id:m.id,gameName:m.gameName,gameMode:m.gameMode,ports:d,screens:f},A.value=!1},T=u(!1),Y=m=>{T.value=!0;const o={screenName:m};G.screen.kill.post(o).then(f=>{I(f.message)}).finally(()=>{T.value=!1})},w=(m,o)=>{switch(m){case"details":X(o);break;case"activate":Z(o);break;case"deactivate":ee(o);break;case"delete":j.value=o.id,b.value=!0;break}},$=u(!1),Z=m=>{$.value=!0;const o={roomID:m.id};L.activate.post(o).then(f=>{I(f.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{$.value=!1})},F=u(!1),ee=m=>{F.value=!0;const o={roomID:m.id};L.deactivate.post(o).then(f=>{I(f.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{F.value=!1})},b=u(!1),j=u(0),D=u(!1),ae=()=>{D.value=!0;const m={roomID:j.value};L.base.delete(m).then(o=>{b.value=!1,I(o.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{D.value=!1})};return(m,o)=>{const f=te;return g(),M(K,null,[t(Q,null,{default:e(()=>[t(O,null,{default:e(()=>[t(y,null,{default:e(()=>[t(v,{cols:"12"},{default:e(()=>[t(de,{modelValue:a(P),"onUpdate:modelValue":o[0]||(o[0]=l=>q(P)?P.value=l:null),label:a(r)("platform.user.search.label"),placeholder:a(r)("platform.user.search.placeholder"),clearable:"",onKeyup:o[1]||(o[1]=se(l=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}),["enter"])),"onClick:clear":o[2]||(o[2]=l=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}))},null,8,["modelValue","label","placeholder"])]),_:1}),t(v,{cols:"12"},{default:e(()=>[t(ne,{rounded:"",border:""},{default:e(()=>[t(ue,{"items-per-page":a(i).pageSize,"onUpdate:itemsPerPage":o[4]||(o[4]=l=>a(i).pageSize=l),items:a(i).rows,"items-length":a(i).total,page:a(i).page,loading:a(x),headers:J,"onUpdate:options":_},{top:e(()=>[t(ce,{flat:""},{default:e(()=>[t(ge,null,{default:e(()=>[t(h,{icon:"ri-instance-line",start:""}),a(U)?z("",!0):(g(),M("span",_e,s(a(r)("platform.rooms.title")),1))]),_:1}),t(R,{"prepend-icon":"ri-refresh-line",loading:a(x),color:"default",onClick:o[3]||(o[3]=l=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}))},{default:e(()=>[n(s(a(r)("platform.user.table.refresh")),1)]),_:1},8,["loading"])]),_:1})]),"item.id":e(({value:l})=>[t(p,{label:"",color:"primary"},{default:e(()=>[n(s(l),1)]),_:2},1024)]),"item.status":e(({value:l})=>[l?(g(),k(p,{key:0,color:"success",label:""},{default:e(()=>[n(s(a(r)("platform.rooms.activate")),1)]),_:1})):(g(),k(p,{key:1,color:"warning",label:""},{default:e(()=>[n(s(a(r)("platform.rooms.deactivate")),1)]),_:1}))]),"item.maxPlayer":e(({value:l})=>[t(p,{label:""},{default:e(()=>[n(s(l),1)]),_:2},1024)]),"item.worldNum":e(({item:l})=>[t(p,{label:"",color:"info"},{default:e(()=>[n(s(l.worlds.length),1)]),_:2},1024)]),"item.modNum":e(({item:l})=>[t(p,{label:"",color:"info"},{default:e(()=>[n(s(l.modInOne?a(E)(l.modData).length:a(E)(l.worlds[0].modData).length),1)]),_:2},1024)]),"item.serverPort":e(({item:l})=>[t(p,{label:"",color:"info"},{default:e(()=>[n(s(l.worlds.map(d=>d.serverPort).join(",")),1)]),_:2},1024)]),"item.actions":e(({item:l})=>[t(R,{color:"info","append-icon":"ri-arrow-drop-down-line",variant:"text",loading:a($)||a(F)||a(D)},{default:e(()=>[n(s(a(r)("platform.user.table.actions"))+" ",1),t(pe,{activator:"parent"},{default:e(()=>[t(fe,null,{default:e(()=>[t(S,{class:"text-info",onClick:d=>w("details",l)},{prepend:e(()=>[t(h,{icon:"ri-information-2-line",size:"22"})]),default:e(()=>[t(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.details")),1)]),_:1})]),_:1},8,["onClick"]),t(S,{class:"text-success",disabled:l.status,onClick:d=>w("activate",l)},{prepend:e(()=>[t(h,{icon:"ri-play-large-line",size:"22"})]),default:e(()=>[t(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.activate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),t(S,{class:"text-warning",disabled:!l.status,onClick:d=>w("deactivate",l)},{prepend:e(()=>[t(h,{icon:"ri-stop-large-line",size:"22"})]),default:e(()=>[t(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.deactivate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),t(S,{class:"text-error",onClick:d=>w("delete",l)},{prepend:e(()=>[t(h,{icon:"ri-delete-bin-line",size:"22"})]),default:e(()=>[t(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.delete")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["loading"])]),_:1},8,["items-per-page","items","items-length","page","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(ve,{modelValue:a(C),"onUpdate:modelValue":o[5]||(o[5]=l=>q(C)?C.value=l:null),width:a(U)?"90%":"60%"},{default:e(()=>[t(Q,null,{default:e(()=>[t(me,null,{default:e(()=>[n(s(a(r)("platform.rooms.dialog.title")),1)]),_:1}),t(O,{class:"ma-4"},{default:e(()=>[t(y,{class:"d-flex align-center"},{default:e(()=>[t(v,null,{default:e(()=>[t(p,{label:"",color:"info",class:"mr-4"},{default:e(()=>[...o[8]||(o[8]=[n(" ID ",-1)])]),_:1}),B("span",null,s(a(c).id),1)]),_:1})]),_:1}),t(y,{class:"d-flex align-center"},{default:e(()=>[t(v,null,{default:e(()=>[t(p,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.gameName")),1)]),_:1}),B("span",null,s(a(c).gameName),1)]),_:1})]),_:1}),t(y,{class:"d-flex align-center"},{default:e(()=>[t(v,null,{default:e(()=>[t(p,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.gameMode")),1)]),_:1}),B("span",null,s(a(r)(`game.base.step1.gameMode.modes.${a(c).gameMode}`)),1)]),_:1})]),_:1}),t(y,{class:"d-flex align-center"},{default:e(()=>[t(v,null,{default:e(()=>[t(p,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.ports")),1)]),_:1}),B("span",null,s(a(c).ports.join(",")),1)]),_:1})]),_:1}),a(c).screens.length!==0?(g(),k(W,{key:0,color:"primary",density:"compact",class:"mt-8 mb-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.screenTip")),1)]),_:1})):z("",!0),a(c).screens.length===0?(g(),k(W,{key:1,color:"warning",density:"compact",class:"mt-8 mb-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.noScreenTip")),1)]),_:1})):z("",!0),a(c).screens.length!==0?(g(!0),M(K,{key:2},ie(a(c).screens,l=>(g(),k(y,null,{default:e(()=>[t(v,{cols:"6"},{default:e(()=>[t(p,{label:""},{default:e(()=>[n(s(l),1)]),_:2},1024)]),_:2},1024),t(v,{cols:"6"},{default:e(()=>[t(R,{density:"compact",loading:a(T),onClick:d=>Y(l)},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.kill")),1)]),_:1},8,["loading","onClick"])]),_:2},1024)]),_:2},1024))),256)):z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),t(f,{modelValue:a(b),"onUpdate:modelValue":o[6]||(o[6]=l=>q(b)?b.value=l:null),type:"warning",title:a(r)("global.confirm.title"),content:a(r)("global.confirm.content"),"confirm-text":a(r)("global.confirm.confirm"),"cancel-text":a(r)("global.confirm.cancel"),"confirm-loading":a(D),onConfirm:ae,onCancel:o[7]||(o[7]=l=>b.value=!1)},null,8,["modelValue","title","content","confirm-text","cancel-text","confirm-loading"])],64)}}};export{Je as default};
