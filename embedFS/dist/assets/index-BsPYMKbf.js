import{_ as ge}from"./Result-DBHzZK3h.js";import{ad as N,ae as M,h as T,j as k,af as Q,a,k as y,ag as W,F as O,A as S,ao as Y,cv as he,al as q,am as Ve,cc as E,P as Z,H as be,p as J,aa as we,z as Ie,G as B,aW as ye,aF as ke,cw as D,aO as xe,at as Le,U as Ce,$ as I,an as ee,as as _e,Y as Ae,e as Pe,b as Te,g as Se,d as Ge,a1 as te,f as Be,a4 as Oe,r as Re,c as z,l,o as _,w as s,a8 as je,E as ne,t as G,s as H,y as j,q as F,B as K}from"./index-7Da7c_Ya.js";import{r as De}from"./room-BxaTXAUM.js";import{V as ae}from"./VCol-CUWeDHjo.js";import{V as ze,a as Fe}from"./VToolbar-9n51jOme.js";import{V as $e}from"./VDialog-DyznnS6a.js";import{V as qe,a as Ee}from"./VCard-CfP9hJBJ.js";import{V as Ue}from"./VAlert-50WZP5U7.js";import{V as Ne,a as le}from"./VRadioGroup-BiDVHigz.js";import{V as Me}from"./VChip-CKZVCmsW.js";import{V as He,a as $}from"./VExpansionPanels-DtcONFI5.js";import{V as ie}from"./VRow-BiQYX2vy.js";import{b as oe,c as Ke,a as We,d as Ye,V as re,e as Je}from"./VList-Ti-qYX1c.js";import{V as ue}from"./VListItemAction-CFblxKUM.js";import{V as Qe}from"./VCheckboxBtn-gkCF4WMx.js";import{u as Xe,m as Ze}from"./filter-DeVrQReA.js";import"./VContainer-C3TPu6F4.js";/* empty css              */import"./axios-Cf6GdeVA.js";import"./index-DgH_XViZ.js";import"./dialog-transition-r1KftaBw.js";import"./VSelectionControl-DRs0COUd.js";import"./VInput-XKGaG4uV.js";import"./ssrBoot-CW_5PvrP.js";function et(e){let{depth:g,isLast:t,isLastGroup:V,leafLinks:v,separateRoots:d,parentIndentLines:r,variant:f}=e;if(!r||!g)return{leaf:void 0,node:void 0,children:r};if(f==="simple")return{leaf:[...r,"line"],node:[...r,"line"],children:[...r,"line"]};const n=t&&(!V||d||g>1);return{leaf:[...r,n?"last-leaf":"leaf",...v?["leaf-link"]:[]],node:[...r,n?"last-leaf":"leaf"],children:[...r,n?"none":"line"]}}const tt=M({...Y(Ke({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand"}),["subgroup"])},"VTreeviewGroup"),se=N()({name:"VTreeviewGroup",props:tt(),setup(e,g){let{slots:t}=g;const V=T(),v=k(()=>V.value?.isOpen?e.collapseIcon:e.expandIcon),d=k(()=>({VTreeviewItem:{prependIcon:void 0,appendIcon:void 0,toggleIcon:v.value}}));return Q(()=>{const r=oe.filterProps(e);return a(oe,S(r,{ref:V,class:["v-treeview-group",e.class],subgroup:!0}),{...t,activator:t.activator?f=>y(O,null,[a(W,{defaults:d.value},{default:()=>[t.activator?.(f)]})]):void 0})}),{}}}),ce=Symbol.for("vuetify:v-treeview"),ve=M({loading:Boolean,hideActions:Boolean,hasCustomPrepend:Boolean,indentLines:Array,toggleIcon:q,...he({slim:!0})},"VTreeviewItem"),de=N()({name:"VTreeviewItem",props:ve(),emits:{toggleExpand:e=>!0},setup(e,g){let{slots:t,emit:V}=g;const v=Ve(ce,{visibleIds:T()}).visibleIds,d=T(),r=k(()=>d.value?.root.activatable.value&&d.value?.isGroupActivator),f=k(()=>d.value?.link.isClickable.value||e.value!=null&&!!d.value?.list),n=k(()=>!e.disabled&&e.link!==!1&&(e.link||f.value||r.value)),h=k(()=>v.value&&!v.value.has(E(d.value?.id)));function A(u){n.value&&r.value&&d.value?.activate(!d.value?.isActivated,u)}function b(u){u.preventDefault(),u.stopPropagation(),V("toggleExpand",u)}return Q(()=>{const u=Z.filterProps(e),x=t.prepend||e.toggleIcon||e.indentLines||e.prependIcon||e.prependAvatar;return a(Z,S({ref:d},u,{active:d.value?.isActivated||void 0,class:["v-treeview-item",{"v-treeview-item--activatable-group-activator":r.value,"v-treeview-item--filtered":h.value},e.class],ripple:!1,onClick:A}),{...t,prepend:x?L=>y(O,null,[e.indentLines&&e.indentLines.length>0?y("div",{key:"indent-lines",class:"v-treeview-indent-lines",style:{"--v-indent-parts":e.indentLines.length}},[e.indentLines.map(P=>y("div",{class:be(`v-treeview-indent-line v-treeview-indent-line--${P}`)},null))]):"",!e.hideActions&&a(ue,{start:!0},{default:()=>[e.toggleIcon?y(O,null,[t.toggle?a(W,{key:"prepend-defaults",defaults:{VBtn:{density:"compact",icon:e.toggleIcon,variant:"text",loading:e.loading},VProgressCircular:{indeterminate:"disable-shrink",size:20,width:2}}},{default:()=>[t.toggle({...L,loading:e.loading,props:{onClick:b}})]}):a(J,{key:"prepend-toggle",density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text",onClick:b},{loader:()=>a(we,{indeterminate:"disable-shrink",size:"20",width:"2"},null)})]):y("div",{class:"v-treeview-item__level"},null)]}),e.hasCustomPrepend?a(W,{key:"prepend-defaults",defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{start:!0}}},{default:()=>[t.prepend?.(L)]}):y(O,null,[t.prepend?.(L),e.prependAvatar&&a(Ie,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&a(B,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]):void 0})}),ye({},d)}}),fe=M({fluid:Boolean,disabled:Boolean,loadChildren:Function,loadingIcon:{type:String,default:"$loading"},items:Array,openOnClick:{type:Boolean,default:void 0},indeterminateIcon:{type:q,default:"$checkboxIndeterminate"},falseIcon:q,trueIcon:q,returnObject:Boolean,activatable:Boolean,selectable:Boolean,selectedColor:String,selectStrategy:[String,Function,Object],index:Number,isLastGroup:Boolean,separateRoots:Boolean,parentIndentLines:Array,indentLinesVariant:String,path:{type:Array,default:()=>[]},...Le(ve(),["hideActions"]),...xe()},"VTreeviewChildren"),U=N()({name:"VTreeviewChildren",props:fe(),setup(e,g){let{slots:t}=g;const V=ke(new Set),v=T([]),d=k(()=>!e.disabled&&(e.openOnClick!=null?e.openOnClick:e.selectable&&!e.activatable));async function r(n){try{if(!e.items?.length||!e.loadChildren)return;n?.children?.length===0&&(V.add(n.value),await e.loadChildren(n.raw))}finally{V.delete(n.value)}}function f(n,h){e.selectable&&n(h)}return()=>t.default?.()??e.items?.map((n,h,A)=>{const{children:b,props:u}=n,x=V.has(n.value),L=!!A.at(h+1)?.children,P=e.path?.length??0,R=A.length-1===h,w={index:h,depth:P,isFirst:h===0,isLast:R,path:[...e.path,h],hideAction:e.hideActions},p=et({depth:P,isLast:R,isLastGroup:e.isLastGroup,leafLinks:!e.hideActions&&!e.fluid,separateRoots:e.separateRoots,parentIndentLines:e.parentIndentLines,variant:e.indentLinesVariant}),m={toggle:t.toggle?o=>t.toggle?.({...o,...w,item:n.raw,internalItem:n,loading:x}):void 0,prepend:o=>y(O,null,[e.selectable&&(!b||b&&!["leaf","single-leaf"].includes(e.selectStrategy))&&a(ue,{start:!0},{default:()=>[a(Qe,{key:n.value,modelValue:o.isSelected,disabled:e.disabled,loading:x,color:e.selectedColor,density:e.density,indeterminate:o.isIndeterminate,indeterminateIcon:e.indeterminateIcon,falseIcon:e.falseIcon,trueIcon:e.trueIcon,"onUpdate:modelValue":C=>f(o.select,C),onClick:C=>C.stopPropagation(),onKeydown:C=>{["Enter","Space"].includes(C.key)&&(C.stopPropagation(),f(o.select,o.isSelected))}},null)]}),t.prepend?.({...o,...w,item:n.raw,internalItem:n})]),append:t.append?o=>t.append?.({...o,...w,item:n.raw,internalItem:n}):void 0,title:t.title?o=>t.title?.({...o,item:n.raw,internalItem:n}):void 0,subtitle:t.subtitle?o=>t.subtitle?.({...o,item:n.raw,internalItem:n}):void 0},c=se.filterProps(u),i=U.filterProps({...e,...w});return b?a(se,S(c,{value:e.returnObject?n.raw:c?.value,rawId:c?.value}),{activator:o=>{let{props:C}=o;const X={...u,...C,value:u?.value,indentLines:p.node,onToggleExpand:[()=>r(n),C.onClick],onClick:d.value?[()=>r(n),C.onClick]:()=>f(v.value[h]?.select,!v.value[h]?.isSelected)};return D(t.header,{props:X,item:n.raw,internalItem:n,loading:x},()=>a(de,S({ref:me=>v.value[h]=me},X,{hasCustomPrepend:!!t.prepend,hideActions:e.hideActions,value:e.returnObject?n.raw:u.value,loading:x}),m))},default:()=>a(U,S(i,{items:b,indentLinesVariant:e.indentLinesVariant,parentIndentLines:p.children,isLastGroup:L,returnObject:e.returnObject}),t)}):D(t.item,{props:u,item:n.raw,internalItem:n},()=>n.type==="divider"?D(t.divider,{props:n.raw},()=>a(Ce,n.props,null)):n.type==="subheader"?D(t.subheader,{props:n.raw},()=>a(We,n.props,null)):a(de,S(u,{hasCustomPrepend:!!t.prepend,hideActions:e.hideActions,indentLines:p.leaf,value:e.returnObject?E(n.raw):u.value}),m))})}});function pe(e){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];for(const t of e)g.push(t),t.children&&pe(t.children,g);return g}const nt=M({openAll:Boolean,indentLines:[Boolean,String],search:String,...Ze({filterKeys:["title"]}),...Y(fe(),["index","path","indentLinesVariant","parentIndentLines","isLastGroup"]),...Y(Je({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand",slim:!0}),["nav","openStrategy"]),modelValue:Array},"VTreeview"),at=N()({name:"VTreeview",props:nt(),emits:{"update:opened":e=>!0,"update:activated":e=>!0,"update:selected":e=>!0,"update:modelValue":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,g){let{slots:t,emit:V}=g;const{items:v}=Ye(e),d=I(()=>e.activeColor),r=I(()=>e.baseColor),f=I(()=>e.color),n=ee(e,"activated"),h=ee(e,"selected"),A=k({get:()=>e.modelValue??h.value,set(m){h.value=m,V("update:modelValue",m)}}),b=T(),u=k(()=>e.openAll?p(v.value):e.opened),x=k(()=>pe(v.value)),L=I(()=>e.search),{filteredItems:P}=Xe(e,x,L),R=k(()=>{if(!L.value)return null;const m=b.value?.getPath;return m?new Set(P.value.flatMap(c=>{const i=e.returnObject?c.raw:c.props.value;return[...m(i),...w(i)].map(E)})):null});function w(m){const c=[],i=(b.value?.children.get(m)??[]).slice();for(;i.length;){const o=i.shift();o&&(c.push(o),i.push(...(b.value?.children.get(o)??[]).slice()))}return c}function p(m){let c=[];for(const i of m)i.children&&(c.push(e.returnObject?E(i.raw):i.value),i.children&&(c=c.concat(p(i.children))));return c}return Ae(ce,{visibleIds:R}),_e({VTreeviewGroup:{activeColor:d,baseColor:r,color:f,collapseIcon:I(()=>e.collapseIcon),expandIcon:I(()=>e.expandIcon)},VTreeviewItem:{activeClass:I(()=>e.activeClass),activeColor:d,baseColor:r,color:f,density:I(()=>e.density),disabled:I(()=>e.disabled),lines:I(()=>e.lines),variant:I(()=>e.variant)}}),Q(()=>{const m=re.filterProps(e),c=U.filterProps(e),i=typeof e.indentLines=="boolean"?"default":e.indentLines;return a(re,S({ref:b},m,{class:["v-treeview",{"v-treeview--fluid":e.fluid},e.class],openStrategy:"multiple",style:e.style,opened:u.value,activated:n.value,"onUpdate:activated":o=>n.value=o,selected:A.value,"onUpdate:selected":o=>A.value=o}),{default:()=>[a(U,S(c,{density:e.density,returnObject:e.returnObject,items:v.value,parentIndentLines:e.indentLines?[]:void 0,indentLinesVariant:i}),t)]})}),{}}}),lt={key:0},it={class:"text-error"},ot={class:"text-error"},rt={class:"text-error"},Gt={__name:"index",setup(e){const{mobile:g}=Pe(),{t}=Te(),V=Se(),v=Ge(),d=T(window.innerHeight),r=T(!1),f=T(!1),n=T(""),h=w=>/\.zip$/i.test(w.name),A=()=>v.userInfo.role==="admin"?!0:v.userInfo.roomCreation,b=w=>{if(n.value!=="old"&&n.value!=="new"){K(t("upload.dialog.uploadTypeTip"),"error");return}if(!h(w)){K(t("upload.dialog.zipTip"),"error"),f.value=!1;return}r.value=!0;const p=new FormData;p.append("file",w),n.value==="old"&&p.append("roomID",V.room.id),De.upload.post(p).then(m=>{K(m.message)}).finally(()=>{f.value=!1,r.value=!1})},u=te([1,14]),x=te({ini:"ri-file-settings-line",lua:"ri-file-code-line",txt:"ri-file-text-line"}),L=[{id:1,title:"xxxxx.zip",children:[{id:2,title:"adminlist.txt",file:"txt"},{id:3,title:"blocklist.txt",file:"txt"},{id:4,title:t("upload.tree.caves"),children:[{id:5,title:"backup"},{id:6,title:"leveldataoverride.lua",file:"lua",required:!0},{id:7,title:"modoverrides.lua",file:"lua"},{id:8,title:"save",required:!0},{id:9,title:"server_chat_log.txt",file:"txt"},{id:10,title:"server.ini",file:"ini",required:!0},{id:11,title:"server_log.txt",file:"txt"}]},{id:12,title:"cluster.ini",file:"ini",required:!0},{id:13,title:"cluster_token.txt",file:"txt"},{id:14,title:"Master",children:[{id:15,title:"backup"},{id:16,title:"leveldataoverride.lua",file:"lua",required:!0},{id:17,title:"modoverrides.lua",file:"lua"},{id:18,title:"save",required:!0},{id:19,title:"server_chat_log.txt",file:"txt"},{id:20,title:"server.ini",file:"ini",required:!0},{id:21,title:"server_log.txt",file:"txt"}],required:!0},{id:22,title:"whitelist.txt",file:"txt"}]}],P=Oe(()=>{d.value=window.innerHeight},200),R=()=>Math.max(2,Math.floor(d.value-150));return Be(()=>{P(),window.addEventListener("resize",P)}),(w,p)=>{const m=Re("v-file-upload"),c=ge;return l(V).gameVersion.local!==0?(_(),z(O,{key:0},[a(ie,null,{default:s(()=>[a(ae,null,{default:s(()=>[a(je,{border:"",rounded:""},{default:s(()=>[a(ze,{flat:""},{default:s(()=>[a(Fe,null,{default:s(()=>[a(B,{icon:"ri-contacts-book-upload-line",start:""}),l(g)?ne("",!0):(_(),z("span",lt,G(l(t)("upload.title")),1))]),_:1}),a($e,{modelValue:l(f),"onUpdate:modelValue":p[1]||(p[1]=i=>H(f)?f.value=i:null),persistent:l(r),class:"flex-wrap",width:l(g)?"90%":"40%"},{activator:s(({props:i})=>[a(J,S({class:"mr-2",color:"primary","prepend-icon":"ri-upload-line"},i),{default:s(()=>[F(G(l(t)("upload.button")),1)]),_:1},16)]),default:s(({isActive:i})=>[a(qe,{title:l(t)("upload.dialog.title"),"min-height":"500"},{default:s(()=>[a(Ee,null,{default:s(()=>[l(r)?(_(),j(c,{key:1,height:400,type:"info",title:l(t)("upload.dialog.uploadingTitle"),"sub-title":l(t)("upload.dialog.uploadingSubTitle")},null,8,["title","sub-title"])):(_(),z(O,{key:0},[a(Ue,{color:"warning",density:"compact",class:"mt-2 mb-2"},{default:s(()=>[F(G(l(t)("upload.dialog.tip")),1)]),_:1}),a(Ne,{modelValue:l(n),"onUpdate:modelValue":p[0]||(p[0]=o=>H(n)?n.value=o:null),inline:"",color:"primary",class:"my-4"},{prepend:s(()=>[a(Me,null,{default:s(()=>[F(G(l(t)("upload.dialog.uploadType")),1)]),_:1})]),default:s(()=>[a(le,{label:l(t)("upload.dialog.uploadNew"),disabled:!A(),value:"new"},null,8,["label","disabled"]),a(le,{label:l(t)("upload.dialog.uploadOld"),disabled:l(V).room.id===0,value:"old"},null,8,["label","disabled"])]),_:1},8,["modelValue"]),a(m,{density:"default",icon:"ri-upload-cloud-2-line","onUpdate:modelValue":b})],64))]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue","persistent","width"])]),_:1}),a(He,null,{default:s(()=>[a($,{text:l(t)("upload.expansions.panel1.text")},{title:s(()=>[a(B,{icon:"ri-error-warning-line",start:"",color:"error"}),y("span",it,G(l(t)("upload.expansions.panel1.title")),1)]),_:1},8,["text"]),a($,{text:l(t)("upload.expansions.panel2.text")},{title:s(()=>[a(B,{icon:"ri-error-warning-line",start:"",color:"error"}),y("span",ot,G(l(t)("upload.expansions.panel2.title")),1)]),_:1},8,["text"]),a($,{text:l(t)("upload.expansions.panel3.text")},{title:s(()=>[a(B,{icon:"ri-error-warning-line",start:"",color:"error"}),y("span",rt,G(l(t)("upload.expansions.panel3.title")),1)]),_:1},8,["text"]),a($,{title:l(t)("upload.expansions.panel4.title"),text:l(t)("upload.expansions.panel4.text")},null,8,["title","text"])]),_:1})]),_:1})]),_:1})]),_:1}),a(ie,null,{default:s(()=>[a(ae,null,{default:s(()=>[a(at,{opened:l(u),"onUpdate:opened":p[2]||(p[2]=i=>H(u)?u.value=i:null),items:L,"item-value":"id",variant:"flat",density:"compact",activatable:"","open-on-click":"","no-filter":""},{prepend:s(({item:i,isOpen:o})=>[i.file?(_(),j(B,{key:1,icon:l(x)[i.file]},null,8,["icon"])):(_(),j(B,{key:0,icon:o?"ri-folder-open-fill":"ri-folder-fill"},null,8,["icon"]))]),append:s(({item:i})=>[i.required?(_(),j(B,{key:0,icon:"ri-pushpin-fill",color:"error"})):ne("",!0)]),_:1},8,["opened"])]),_:1})]),_:1})],64)):(_(),z(O,{key:1},[l(v).userInfo.role==="admin"?(_(),j(c,{key:0,title:l(t)("global.noGame.title"),"sub-title":l(t)("global.noGame.subTitle"),height:R(),type:"error"},{default:s(()=>[a(J,{to:"/install",class:"mt-4"},{default:s(()=>[F(G(l(t)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(_(),j(c,{key:1,title:l(t)("global.noGameNoAdmin.title"),"sub-title":l(t)("global.noGameNoAdmin.subTitle"),height:R(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{Gt as default};
