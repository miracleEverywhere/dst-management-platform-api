import{_ as ee}from"./Result-Cn2_UdEw.js";import{e as te,b as ae,u as le,d as se,g as oe,h as _,L as ie,f as re,a3 as ne,a4 as de,c as b,l as e,o as i,k as g,a as t,y as h,E as v,ab as ce,w as a,q as m,t as r,p as k,F as B,v as ue,x as me,W as fe,G as R,P as E,Q as W,A as ge,a6 as U,a7 as he,R as pe,B as K}from"./index-y7gjWuPm.js";import{r as D}from"./room-6pGSGymX.js";import{C as _e}from"./vue3-count-to.esm-CwD_mhMP.js";import{e as ve}from"./eventBus-B8tShFcG.js";import{V as be}from"./VTextField-uMFdyion.js";import{V as y}from"./VRow-DSxK_lZ_.js";import{V as f}from"./VCol-umKj9uol.js";import{V as O,c as ye,a as we}from"./VCard-3t1lA3T-.js";import{V as x}from"./VChip-wyhN0sI-.js";import{V as Ve}from"./VMenu-DsEiLSfo.js";import{V as ke}from"./VList-Dq7nw64W.js";import{V as xe}from"./VSparkline-CKrrZq3D.js";import{V as Ce}from"./VPagination-gpFCmWP7.js";import"./VContainer-BnSh_MTZ.js";/* empty css              */import"./axios-BmRfRVbX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-MCHUliHX.js";import"./VInput-MzIIapS-.js";import"./VSlideGroup-C6UwHDjq.js";import"./dialog-transition-BlTEFOz9.js";import"./ssrBoot-DoU4Hx8y.js";const Ne={class:"fcc"},Se={class:"fcb"},ze={class:"fcc"},Me=["onClick"],Ie={class:"text-caption text-grey"},Re={class:"text-h3 font-weight-black"},Le={key:1},Te={key:1},$e={key:2},ot={__name:"index",setup(Be){const{mobile:d}=te(),{t:l}=ae(),Q=le(),C=se(),N=oe(),w=_(window.innerHeight),G=()=>Math.max(2,Math.floor((w.value-204)/300)*2),c=_({gameName:"",page:1,pageSize:0}),z=_([]),L=_(0),M=_(!1),p=async()=>{M.value=!0;const o=await D.list.get(c.value);z.value=o.data.rows||[],L.value=o.data.total,M.value=!1},H=async()=>{N.room={id:0,gameName:""},j(),await Q.push("/game/base")},j=()=>{ve.emit("toggleMenu",3)},J=o=>{N.room.id=o.id,N.room.gameName=o.gameName},F=o=>{if(o.length===0)return[0,0];const n=[];for(let u of o)n.push(u.playerInfo?.length||0);return n},A=(o,n)=>{switch(o){case"activate":X(n);break;case"deactivate":Y(n);break}},T=_(!1),X=o=>{T.value=!0;const n={roomID:o.id};D.activate.post(n).then(u=>{K(u.message),p()}).finally(()=>{T.value=!1})},$=_(!1),Y=o=>{$.value=!0;const n={roomID:o.id};D.deactivate.post(n).then(u=>{K(u.message),p()}).finally(()=>{$.value=!1})},S=_(),I=_(0),P=()=>Math.max(2,Math.floor(w.value-120));ie(w,()=>{p()},{immediate:!1});const q=ne(()=>{w.value=window.innerHeight,c.value.pageSize=G(),S.value&&(I.value=S.value.$el.offsetWidth)},200);return re(async()=>{c.value.pageSize=G(),await p(),S.value&&(I.value=S.value.$el.offsetWidth),window.addEventListener("resize",q)}),de(()=>{window.removeEventListener("resize",q)}),(o,n)=>{const u=ee;return e(N).gameVersion.local!==0?(i(),b(B,{key:0},[g("div",Ne,[t(be,{modelValue:e(c).gameName,"onUpdate:modelValue":n[0]||(n[0]=s=>e(c).gameName=s),label:e(l)("rooms.header.input.label"),placeholder:e(l)("rooms.header.input.placeholder"),"append-inner-icon":"ri-search-line",class:"mr-4",loading:e(M),"onClick:appendInner":p,onKeyup:ce(p,["enter"])},null,8,["modelValue","label","placeholder","loading"]),e(d)?v("",!0):(i(),h(k,{key:0,disabled:!e(C).userInfo.roomCreation&&e(C).userInfo.role!=="admin","prepend-icon":"ri-add-line",variant:"elevated",size:"large",class:"mr-4",onClick:H},{default:a(()=>[m(r(e(l)("rooms.header.button.create")),1)]),_:1},8,["disabled"])),e(d)?v("",!0):(i(),h(k,{key:1,"prepend-icon":"ri-refresh-line",color:"default",variant:"elevated",size:"large",onClick:p},{default:a(()=>[m(r(e(l)("rooms.header.button.refresh")),1)]),_:1})),e(d)?(i(),h(k,{key:2,disabled:!e(C).userInfo.roomCreation&&e(C).userInfo.role!=="admin",icon:"ri-add-line",class:"mr-4",onClick:H},null,8,["disabled"])):v("",!0),e(d)?(i(),h(k,{key:3,icon:"ri-refresh-line",color:"default",onClick:p})):v("",!0)]),t(y,{class:"mt-8"},{default:a(()=>[t(y,{class:"mx-1"},{default:a(()=>[(i(!0),b(B,null,ue(e(z),(s,Z)=>(i(),h(f,{cols:e(d)?12:6},{default:a(()=>[t(O,{ref_for:!0,ref:V=>{Z===0&&(S.value=V)},hover:!0,variant:"flat",height:e(d)?"600px":"300px"},{default:a(()=>[t(ye,null,{default:a(()=>[g("div",Se,[g("div",ze,[t(x,{color:"primary"},{default:a(()=>[m(r(e(fe)(s.gameName,e(d)?8:15)),1)]),_:2},1024),t(x,{color:s.status?"success":"warning",class:"ml-4"},{default:a(()=>[m(r(s.status?e(l)("rooms.card.success.header.title.activated"):e(l)("rooms.card.success.header.title.deactivated")),1)]),_:2},1032,["color"]),e(N).room.id===s.id?(i(),h(R,{key:0,icon:"ri-crosshair-2-line",color:"info",class:"ml-4"})):v("",!0)]),t(Ve,null,{activator:a(({props:V})=>[t(k,ge({ref_for:!0},V,{disabled:e(M),loading:e(T)||e($),color:"primary",icon:"ri-more-2-line"}),null,16,["disabled","loading"])]),default:a(()=>[t(ke,null,{default:a(()=>[t(E,{class:"text-success",disabled:s.status,onClick:V=>A("activate",s)},{prepend:a(()=>[t(R,{icon:"ri-play-large-line",size:"22"})]),default:a(()=>[t(W,null,{default:a(()=>[m(r(e(l)("rooms.card.success.header.menu.activate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),t(E,{class:"text-warning",disabled:!s.status,onClick:V=>A("deactivate",s)},{prepend:a(()=>[t(R,{icon:"ri-stop-large-line",color:"warning",size:"22"})]),default:a(()=>[t(W,null,{default:a(()=>[m(r(e(l)("rooms.card.success.header.menu.deactivate")),1)]),_:1})]),_:1},8,["disabled","onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024),me((i(),h(we,null,{default:a(()=>[s.gameName!==""?(i(),b("div",{key:0,class:"mt-4",onClick:V=>J(s)},[t(y,null,{default:a(()=>[t(f,{cols:e(d)?12:6},{default:a(()=>[t(y,null,{default:a(()=>[t(f,{cols:"6"},{default:a(()=>[g("span",null,r(e(l)("rooms.card.success.text.left.gameMode")),1)]),_:1}),t(f,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[m(r(e(l)(`game.base.step1.gameMode.modes.${s.gameMode}`)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(y,null,{default:a(()=>[t(f,{cols:"6"},{default:a(()=>[g("span",null,r(e(l)("rooms.card.success.text.left.worldNum")),1)]),_:1}),t(f,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[m(r(s.worlds.length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(y,null,{default:a(()=>[t(f,{cols:"6"},{default:a(()=>[g("span",null,r(e(l)("rooms.card.success.text.left.modNum")),1)]),_:1}),t(f,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[m(r(s.modInOne?e(U)(s.modData).length:e(U)(s.worlds[0].modData).length),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(y,null,{default:a(()=>[t(f,{cols:"6"},{default:a(()=>[g("span",null,r(e(l)("rooms.card.success.text.left.playerNum")),1)]),_:1}),t(f,{cols:"6"},{default:a(()=>[t(x,{color:"info",label:""},{default:a(()=>[m(r(s.maxPlayer),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"]),t(f,{cols:e(d)?12:6},{default:a(()=>[t(O,{height:240,variant:"flat"},{prepend:a(()=>[t(R,{color:"primary",class:"me-8",icon:"ri-line-chart-line",size:"48"})]),title:a(()=>[g("div",Ie,r(e(l)("rooms.card.success.text.right.chartTitle")),1),g("span",Re,[t(e(_e),{duration:4e3,"end-val":Math.max(...F(s.players)),"start-val":0},null,8,["end-val"])]),g("strong",null,r(e(l)("rooms.card.success.text.right.unit")),1)]),default:a(()=>[t(he,{color:"transparent"},{default:a(()=>[t(xe,{width:e(d)?e(I):e(I)/2,gradient:["#1feaea"],"line-width":3,"model-value":F(s.players),smooth:!0,padding:"8","stroke-linecap":"round","auto-draw":""},null,8,["width","model-value"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["cols"])]),_:2},1024)],8,Me)):(i(),b("div",Le,[t(u,{type:"warning",height:e(d)?600:300,title:e(l)("rooms.card.warning.title"),"sub-title":e(l)("rooms.card.warning.subTitle")},null,8,["height","title","sub-title"])]))]),_:2},1024)),[[pe]])]),_:2},1032,["height"])]),_:2},1032,["cols"]))),256))]),_:1})]),_:1}),e(L)>e(c).pageSize?(i(),h(Ce,{key:0,modelValue:e(c).page,"onUpdate:modelValue":[n[1]||(n[1]=s=>e(c).page=s),p],length:Math.max(1,Math.ceil(e(L)/e(c).pageSize)),class:"mt-8"},null,8,["modelValue","length"])):v("",!0),e(z).length===0&&e(c).gameName!==""?(i(),b("div",Te,[t(u,{type:"warning",height:e(w),title:e(l)("rooms.result.noResult.title"),"sub-title":e(l)("rooms.result.noResult.subTitle")},null,8,["height","title","sub-title"])])):v("",!0),e(z).length===0&&e(c).gameName===""?(i(),b("div",$e,[t(u,{type:"warning",height:e(w),title:e(l)("rooms.result.noRoom.title"),"sub-title":e(l)("rooms.result.noRoom.subTitle")},null,8,["height","title","sub-title"])])):v("",!0)],64)):(i(),b(B,{key:1},[e(C).userInfo.role==="admin"?(i(),h(u,{key:0,title:e(l)("global.noGame.title"),"sub-title":e(l)("global.noGame.subTitle"),height:P(),type:"error"},{default:a(()=>[t(k,{to:"/install",class:"mt-4"},{default:a(()=>[m(r(e(l)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(i(),h(u,{key:1,title:e(l)("global.noGameNoAdmin.title"),"sub-title":e(l)("global.noGameNoAdmin.subTitle"),height:P(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{ot as default};
