import{_ as le}from"./ConfirmBox-C6ULR34i.js";import{e as te,b as oe,g as re,f as u,c as R,o as g,a as l,w as e,l as a,ac as se,s as A,a8 as ne,p as U,q as n,t as s,P as S,Q as N,G as h,a7 as W,y as k,A as z,k as B,F as E,v as ie,C as I}from"./index-CkNbSyGh.js";import{r as L}from"./room-DQiKG7g9.js";import{p as G}from"./platform-CZ1n8ytr.js";import{a as O,V as Q,c as me}from"./VCard-Chgb7NQr.js";import{V as y}from"./VRow-o-C5n2ML.js";import{V as v}from"./VCol-C-U-3BfA.js";import{V as de}from"./VTextField-CIbt9Jw8.js";import{V as ue}from"./VDataTableServer-DwXX0yh6.js";import{V as fe}from"./VMenu-D2l1j7S0.js";import{V as ce}from"./VList-B4ZoK83V.js";import{V as f}from"./VChip-BYgMm5U1.js";import{V as pe,a as ge}from"./VToolbar-CpVJajtM.js";import{V as H}from"./VAlert-RuRU4Tlv.js";import{V as ve}from"./VDialog-YMDmpeZ_.js";import"./VSpacer-Dtma9HxP.js";/* empty css              */import"./axios-D9wugClK.js";import"./index-C_E8fDh9.js";import"./VInput-DAl67pJ-.js";import"./VDataTable-rXtQItL3.js";import"./VPagination-DyeMdUEe.js";import"./VSelect-CCrSk_bo.js";import"./VCheckboxBtn-DTkK2TZk.js";import"./VSelectionControl-CV465D96.js";import"./dialog-transition-CkYDvwCe.js";import"./VTable-DW-OVTmL.js";import"./filter-D10Qczcc.js";import"./ssrBoot-vMFB3qzm.js";const _e={key:0},Qe={__name:"rooms",setup(be){const{mobile:j}=te(),{t:r}=oe(),T=re(),P=u(""),i=u({rows:[],page:1,pageSize:10,total:0}),x=u(!1),_=({page:m,itemsPerPage:o,sortBy:c})=>{const t={gameName:P.value,page:m,pageSize:o};x.value=!0,L.list.get(t).then(d=>{i.value=d.data,i.value.rows=d.data.rows||[]}).finally(()=>{x.value=!1})},J=[{title:"ID",value:"id"},{title:r("platform.rooms.headers.gameName"),value:"gameName",minWidth:150},{title:r("platform.rooms.headers.status"),value:"status"},{title:r("platform.rooms.headers.maxPlayer"),value:"maxPlayer",minWidth:120},{title:r("platform.rooms.headers.worldNum"),value:"worldNum"},{title:r("platform.rooms.headers.modNum"),value:"modNum"},{title:r("platform.rooms.headers.serverPort"),value:"serverPort"},{title:r("platform.rooms.headers.actions"),value:"actions"}],C=u(!1),p=u({id:void 0,gameName:"",gameMode:"",ports:[],screens:[]}),K=u(!1),X=async m=>{C.value=!0,K.value=!0;const o={roomID:T.room.id},c=[],t=await G.screen.running.get(o);for(let V of t.data)V!==""&&c.push(V);const d=[];d.push(m.masterPort);for(let V of m.worlds)d.push(V.serverPort),d.push(V.masterServerPort),d.push(V.authenticationPort);p.value={id:m.id,gameName:m.gameName,gameMode:m.gameMode,ports:d,screens:c},K.value=!1},$=u(!1),Y=m=>{$.value=!0;const o={screenName:m};G.screen.kill.post(o).then(c=>{I(c.message)}).finally(()=>{$.value=!1})},w=(m,o)=>{switch(m){case"details":X(o);break;case"activate":Z(o);break;case"deactivate":ee(o);break;case"delete":q.value=o.id,b.value=!0;break}},F=u(!1),Z=m=>{F.value=!0;const o={roomID:m.id};L.activate.post(o).then(c=>{I(c.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{F.value=!1})},M=u(!1),ee=m=>{M.value=!0;const o={roomID:m.id};L.deactivate.post(o).then(c=>{I(c.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{M.value=!1})},b=u(!1),q=u(0),D=u(!1),ae=()=>{D.value=!0;const m={roomID:q.value};L.base.delete(m).then(o=>{b.value=!1,I(o.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0}),T.room.id===q.value&&(T.room.id=0)}).finally(()=>{D.value=!1})};return(m,o)=>{const c=le;return g(),R(E,null,[l(Q,null,{default:e(()=>[l(O,null,{default:e(()=>[l(y,null,{default:e(()=>[l(v,{cols:"12"},{default:e(()=>[l(de,{modelValue:a(P),"onUpdate:modelValue":o[0]||(o[0]=t=>A(P)?P.value=t:null),label:a(r)("platform.user.search.label"),placeholder:a(r)("platform.user.search.placeholder"),clearable:"",onKeyup:o[1]||(o[1]=se(t=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}),["enter"])),"onClick:clear":o[2]||(o[2]=t=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}))},null,8,["modelValue","label","placeholder"])]),_:1}),l(v,{cols:"12"},{default:e(()=>[l(ne,{rounded:"",border:""},{default:e(()=>[l(ue,{"items-per-page":a(i).pageSize,"onUpdate:itemsPerPage":o[4]||(o[4]=t=>a(i).pageSize=t),items:a(i).rows,"items-length":a(i).total,page:a(i).page,loading:a(x),headers:J,"onUpdate:options":_},{top:e(()=>[l(pe,{flat:""},{default:e(()=>[l(ge,null,{default:e(()=>[l(h,{icon:"ri-instance-line",start:""}),a(j)?z("",!0):(g(),R("span",_e,s(a(r)("platform.rooms.title")),1))]),_:1}),l(U,{"prepend-icon":"ri-refresh-line",loading:a(x),color:"default",onClick:o[3]||(o[3]=t=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}))},{default:e(()=>[n(s(a(r)("platform.user.table.refresh")),1)]),_:1},8,["loading"])]),_:1})]),"item.id":e(({value:t})=>[l(f,{label:"",color:"primary"},{default:e(()=>[n(s(t),1)]),_:2},1024)]),"item.status":e(({value:t})=>[t?(g(),k(f,{key:0,color:"success",label:""},{default:e(()=>[n(s(a(r)("platform.rooms.activate")),1)]),_:1})):(g(),k(f,{key:1,color:"warning",label:""},{default:e(()=>[n(s(a(r)("platform.rooms.deactivate")),1)]),_:1}))]),"item.maxPlayer":e(({value:t})=>[l(f,{label:""},{default:e(()=>[n(s(t),1)]),_:2},1024)]),"item.worldNum":e(({item:t})=>[l(f,{label:"",color:"info"},{default:e(()=>[n(s(t.worlds.length),1)]),_:2},1024)]),"item.modNum":e(({item:t})=>[l(f,{label:"",color:"info"},{default:e(()=>[n(s(t.modInOne?a(W)(t.modData).length:a(W)(t.worlds[0].modData).length),1)]),_:2},1024)]),"item.serverPort":e(({item:t})=>[l(f,{label:"",color:"info"},{default:e(()=>[n(s(t.worlds.map(d=>d.serverPort).join(",")),1)]),_:2},1024)]),"item.actions":e(({item:t})=>[l(U,{color:"info","append-icon":"ri-arrow-drop-down-line",variant:"text",loading:a(F)||a(M)||a(D)},{default:e(()=>[n(s(a(r)("platform.user.table.actions"))+" ",1),l(fe,{activator:"parent"},{default:e(()=>[l(ce,null,{default:e(()=>[l(S,{class:"text-info",onClick:d=>w("details",t)},{prepend:e(()=>[l(h,{icon:"ri-information-2-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.details")),1)]),_:1})]),_:1},8,["onClick"]),l(S,{class:"text-success",disabled:t.status,onClick:d=>w("activate",t)},{prepend:e(()=>[l(h,{icon:"ri-play-large-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.activate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),l(S,{class:"text-warning",disabled:!t.status,onClick:d=>w("deactivate",t)},{prepend:e(()=>[l(h,{icon:"ri-stop-large-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.deactivate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),l(S,{class:"text-error",onClick:d=>w("delete",t)},{prepend:e(()=>[l(h,{icon:"ri-delete-bin-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.delete")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["loading"])]),_:1},8,["items-per-page","items","items-length","page","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ve,{modelValue:a(C),"onUpdate:modelValue":o[5]||(o[5]=t=>A(C)?C.value=t:null),width:a(j)?"90%":"60%"},{default:e(()=>[l(Q,null,{default:e(()=>[l(me,null,{default:e(()=>[n(s(a(r)("platform.rooms.dialog.title")),1)]),_:1}),l(O,{class:"ma-4"},{default:e(()=>[l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(f,{label:"",color:"info",class:"mr-4"},{default:e(()=>[...o[8]||(o[8]=[n(" ID ",-1)])]),_:1}),B("span",null,s(a(p).id),1)]),_:1})]),_:1}),l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(f,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.gameName")),1)]),_:1}),B("span",null,s(a(p).gameName),1)]),_:1})]),_:1}),l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(f,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.gameMode")),1)]),_:1}),B("span",null,s(a(r)(`game.base.step1.gameMode.modes.${a(p).gameMode}`)),1)]),_:1})]),_:1}),l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(f,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.ports")),1)]),_:1}),B("span",null,s(a(p).ports.join(",")),1)]),_:1})]),_:1}),a(p).screens.length!==0?(g(),k(H,{key:0,color:"primary",density:"compact",class:"mt-8 mb-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.screenTip")),1)]),_:1})):z("",!0),a(p).screens.length===0?(g(),k(H,{key:1,color:"warning",density:"compact",class:"mt-8 mb-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.noScreenTip")),1)]),_:1})):z("",!0),a(p).screens.length!==0?(g(!0),R(E,{key:2},ie(a(p).screens,t=>(g(),k(y,null,{default:e(()=>[l(v,{cols:"6"},{default:e(()=>[l(f,{label:""},{default:e(()=>[n(s(t),1)]),_:2},1024)]),_:2},1024),l(v,{cols:"6"},{default:e(()=>[l(U,{density:"compact",loading:a($),onClick:d=>Y(t)},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.kill")),1)]),_:1},8,["loading","onClick"])]),_:2},1024)]),_:2},1024))),256)):z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),l(c,{modelValue:a(b),"onUpdate:modelValue":o[6]||(o[6]=t=>A(b)?b.value=t:null),type:"warning",title:a(r)("global.confirm.title"),content:a(r)("global.confirm.content"),"confirm-text":a(r)("global.confirm.confirm"),"cancel-text":a(r)("global.confirm.cancel"),"confirm-loading":a(D),onConfirm:ae,onCancel:o[7]||(o[7]=t=>b.value=!1)},null,8,["modelValue","title","content","confirm-text","cancel-text","confirm-loading"])],64)}}};export{Qe as default};
