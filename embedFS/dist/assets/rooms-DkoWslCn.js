import{_ as le}from"./ConfirmBox-CPZbh5_a.js";import{e as te,b as oe,g as re,h as u,c as M,o as g,a as l,w as e,l as a,ac as se,s as q,a8 as ne,p as R,q as n,t as s,P as S,Q as N,G as h,a7 as E,y as k,E as z,k as B,F as K,v as ie,B as I}from"./index-Cpi_5jeC.js";import{r as L}from"./room-DJfQFaHt.js";import{p as G}from"./platform-OIdEP_xM.js";import{a as O,V as Q,c as me}from"./VCard-ZqPzOf5v.js";import{V as y}from"./VRow-Btq46u2M.js";import{V as v}from"./VCol-Br9p8SvW.js";import{V as de}from"./VTextField-DYhVUV9X.js";import{V as ue}from"./VDataTableServer-CRFCkTGN.js";import{V as ce}from"./VMenu-CxB9H3rV.js";import{V as fe}from"./VList-DRw1DleY.js";import{V as c}from"./VChip-Bh9Ug9id.js";import{V as pe,a as ge}from"./VToolbar-G4SrZZyX.js";import{V as W}from"./VAlert-BkYt7vzY.js";import{V as ve}from"./VDialog-DWc1dWI_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VSpacer-DElNdgDF.js";/* empty css              */import"./axios-DcC5xP6t.js";import"./index-C79QJLOU.js";import"./VInput-0HHYP18N.js";import"./VDataTable-MwzuhUk-.js";import"./VPagination-DAL6okay.js";import"./VSelect-CBV9Nj71.js";import"./VCheckboxBtn-SGlC0nov.js";import"./VSelectionControl-DnzLro3k.js";import"./dialog-transition-Cs1ajW-l.js";import"./VTable-B_THj38S.js";import"./filter-Dgu3Q5Sx.js";import"./ssrBoot-C_2zAg2k.js";const _e={key:0},He={__name:"rooms",setup(be){const{mobile:U}=te(),{t:r}=oe(),H=re(),P=u(""),i=u({rows:[],page:1,pageSize:10,total:0}),x=u(!1),_=({page:m,itemsPerPage:o,sortBy:f})=>{const t={gameName:P.value,page:m,pageSize:o};x.value=!0,L.list.get(t).then(d=>{i.value=d.data,i.value.rows=d.data.rows||[]}).finally(()=>{x.value=!1})},J=[{title:"ID",value:"id"},{title:r("platform.rooms.headers.gameName"),value:"gameName"},{title:r("platform.rooms.headers.status"),value:"status"},{title:r("platform.rooms.headers.maxPlayer"),value:"maxPlayer",minWidth:120},{title:r("platform.rooms.headers.worldNum"),value:"worldNum"},{title:r("platform.rooms.headers.modNum"),value:"modNum"},{title:r("platform.rooms.headers.serverPort"),value:"serverPort"},{title:r("platform.rooms.headers.actions"),value:"actions"}],C=u(!1),p=u({id:void 0,gameName:"",gameMode:"",ports:[],screens:[]}),A=u(!1),X=async m=>{C.value=!0,A.value=!0;const o={roomID:H.room.id},f=[],t=await G.screen.running.get(o);for(let V of t.data)V!==""&&f.push(V);const d=[];d.push(m.masterPort);for(let V of m.worlds)d.push(V.serverPort),d.push(V.masterServerPort),d.push(V.authenticationPort);p.value={id:m.id,gameName:m.gameName,gameMode:m.gameMode,ports:d,screens:f},A.value=!1},T=u(!1),Y=m=>{T.value=!0;const o={screenName:m};G.screen.kill.post(o).then(f=>{I(f.message)}).finally(()=>{T.value=!1})},w=(m,o)=>{switch(m){case"details":X(o);break;case"activate":Z(o);break;case"deactivate":ee(o);break;case"delete":j.value=o.id,b.value=!0;break}},$=u(!1),Z=m=>{$.value=!0;const o={roomID:m.id};L.activate.post(o).then(f=>{I(f.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{$.value=!1})},F=u(!1),ee=m=>{F.value=!0;const o={roomID:m.id};L.deactivate.post(o).then(f=>{I(f.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{F.value=!1})},b=u(!1),j=u(0),D=u(!1),ae=()=>{D.value=!0;const m={roomID:j.value};L.base.delete(m).then(o=>{b.value=!1,I(o.message),_({page:i.value.page,itemsPerPage:i.value.pageSize,sortBy:void 0})}).finally(()=>{D.value=!1})};return(m,o)=>{const f=le;return g(),M(K,null,[l(Q,null,{default:e(()=>[l(O,null,{default:e(()=>[l(y,null,{default:e(()=>[l(v,{cols:"12"},{default:e(()=>[l(de,{modelValue:a(P),"onUpdate:modelValue":o[0]||(o[0]=t=>q(P)?P.value=t:null),label:a(r)("platform.user.search.label"),placeholder:a(r)("platform.user.search.placeholder"),clearable:"",onKeyup:o[1]||(o[1]=se(t=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}),["enter"])),"onClick:clear":o[2]||(o[2]=t=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}))},null,8,["modelValue","label","placeholder"])]),_:1}),l(v,{cols:"12"},{default:e(()=>[l(ne,{rounded:"",border:""},{default:e(()=>[l(ue,{"items-per-page":a(i).pageSize,"onUpdate:itemsPerPage":o[4]||(o[4]=t=>a(i).pageSize=t),items:a(i).rows,"items-length":a(i).total,page:a(i).page,loading:a(x),headers:J,"onUpdate:options":_},{top:e(()=>[l(pe,{flat:""},{default:e(()=>[l(ge,null,{default:e(()=>[l(h,{icon:"ri-instance-line",start:""}),a(U)?z("",!0):(g(),M("span",_e,s(a(r)("platform.rooms.title")),1))]),_:1}),l(R,{"prepend-icon":"ri-refresh-line",loading:a(x),color:"default",onClick:o[3]||(o[3]=t=>_({page:a(i).page,itemsPerPage:a(i).pageSize,sortBy:void 0}))},{default:e(()=>[n(s(a(r)("platform.user.table.refresh")),1)]),_:1},8,["loading"])]),_:1})]),"item.id":e(({value:t})=>[l(c,{label:"",color:"primary"},{default:e(()=>[n(s(t),1)]),_:2},1024)]),"item.status":e(({value:t})=>[t?(g(),k(c,{key:0,color:"success",label:""},{default:e(()=>[n(s(a(r)("platform.rooms.activate")),1)]),_:1})):(g(),k(c,{key:1,color:"warning",label:""},{default:e(()=>[n(s(a(r)("platform.rooms.deactivate")),1)]),_:1}))]),"item.maxPlayer":e(({value:t})=>[l(c,{label:""},{default:e(()=>[n(s(t),1)]),_:2},1024)]),"item.worldNum":e(({item:t})=>[l(c,{label:"",color:"info"},{default:e(()=>[n(s(t.worlds.length),1)]),_:2},1024)]),"item.modNum":e(({item:t})=>[l(c,{label:"",color:"info"},{default:e(()=>[n(s(t.modInOne?a(E)(t.modData).length:a(E)(t.worlds[0].modData).length),1)]),_:2},1024)]),"item.serverPort":e(({item:t})=>[l(c,{label:"",color:"info"},{default:e(()=>[n(s(t.worlds.map(d=>d.serverPort).join(",")),1)]),_:2},1024)]),"item.actions":e(({item:t})=>[l(R,{color:"info","append-icon":"ri-arrow-drop-down-line",variant:"text",loading:a($)||a(F)||a(D)},{default:e(()=>[n(s(a(r)("platform.user.table.actions"))+" ",1),l(ce,{activator:"parent"},{default:e(()=>[l(fe,null,{default:e(()=>[l(S,{class:"text-info",onClick:d=>w("details",t)},{prepend:e(()=>[l(h,{icon:"ri-information-2-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.details")),1)]),_:1})]),_:1},8,["onClick"]),l(S,{class:"text-success",disabled:t.status,onClick:d=>w("activate",t)},{prepend:e(()=>[l(h,{icon:"ri-play-large-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.activate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),l(S,{class:"text-warning",disabled:!t.status,onClick:d=>w("deactivate",t)},{prepend:e(()=>[l(h,{icon:"ri-stop-large-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.deactivate")),1)]),_:1})]),_:1},8,["disabled","onClick"]),l(S,{class:"text-error",onClick:d=>w("delete",t)},{prepend:e(()=>[l(h,{icon:"ri-delete-bin-line",size:"22"})]),default:e(()=>[l(N,null,{default:e(()=>[n(s(a(r)("platform.rooms.actions.delete")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["loading"])]),_:1},8,["items-per-page","items","items-length","page","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ve,{modelValue:a(C),"onUpdate:modelValue":o[5]||(o[5]=t=>q(C)?C.value=t:null),width:a(U)?"90%":"60%"},{default:e(()=>[l(Q,null,{default:e(()=>[l(me,null,{default:e(()=>[n(s(a(r)("platform.rooms.dialog.title")),1)]),_:1}),l(O,{class:"ma-4"},{default:e(()=>[l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(c,{label:"",color:"info",class:"mr-4"},{default:e(()=>[...o[8]||(o[8]=[n(" ID ",-1)])]),_:1}),B("span",null,s(a(p).id),1)]),_:1})]),_:1}),l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(c,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.gameName")),1)]),_:1}),B("span",null,s(a(p).gameName),1)]),_:1})]),_:1}),l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(c,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.gameMode")),1)]),_:1}),B("span",null,s(a(r)(`game.base.step1.gameMode.modes.${a(p).gameMode}`)),1)]),_:1})]),_:1}),l(y,{class:"d-flex align-center"},{default:e(()=>[l(v,null,{default:e(()=>[l(c,{label:"",color:"info",class:"mr-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.ports")),1)]),_:1}),B("span",null,s(a(p).ports.join(",")),1)]),_:1})]),_:1}),a(p).screens.length!==0?(g(),k(W,{key:0,color:"primary",density:"compact",class:"mt-8 mb-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.screenTip")),1)]),_:1})):z("",!0),a(p).screens.length===0?(g(),k(W,{key:1,color:"warning",density:"compact",class:"mt-8 mb-4"},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.noScreenTip")),1)]),_:1})):z("",!0),a(p).screens.length!==0?(g(!0),M(K,{key:2},ie(a(p).screens,t=>(g(),k(y,null,{default:e(()=>[l(v,{cols:"6"},{default:e(()=>[l(c,{label:""},{default:e(()=>[n(s(t),1)]),_:2},1024)]),_:2},1024),l(v,{cols:"6"},{default:e(()=>[l(R,{density:"compact",loading:a(T),onClick:d=>Y(t)},{default:e(()=>[n(s(a(r)("platform.rooms.dialog.data.kill")),1)]),_:1},8,["loading","onClick"])]),_:2},1024)]),_:2},1024))),256)):z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),l(f,{modelValue:a(b),"onUpdate:modelValue":o[6]||(o[6]=t=>q(b)?b.value=t:null),type:"warning",title:a(r)("global.confirm.title"),content:a(r)("global.confirm.content"),"confirm-text":a(r)("global.confirm.confirm"),"cancel-text":a(r)("global.confirm.cancel"),"confirm-loading":a(D),onConfirm:ae,onCancel:o[7]||(o[7]=t=>b.value=!1)},null,8,["modelValue","title","content","confirm-text","cancel-text","confirm-loading"])],64)}}};export{He as default};
