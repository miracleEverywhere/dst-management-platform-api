import{_ as He,o as Ke,u as We,a as Ze,g as Je,c as _e,r,a2 as k,Z as Qe,C as Xe,K as i,L as Ye,f as s,i as p,k as t,l as e,j as l,p as K,n as m,m as g,x as et,z as M,q as c,t as u,F,y as W,v as b,A as tt,B as x,D as lt}from"./index-BYv5LKwp.js";import{e as he}from"./index-jzyR_VF-.js";import{t as at}from"./index-DSzW3tuz.js";import nt from"./modInfo-BxLxuC-l.js";const ot={class:"page-div"},st={class:"item-container"},dt={class:"card-footer",style:{"margin-top":"20px"}},it={class:"card-header"},ut={key:0,style:{display:"flex"}},rt={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},ct={key:1,style:{display:"flex"}},mt={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},gt={class:"card-header"},ft={key:1},pt={key:0,class:"tip custom-block"},vt={key:1,class:"tip custom-block"},_t={__name:"mod",setup(ht){Ke(async()=>{ue.value=window.innerHeight,window.addEventListener("resize",()=>{ue.value=window.innerHeight}),await N(),await B(),Ve()});const{t:d}=We(),{isMobile:f}=Ze(),w=Je(),ye=_e(()=>w.isDark),ie=_e(()=>w.language),ue=r(0),re=r("Download"),be=(o,n)=>{o.paneName==="Add"&&A(),o.paneName==="Setting"&&B()},y=r([]),Z=r(!1),q=r(!1),B=()=>{Z.value=!0,v.value=0,U.value="";const o={clusterName:w.selectedDstCluster};k.mod.settingFormat.get(o).then(n=>{n.data===5e3&&(q.value=!0,Qe(n.message)),y.value=n.data;for(let h of y.value)h.id===1&&(P.value=!0)}).finally(()=>{Z.value=!1})},v=r(0),U=r(""),O=(o,n)=>{v.value=o,U.value=n,we()},V=r(!1),$=r({id:"",configOptions:[]}),we=()=>{V.value=!0;const o={clusterName:w.selectedDstCluster,id:v.value};k.mod.configOptions.get(o).then(n=>{$.value=n.data}).finally(()=>{V.value=!1})},ke=()=>{V.value=!0;const o={clusterName:w.selectedDstCluster,modFormattedData:y.value};k.mod.configChange.post(o).then(n=>{x(n.message)}).finally(()=>{V.value=!1})},J=r(!1),E=r({total:0,rows:[]}),Ce=r(),_=r({page:1,pageSize:30,searchText:"",searchType:"text"}),N=(o=!0)=>{o&&(_.value.page=1),J.value=!0,he.modSearch.get(_.value).then(n=>{E.value.rows=n.data.rows,E.value.total=n.data.total,_.value.searchType==="id"&&Xe(ie.value==="zh"?"ID搜索不显示评分":"Search by ID will not display the vote data")}).finally(()=>{J.value=!1})},xe=o=>{N(!1)},De=o=>{N(!1)},ce=r([]),Q=r(!1),A=()=>{Q.value=!0,he.modInfoDownloaded.get().then(o=>{ce.value=o.data}).finally(()=>{Q.value=!1})},X=r(!1),Se=()=>{X.value=!0;const o={clusterName:w.selectedDstCluster};k.mod.sync.post(o).then(n=>{x(n.message),A()}).finally(()=>{X.value=!1})},I=r(!1),ze=o=>{let n=o.cmd,h=o.row;switch(I.value=!0,n){case"enable":Me(h);break;case"delete":Fe(h);break;default:I.value=!1,lt("error")}},Me=o=>{const n=o.file_url==="",h={clusterName:w.selectedDstCluster,isUgc:n,id:o.id};k.mod.enable.post(h).then(S=>{x(S.message)}).finally(()=>{I.value=!1})},Fe=o=>{const h={isUgc:o.file_url==="",id:o.id};k.mod.delete.post(h).then(S=>{x(S.message),A()}).finally(()=>{I.value=!1})},L=r(!1),Ue=()=>{if(v.value===1){L.value=!0;const o={clusterName:w.selectedDstCluster};k.mod.deleteClintModsDisabled.post(o).then(n=>{x(n.message),B(),P.value=!1}).finally(()=>{L.value=!1})}else{L.value=!0;const o=U.value==="",n={clusterName:w.selectedDstCluster,isUgc:o,id:v.value};k.mod.disable.post(n).then(h=>{x(h.message),B()}).finally(()=>{L.value=!1})}},Y=r(""),Ve=()=>{at.osInfo.get().then(o=>{Y.value=o.data.Platform})},ee=r(!1),Ne=()=>{ee.value=!0,k.mod.macosExport.post().then(o=>{x(o.message)}).finally(()=>{ee.value=!1})},te=r(!1),Ie=()=>{te.value=!0;const o={clusterName:w.selectedDstCluster,isUgc:U.value==="",id:v.value,fileURL:U.value};k.mod.update.post(o).then(n=>{x(n.message)}).finally(()=>{te.value=!1})},Le=new URL("data:image/svg+xml,%3csvg%20t='1740385485405'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='25932'%20width='200'%20height='200'%3e%3cpath%20d='M512%20938.666667C276.352%20938.666667%2085.333333%20747.648%2085.333333%20512S276.352%2085.333333%20512%2085.333333s426.666667%20191.018667%20426.666667%20426.666667-191.018667%20426.666667-426.666667%20426.666667z%20m208.682667-575.018667a257.706667%20257.706667%200%200%200-60.330667-60.330667l-357.034667%20357.034667a257.706667%20257.706667%200%200%200%2060.330667%2060.330667l357.034667-357.034667z'%20p-id='25933'%3e%3c/path%3e%3c/svg%3e",import.meta.url).href;r(!1);const P=r(!1),le=r(!1),Te=()=>{le.value=!0;const o={clusterName:w.selectedDstCluster};k.mod.addClintModsDisabled.post(o).then(n=>{x(n.message)}).finally(()=>{le.value=!1,P.value=!0})};return(o,n)=>{const h=i("el-option"),S=i("el-select"),C=i("el-button"),Re=i("el-input"),G=i("el-form-item"),me=i("el-form"),ae=i("el-scrollbar"),qe=i("el-pagination"),j=i("el-card"),ne=i("el-tab-pane"),ge=i("el-tooltip"),Be=i("el-alert"),T=i("el-table-column"),oe=i("el-text"),Oe=i("arrow-down"),$e=i("el-icon"),fe=i("el-dropdown-item"),Ee=i("el-dropdown-menu"),Ae=i("el-dropdown"),Pe=i("el-table"),se=i("el-col"),pe=i("el-row"),ve=i("el-image"),z=i("el-tag"),Ge=i("el-divider"),de=i("el-result"),je=i("el-tabs"),H=Ye("loading");return s(),p("div",ot,[t(je,{modelValue:re.value,"onUpdate:modelValue":n[6]||(n[6]=a=>re.value=a),onTabClick:be},{default:e(()=>[t(ne,{label:l(d)("setting.mod.tab.download"),name:"Download"},{default:e(()=>[K((s(),m(j,{shadow:"never",style:{height:"78vh"}},{default:e(()=>[g("div",null,[t(me,{ref_key:"modSearchFormRef",ref:Ce,inline:!0,model:_.value,onKeyup:et(N,["enter"])},{default:e(()=>[t(G,null,{default:e(()=>[t(Re,{modelValue:_.value.searchText,"onUpdate:modelValue":n[1]||(n[1]=a=>_.value.searchText=a),style:M(l(f)?"width: 75vw;":"width: 50vw;")},{prepend:e(()=>[t(S,{modelValue:_.value.searchType,"onUpdate:modelValue":n[0]||(n[0]=a=>_.value.searchType=a),style:{width:"85px"}},{default:e(()=>[t(h,{label:o.$t("setting.mod.download.searchTypeText"),value:"text"},null,8,["label"]),t(h,{label:o.$t("setting.mod.download.searchTypeId"),value:"id"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(C,{type:"primary",onClick:N},{default:e(()=>[c(u(l(d)("setting.mod.download.search")),1)]),_:1})]),_:1},8,["modelValue","style"])]),_:1})]),_:1},8,["model"])]),g("div",null,[t(ae,{"max-height":"60vh"},{default:e(()=>[g("div",st,[(s(!0),p(F,null,W(E.value.rows,a=>(s(),m(nt,{mod:a},null,8,["mod"]))),256))])]),_:1})]),g("div",dt,[t(qe,{"current-page":_.value.page,"onUpdate:currentPage":n[2]||(n[2]=a=>_.value.page=a),"page-size":_.value.pageSize,"onUpdate:pageSize":n[3]||(n[3]=a=>_.value.pageSize=a),"page-sizes":[10,20,30,40,50,100],total:E.value.total,layout:"total, sizes, prev, pager, next",onSizeChange:n[4]||(n[4]=a=>xe(_.value.pageSize)),onCurrentChange:n[5]||(n[5]=a=>De(_.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[H,J.value]])]),_:1},8,["label"]),t(ne,{label:l(d)("setting.mod.tab.add"),name:"Add"},{default:e(()=>[t(pe,{gutter:10},{default:e(()=>[t(se,{span:24},{default:e(()=>[K((s(),m(j,{shadow:"never",style:{height:"78vh"}},{header:e(()=>[g("div",it,[g("span",null,u(l(d)("setting.mod.add.header.title")),1),g("div",null,[t(C,{size:l(f)?"small":"default",onClick:A},{default:e(()=>[c(u(l(d)("setting.mod.add.header.refresh")),1)]),_:1},8,["size"]),t(ge,{content:l(d)("setting.mod.add.header.syncTooltip"),"show-after":500,effect:"light",placement:"top"},{default:e(()=>[t(C,{size:l(f)?"small":"default",loading:X.value,type:"primary",onClick:Se},{default:e(()=>[c(u(l(d)("setting.mod.add.header.sync")),1)]),_:1},8,["size","loading"])]),_:1},8,["content"]),t(C,{size:l(f)?"small":"default",loading:le.value,type:"danger",disabled:P.value,onClick:Te},{default:e(()=>[c(u(l(d)("setting.mod.add.header.addClientDisabled")),1)]),_:1},8,["size","loading","disabled"]),Y.value==="darwin"?(s(),m(C,{key:0,size:l(f)?"small":"default",loading:ee.value,type:"success",onClick:Ne},{default:e(()=>[c(u(l(d)("setting.mod.add.header.export")),1)]),_:1},8,["size","loading"])):b("",!0)])])]),default:e(()=>[t(Be,{closable:!1,effect:ye.value?"light":"dark",type:"warning"},{default:e(()=>[c(u(l(d)("setting.mod.add.alert")),1)]),_:1},8,["effect"]),t(Pe,{data:ce.value,border:"",style:{height:"51vh","margin-top":"10px"}},{default:e(()=>[t(T,{label:l(d)("setting.mod.add.table.name"),prop:"name"},null,8,["label"]),t(T,{label:"ID",prop:"id"}),t(T,{label:l(d)("setting.mod.add.table.size")},{default:e(a=>[c(u(l(tt)(a.row.size)),1)]),_:1},8,["label"]),t(T,{label:l(d)("setting.mod.add.table.downloadedReady.title")},{default:e(a=>[a.row.downloadedReady?(s(),m(oe,{key:0,size:"small",type:"success"},{default:e(()=>[c(u(l(d)("setting.mod.add.table.downloadedReady.ready")),1)]),_:1})):b("",!0),a.row.downloadedReady?b("",!0):(s(),p(F,{key:1},[a.row.file_url!==""?(s(),m(oe,{key:0,size:"small",type:"info"},{default:e(()=>[c(u(l(d)("setting.mod.add.table.downloadedReady.notUGC")),1)]),_:1})):(s(),m(oe,{key:1,size:"small",type:"warning"},{default:e(()=>[c(u(l(d)("setting.mod.add.table.downloadedReady.notReady")),1)]),_:1}))],64))]),_:1},8,["label"]),t(T,{label:l(d)("setting.mod.add.table.action")},{default:e(a=>[t(Ae,{trigger:"click",onCommand:ze},{dropdown:e(()=>[t(Ee,null,{default:e(()=>[t(fe,{disabled:q.value,command:{cmd:"enable",row:a.row}},{default:e(()=>[c(u(l(d)("setting.mod.add.table.enable")),1)]),_:2},1032,["disabled","command"]),t(fe,{disabled:q.value,command:{cmd:"delete",row:a.row}},{default:e(()=>[c(u(l(d)("setting.mod.add.table.delete")),1)]),_:2},1032,["disabled","command"])]),_:2},1024)]),default:e(()=>[t(C,{disabled:q.value,loading:I.value,link:"",type:"primary"},{default:e(()=>[c(u(l(d)("setting.mod.add.table.action"))+" ",1),t($e,{class:"el-icon--right"},{default:e(()=>[t(Oe)]),_:1})]),_:1},8,["disabled","loading"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})),[[H,Q.value]])]),_:1})]),_:1})]),_:1},8,["label"]),Y.value!=="darwin"?(s(),m(ne,{key:0,label:l(d)("setting.mod.tab.setting"),name:"Setting"},{default:e(()=>[t(pe,{gutter:10},{default:e(()=>[t(se,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[K((s(),m(j,{style:M(l(f)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[t(ae,{"max-height":l(f)?"45vh":"65vh"},{default:e(()=>[y.value?(s(!0),p(F,{key:0},W(y.value,(a,D)=>(s(),p(F,null,[a.id===1?(s(),p("div",ut,[g("div",null,[t(ve,{src:l(Le),fit:"fill",style:{width:"75px",height:"75px"},onClick:R=>O(a.id,a.file_url)},null,8,["src","onClick"])]),g("div",rt,[t(C,{link:"",type:"primary",onClick:R=>O(a.id,a.file_url)},{default:e(()=>[c(u(l(d)("setting.mod.setting.right.clientModsDisabled")),1)]),_:2},1032,["onClick"]),g("div",null,[a.enable?(s(),m(z,{key:0,type:"success"},{default:e(()=>[c(u(l(d)("setting.mod.setting.left.enable")),1)]),_:1})):b("",!0),a.enable?b("",!0):(s(),m(z,{key:1,type:"info"},{default:e(()=>[c(u(l(d)("setting.mod.setting.left.disable")),1)]),_:1}))])])])):(s(),p("div",ct,[g("div",null,[t(ve,{src:a.preview_url,fit:"fill",style:{width:"75px",height:"75px"},onClick:R=>O(a.id,a.file_url)},null,8,["src","onClick"])]),g("div",mt,[t(C,{link:"",type:"primary",onClick:R=>O(a.id,a.file_url)},{default:e(()=>[c(u(a.name),1)]),_:2},1032,["onClick"]),g("div",null,[a.enable?(s(),m(z,{key:0,type:"success"},{default:e(()=>[c(u(l(d)("setting.mod.setting.left.enable")),1)]),_:1})):b("",!0),a.enable?b("",!0):(s(),m(z,{key:1,type:"info"},{default:e(()=>[c(u(l(d)("setting.mod.setting.left.disable")),1)]),_:1}))])])])),D!==y.value.length-1?(s(),m(Ge,{key:2})):b("",!0)],64))),256)):(s(),p("div",{key:1,style:M(l(f)?"height: 50vh":"height: 70vh"),class:"fcc"},[t(de,{title:l(d)("setting.mod.setting.left.result"),icon:"warning"},null,8,["title"])],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[H,Z.value]])]),_:1}),t(se,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[K((s(),m(j,{style:M(l(f)?"height: 50vh; margin: 10px 0 30px 0":"height: 70vh"),shadow:"never"},{header:e(()=>[g("div",gt,[g("span",null,u(l(d)("setting.mod.setting.right.header.title")),1),g("div",null,[t(C,{disabled:v.value<2,loading:te.value,type:"primary",onClick:Ie},{default:e(()=>[c(u(l(d)("setting.mod.setting.right.header.update")),1)]),_:1},8,["disabled","loading"]),t(C,{disabled:v.value===0,loading:L.value,type:"danger",onClick:Ue},{default:e(()=>[c(u(l(d)("setting.mod.setting.right.header.disable")),1)]),_:1},8,["disabled","loading"])])])]),default:e(()=>[v.value>1?(s(),m(ae,{key:0,"max-height":l(f)?"37vh":"57vh"},{default:e(()=>[$.value.configOptions?(s(),m(me,{key:0,ref:"modSettingFormRef","label-position":l(f)?"top":"left","label-width":l(f)?"70":"auto",size:l(f)?"small":"large"},{default:e(()=>[t(G,{label:"ID"},{default:e(()=>[t(z,null,{default:e(()=>[c(u($.value.id),1)]),_:1})]),_:1}),t(G,{label:l(d)("setting.mod.setting.right.name")},{default:e(()=>[t(z,{type:"info"},{default:e(()=>[c(u(y.value[y.value.findIndex(a=>a.id===v.value)].name),1)]),_:1})]),_:1},8,["label"]),(s(!0),p(F,null,W($.value.configOptions,a=>(s(),m(ge,{content:a.hover,"show-after":500,effect:"light",placement:"top"},{default:e(()=>[t(G,{label:a.label},{default:e(()=>[t(S,{modelValue:y.value[y.value.findIndex(D=>D.id===v.value)].configurationOptions[a.name],"onUpdate:modelValue":D=>y.value[y.value.findIndex(R=>R.id===v.value)].configurationOptions[a.name]=D,onChange:ke},{default:e(()=>[(s(!0),p(F,null,W(a.options,D=>(s(),m(h,{label:D.description,value:D.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["label-position","label-width","size"])):(s(),p("div",{key:1,style:M(l(f)?"height: 40vh; margin-top: 10px":"height: 60vh"),class:"fcc"},[t(de,{title:l(d)("setting.mod.setting.right.result"),icon:"info"},null,8,["title"])],4))]),_:1},8,["max-height"])):b("",!0),v.value===1?(s(),p("div",ft,[ie.value==="zh"?(s(),p("div",pt,"如果启用此配置，则会禁用玩家的本地模组")):(s(),p("div",vt,"If enable this configuration option, the game server will Disable player's client mods"))])):b("",!0),v.value===0?(s(),p("div",{key:2,style:M(l(f)?"height: 40vh; margin-top: 10px":"height: 60vh"),class:"fcc"},[t(de,{title:l(d)("setting.mod.setting.right.result2"),icon:"info"},null,8,["title"])],4)):b("",!0)]),_:1},8,["style"])),[[H,V.value]])]),_:1})]),_:1})]),_:1},8,["label"])):b("",!0)]),_:1},8,["modelValue"])])}}},Ct=He(_t,[["__scopeId","data-v-1afb3e1d"]]);export{Ct as default};
