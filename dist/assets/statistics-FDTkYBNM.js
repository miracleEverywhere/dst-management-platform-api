import{t as E}from"./index-BP4O8J1U.js";import{_ as K,f as j,i as k,t as u,u as M,a as I,g as z,G,H,d as J,I as L,c as F,o as Q,at as N,B as U,r as w,w as W,J as O,K as f,k as l,l as i,m as r,q as v,j as o,a1 as X}from"./index-DRaBk72F.js";import{S as Y}from"./index-Rz64WdE6.js";let T=0;const C="webkit moz ms o".split(" ");let c,d;const Z=typeof window>"u";if(Z)c=function(){},d=function(){};else{c=window.requestAnimationFrame,d=window.cancelAnimationFrame;let e;for(let t=0;t<C.length&&!(c&&d);t++)e=C[t],c=c||window[e+"RequestAnimationFrame"],d=d||window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"];(!c||!d)&&(c=function(t){const s=new Date().getTime(),a=Math.max(0,16-(s-T)),n=window.setTimeout(()=>{t(s+a)},a);return T=s+a,n},d=function(t){window.clearTimeout(t)})}const tt={props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:2017},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:0,validator(e){return e>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default(e,t,s,a){return s*(-Math.pow(2,-10*e/a)+1)*1024/1023+t}}},data(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown(){return this.startVal>this.endVal}},watch:{startVal(){this.autoplay&&this.start()},endVal(){this.autoplay&&this.start()}},mounted(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=c(this.count)},pauseResume(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause(){d(this.rAF)},resume(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,c(this.count)},reset(){this.startTime=null,d(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count(e){this.startTime||(this.startTime=e),this.timestamp=e;const t=e-this.startTime;this.remaining=this.localDuration-t,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(t,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(t,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(t/this.localDuration):this.printVal=this.localStartVal+(this.endVal-this.localStartVal)*(t/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),t<this.localDuration?this.rAF=c(this.count):this.$emit("callback")},isNumber(e){return!isNaN(parseFloat(e))},formatNumber(e){e=e.toFixed(this.decimals),e+="";const t=e.split(".");let s=t[0];const a=t.length>1?this.decimal+t[1]:"",n=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;n.test(s);)s=s.replace(n,"$1"+this.separator+"$2");return this.prefix+s+a+this.suffix}},destroyed(){d(this.rAF)}};function et(e,t,s,a,n,x){return j(),k("span",null,u(n.displayValue),1)}const g=K(tt,[["render",et]]);function st(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function q(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),s.push.apply(s,a)}return s}g.unmounted=g.destroyed,Reflect.deleteProperty(g,"destroyed");var P=function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?q(Object(s),!0).forEach(function(a){st(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):q(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}({name:"CountTo",emits:["callback","mountedCallback"]},g);const at={class:"page-div"},it={class:"card-header"},lt={class:"card-header"},rt={class:"flex justify-between"},ot={class:"text-sm"},nt={class:"text-2xl"},ut={class:"card-header"},ct={class:"flex justify-between"},dt={class:"text-sm"},ht={class:"text-2xl"},pt={class:"card-header"},mt={class:"flex justify-between"},ft={class:"text-sm"},_t={class:"text-2xl"},yt=X({name:"toolsStatistics"}),wt=Object.assign(yt,{setup(e){const{t}=M();I();const s=z(),a=G();H();const n=J(),x=L("refresh");F(()=>s.isDark),F(()=>s.language),Q(()=>{b()});const b=(_=!1)=>{const A={clusterName:s.selectedDstCluster};E.statistics.get(A).then(y=>{for(let h of y.data)m.value.xAxis.data.push(N(h.timestamp)),m.value.series[0].data.push(h.num),h.num>p.value.num&&(p.value=h);p.value.dataVolume=y.data.length,_&&U(t("tools.statistics.player.refreshSuccess"))})},p=w({num:-1,timestamp:0,dataVolume:0}),R=()=>{m.value.xAxis.data=[],m.value.series[0].data=[],b(!0),S.value.redraw(m.value)},S=w(),m=w({tooltip:{trigger:"axis"},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{data:[],type:"line",smooth:!0,areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(1, 255, 255, 0.8)"},{offset:1,color:"rgba(1, 255, 255,0)"}],global:!1}}}]}),$=()=>{setTimeout(()=>{a.meta.isKeepAlive&&n.removeKeepAliveName(a.name),x(!1),O(()=>{a.meta.isKeepAlive&&n.addKeepAliveName(a.name),x(!0)})},0)};return W(()=>s.selectedDstCluster,_=>{_&&O(()=>{$()})},{immediate:!1}),(_,A)=>{const y=f("el-button"),h=f("el-card"),V=f("el-col"),D=f("el-row"),B=f("el-tag");return j(),k("div",at,[l(D,{gutter:10},{default:i(()=>[l(V,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:i(()=>[l(h,{shadow:"never"},{header:i(()=>[r("div",it,[v(u(o(t)("tools.statistics.player.title"))+" ",1),l(y,{onClick:R},{default:i(()=>[v(u(o(t)("tools.statistics.player.refresh")),1)]),_:1})])]),default:i(()=>[l(Y,{ref_key:"playerChartRef",ref:S,option:m.value,height:"300px"},null,8,["option"])]),_:1})]),_:1})]),_:1}),l(D,{gutter:10},{default:i(()=>[l(V,{lg:8,md:8,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:i(()=>[l(h,{shadow:"never"},{header:i(()=>[r("div",lt,u(o(t)("tools.statistics.max.title")),1)]),default:i(()=>[r("div",rt,[r("span",ot,u(o(t)("tools.statistics.max.maxPlayer")),1),l(B,{type:"success"},{default:i(()=>[v(u(o(t)("tools.statistics.max.day")),1)]),_:1})]),r("div",nt,[l(o(P),{duration:2e3,endVal:p.value.num,startVal:0},null,8,["endVal"])])]),_:1})]),_:1}),l(V,{lg:8,md:8,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:i(()=>[l(h,{shadow:"never"},{header:i(()=>[r("div",ut,u(o(t)("tools.statistics.max.maxPlayerTimestamp")),1)]),default:i(()=>[r("div",ct,[r("span",dt,u(o(t)("tools.statistics.max.time")),1)]),r("div",ht,u(o(N)(p.value.timestamp)),1)]),_:1})]),_:1}),l(V,{lg:8,md:8,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:i(()=>[l(h,{shadow:"never"},{header:i(()=>[r("div",pt,u(o(t)("tools.statistics.data.title")),1)]),default:i(()=>[r("div",mt,[r("span",ft,u(o(t)("tools.statistics.data.dataNum")),1)]),r("div",_t,[l(o(P),{duration:2e3,endVal:p.value.dataVolume,startVal:0},null,8,["endVal"])])]),_:1})]),_:1})]),_:1})])}}});export{wt as default};
