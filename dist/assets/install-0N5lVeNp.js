import{u as R,g as F,c as V,a as J,r as b,o as L,d as H,J as n,e as d,f as P,j as t,k as e,x as C,i,l as u,t as s,p as o,m as S,q as $,a0 as K,aj as Q,A as W}from"./index-BtVv7hgU.js";import{t as I}from"./index-BIWRFjAd.js";const X={class:"page-div"},Y={class:"card-header"},Z={class:"card-header"},ee={style:{"margin-top":"5px"}},te={class:"card-header"},le={style:{"margin-top":"10px"}},se={key:0},ae={key:1},oe=K({name:"toolsInstall"}),ce=Object.assign(oe,{setup(ne){const{t:r}=R(),z=F(),y=V(()=>z.language),{isMobile:k}=J(),D=V(()=>z.isDark),_=b(!1),p=b(0),m=b({zh:"",en:""}),a=b({}),M=()=>{I.osInfo.get().then(l=>{a.value=l.data,a.value.Uptime=Q(l.data.Uptime,y.value)})},N=()=>{I.install.post().then(l=>{W(l.message),_.value=!0,j()})},T=()=>{I.installStatus.get().then(l=>{const h=l.data;p.value=h.process,m.value.zh=h.zh,m.value.en=h.en,(p.value===100||p.value===0)&&g()})};let f=null;const j=()=>{f=setInterval(()=>{T()},1e3)},g=()=>{f&&(clearInterval(f),f=null)};return L(()=>{M()}),H(()=>{g(),window.removeEventListener("beforeunload",g)}),(l,h)=>{const c=n("el-descriptions-item"),q=n("el-descriptions"),w=n("el-card"),v=n("el-col"),U=n("el-button"),B=n("el-result"),A=n("el-text"),x=n("el-row"),O=n("el-alert"),E=n("el-tag"),G=n("el-progress");return d(),P("div",X,[t(x,{gutter:20},{default:e(()=>[t(v,{lg:12,md:12,sm:24,span:12,xs:24},{default:e(()=>[t(w,{style:C(i(k)?"min-height: 300px":"min-height: 500px"),shadow:"never"},{header:e(()=>[u("span",Y,s(i(r)("tools.install.systemInfo")),1)]),default:e(()=>[t(q,{column:1,border:""},{default:e(()=>[t(c,{label:l.$t("tools.install.architecture")},{default:e(()=>[o(s(a.value.Architecture),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.osType")},{default:e(()=>[o(s(a.value.OS),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.osName")},{default:e(()=>[o(s(a.value.Platform),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.osVersion")},{default:e(()=>[o(s(a.value.PlatformVersion),1)]),_:1},8,["label"]),t(c,{label:"CPU"},{default:e(()=>[o(s(a.value.CPUModel),1)]),_:1}),t(c,{label:i(r)("tools.install.cpuCore")},{default:e(()=>[o(s(a.value.CPUCores),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.memory")},{default:e(()=>[o(s((a.value.MemorySize/1024**3).toFixed(2))+" GB ",1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.uptime")},{default:e(()=>[o(s(a.value.Uptime),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["style"])]),_:1}),t(v,{lg:12,md:12,sm:24,span:12,style:C(i(k)?"margin-top: 20px":"margin-top: 0px"),xs:24},{default:e(()=>[t(w,{style:C(i(k)?"min-height: 300px":"min-height: 500px"),shadow:"never"},{header:e(()=>[u("span",Z,s(l.$t("tools.install.installCheck")),1)]),default:e(()=>[a.value.Platform==="ubuntu"||a.value.Platform==="centos"||a.value.Platform==="rocky"?(d(),S(B,{key:0,"sub-title":l.$t("tools.install.checkPassDesc"),title:l.$t("tools.install.checkPass"),icon:"success"},{extra:e(()=>[t(U,{loading:_.value,type:"primary",onClick:N},{default:e(()=>[o(s(i(r)("tools.install.install")),1)]),_:1},8,["loading"])]),_:1},8,["sub-title","title"])):(d(),S(B,{key:1,"sub-title":l.$t("tools.install.checkNotPassDesc"),title:l.$t("tools.install.checkNotPass"),icon:"warning"},{extra:e(()=>[u("div",null,[t(U,{disabled:a.value.Platform==="darwin",loading:_.value,type:"warning",onClick:N},{default:e(()=>[o(s(i(r)("tools.install.install")),1)]),_:1},8,["disabled","loading"])]),u("div",ee,[t(A,{type:"info"},{default:e(()=>[o(s(i(r)("tools.install.macosTip")),1)]),_:1})])]),_:1},8,["sub-title","title"]))]),_:1},8,["style"])]),_:1},8,["style"])]),_:1}),t(x,{gutter:20},{default:e(()=>[t(v,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(O,{closable:!1,effect:D.value?"light":"dark",type:"success"},{default:e(()=>[o(s(i(r)("tools.install.installTip")),1)]),_:1},8,["effect"])]),_:1})]),_:1}),_.value?(d(),S(x,{key:0,gutter:20},{default:e(()=>[t(v,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(w,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[u("div",te,[u("span",null,s(i(r)("tools.install.installProgress")),1),t(E,{style:{"font-weight":"lighter"},type:"warning"},{default:e(()=>[o(s(i(r)("tools.install.noClose")),1)]),_:1})])]),default:e(()=>[t(G,{percentage:p.value,status:p.value===100?"success":"","stroke-width":15,striped:"","striped-flow":""},null,8,["percentage","status"]),u("div",le,[y.value==="zh"?(d(),P("span",se,s(m.value.zh),1)):$("",!0),y.value==="en"?(d(),P("span",ae,s(m.value.en),1)):$("",!0)])]),_:1})]),_:1})]),_:1})):$("",!0)])}}});export{ce as default};
