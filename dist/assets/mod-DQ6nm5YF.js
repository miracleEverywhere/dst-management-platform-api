import{_ as et,o as tt,u as lt,a as at,g as ot,b as nt,c as Ie,r as c,a2 as w,Z as dt,C as st,K as u,L as it,f as s,i as g,k as t,l as e,j as l,p as W,n as m,m as p,x as rt,z as V,q as r,t as i,F as L,y as Z,a9 as ut,v as k,A as ct,B as x,D as mt}from"./index-D3kHjDlT.js";import{e as Ve}from"./index-CnYxF74V.js";import{t as gt}from"./index-IWDPPw70.js";import ft from"./modInfo-DSuZetyx.js";const pt={class:"page-div"},vt={class:"item-container"},_t={class:"card-footer",style:{"margin-top":"20px"}},ht={class:"card-header"},bt={class:"fcc"},yt={key:0},wt={key:1},kt={key:0,style:{display:"flex"}},Ct={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},xt={key:1,style:{display:"flex"}},Dt={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},St={class:"card-header"},Mt={key:1},zt={key:0,class:"tip custom-block"},Ft={key:1,class:"tip custom-block"},Ut={__name:"mod",setup(It){tt(async()=>{fe.value=window.innerHeight,window.addEventListener("resize",()=>{fe.value=window.innerHeight}),await q(),await E(),Ge()});const{t:d}=lt(),{isMobile:b}=at(),C=ot(),Le=nt(),me=Ie(()=>C.isDark),ge=Ie(()=>C.language),fe=c(0),pe=Le.userInfo,ve=c("Download"),Ne=(a,n)=>{a.paneName==="Add"&&M(),a.paneName==="Setting"&&E()},y=c([]),J=c(!1),N=c(!1),E=()=>{J.value=!0,v.value=0,T.value="";const a={clusterName:C.selectedDstCluster};w.mod.settingFormat.get(a).then(n=>{n.data===5e3&&(N.value=!0,dt(n.message)),y.value=n.data;for(let f of y.value)f.id===1&&($.value=!0)}).finally(()=>{J.value=!1})},v=c(0),T=c(""),A=(a,n)=>{v.value=a,T.value=n,Te()},R=c(!1),P=c({id:"",configOptions:[]}),Te=()=>{R.value=!0;const a={clusterName:C.selectedDstCluster,id:v.value};w.mod.configOptions.get(a).then(n=>{P.value=n.data}).finally(()=>{R.value=!1})},Re=()=>{R.value=!0;const a={clusterName:C.selectedDstCluster,modFormattedData:y.value};w.mod.configChange.post(a).then(n=>{x(n.message)}).finally(()=>{R.value=!1})},X=c(!1),G=c({total:0,rows:[]}),qe=c(),_=c({page:1,pageSize:30,searchText:"",searchType:"text"}),q=(a=!0)=>{a&&(_.value.page=1),X.value=!0,Ve.modSearch.get(_.value).then(n=>{G.value.rows=n.data.rows,G.value.total=n.data.total,_.value.searchType==="id"&&st(ge.value==="zh"?"ID搜索不显示评分":"Search by ID will not display the vote data")}).finally(()=>{X.value=!1})},Be=a=>{q(!1)},$e=a=>{q(!1)},_e=c([]),Y=c(!1),M=()=>{Y.value=!0,Ve.modInfoDownloaded.get().then(a=>{_e.value=a.data}).finally(()=>{Y.value=!1})},j=c([]),Oe=a=>{j.value=a},ee=c(!1),he=()=>{ee.value=!0;const a={clusterName:C.selectedDstCluster};w.mod.sync.post(a).then(n=>{x(n.message),M()}).finally(()=>{ee.value=!1})},z=c(!1),be=a=>{let n=a.cmd,f=a.row;switch(z.value=!0,n){case"enable":Ee(f);break;case"delete":ye(f);break;case"update":Ae(f),z.value=!1;break;case"refresh":M();break;case"sync":he();break;case"multiDelete":ke();break;case"addClientDisabled":Ce();break;default:z.value=!1,mt("error")}},Ee=a=>{const n=a.file_url==="",f={clusterName:C.selectedDstCluster,isUgc:n,id:a.id};w.mod.enable.post(f).then(F=>{x(F.message)}).finally(()=>{z.value=!1})},ye=(a,n=!1)=>{const F={isUgc:a.file_url==="",id:a.id};w.mod.delete.post(F).then(h=>{n||(M(),x(h.message))}).finally(()=>{z.value=!1})},Ae=a=>{const n={id:a.id,file_url:a.file_url};w.mod.download.post(n).then(f=>{x(f.message)})},we=c(!1),ke=async()=>{we.value=!0;for(let a of j.value)await ye(a,!0);we.value=!1,M()},B=c(!1),Pe=()=>{if(v.value===1){B.value=!0;const a={clusterName:C.selectedDstCluster};w.mod.deleteClintModsDisabled.post(a).then(n=>{x(n.message),E(),$.value=!1}).finally(()=>{B.value=!1})}else{B.value=!0;const a=T.value==="",n={clusterName:C.selectedDstCluster,isUgc:a,id:v.value};w.mod.disable.post(n).then(f=>{x(f.message),E()}).finally(()=>{B.value=!1})}},te=c(""),Ge=()=>{gt.osInfo.get().then(a=>{te.value=a.data.Platform})},le=c(!1),je=()=>{le.value=!0,w.mod.macosExport.post().then(a=>{x(a.message)}).finally(()=>{le.value=!1})},ae=c(!1),He=()=>{ae.value=!0;const a={clusterName:C.selectedDstCluster,isUgc:T.value==="",id:v.value,fileURL:T.value};w.mod.update.post(a).then(n=>{x(n.message)}).finally(()=>{ae.value=!1})},Ke=new URL("data:image/svg+xml,%3csvg%20t='1740385485405'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='25932'%20width='200'%20height='200'%3e%3cpath%20d='M512%20938.666667C276.352%20938.666667%2085.333333%20747.648%2085.333333%20512S276.352%2085.333333%20512%2085.333333s426.666667%20191.018667%20426.666667%20426.666667-191.018667%20426.666667-426.666667%20426.666667z%20m208.682667-575.018667a257.706667%20257.706667%200%200%200-60.330667-60.330667l-357.034667%20357.034667a257.706667%20257.706667%200%200%200%2060.330667%2060.330667l357.034667-357.034667z'%20p-id='25933'%3e%3c/path%3e%3c/svg%3e",import.meta.url).href;c(!1);const $=c(!1),oe=c(!1),Ce=()=>{oe.value=!0;const a={clusterName:C.selectedDstCluster};w.mod.addClintModsDisabled.post(a).then(n=>{x(n.message)}).finally(()=>{oe.value=!1,$.value=!0})};return(a,n)=>{const f=u("el-option"),F=u("el-select"),h=u("el-button"),Qe=u("el-input"),H=u("el-form-item"),xe=u("el-form"),ne=u("el-scrollbar"),We=u("el-pagination"),K=u("el-card"),de=u("el-tab-pane"),Ze=u("QuestionFilled"),se=u("el-icon"),ie=u("el-tooltip"),De=u("arrow-down"),S=u("el-dropdown-item"),Se=u("el-dropdown-menu"),Me=u("el-dropdown"),ze=u("el-alert"),U=u("el-table-column"),re=u("el-text"),Je=u("el-table"),ue=u("el-col"),Fe=u("el-row"),Ue=u("el-image"),I=u("el-tag"),Xe=u("el-divider"),ce=u("el-result"),Ye=u("el-tabs"),Q=it("loading");return s(),g("div",pt,[t(Ye,{modelValue:ve.value,"onUpdate:modelValue":n[6]||(n[6]=o=>ve.value=o),onTabClick:Ne},{default:e(()=>[t(de,{label:l(d)("setting.mod.tab.download"),name:"Download"},{default:e(()=>[W((s(),m(K,{shadow:"never",style:{height:"78vh"}},{default:e(()=>[p("div",null,[t(xe,{ref_key:"modSearchFormRef",ref:qe,inline:!0,model:_.value,onKeyup:rt(q,["enter"])},{default:e(()=>[t(H,null,{default:e(()=>[t(Qe,{modelValue:_.value.searchText,"onUpdate:modelValue":n[1]||(n[1]=o=>_.value.searchText=o),style:V(l(b)?"width: 75vw;":"width: 50vw;")},{prepend:e(()=>[t(F,{modelValue:_.value.searchType,"onUpdate:modelValue":n[0]||(n[0]=o=>_.value.searchType=o),style:{width:"85px"}},{default:e(()=>[t(f,{label:a.$t("setting.mod.download.searchTypeText"),value:"text"},null,8,["label"]),t(f,{label:a.$t("setting.mod.download.searchTypeId"),value:"id"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(h,{type:"primary",onClick:q},{default:e(()=>[r(i(l(d)("setting.mod.download.search")),1)]),_:1})]),_:1},8,["modelValue","style"])]),_:1})]),_:1},8,["model"])]),p("div",null,[t(ne,{"max-height":"60vh"},{default:e(()=>[p("div",vt,[(s(!0),g(L,null,Z(G.value.rows,o=>(s(),m(ft,{mod:o},null,8,["mod"]))),256))])]),_:1})]),p("div",_t,[t(We,{"current-page":_.value.page,"onUpdate:currentPage":n[2]||(n[2]=o=>_.value.page=o),"page-size":_.value.pageSize,"onUpdate:pageSize":n[3]||(n[3]=o=>_.value.pageSize=o),"page-sizes":[10,20,30,40,50,100],total:G.value.total,layout:"total, sizes, prev, pager, next",onSizeChange:n[4]||(n[4]=o=>Be(_.value.pageSize)),onCurrentChange:n[5]||(n[5]=o=>$e(_.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[Q,X.value]])]),_:1},8,["label"]),t(de,{label:l(d)("setting.mod.tab.add"),name:"Add"},{default:e(()=>[t(Fe,{gutter:10},{default:e(()=>[t(ue,{span:24},{default:e(()=>[W((s(),m(K,{shadow:"never",style:{height:"78vh"}},{header:e(()=>[p("div",ht,[p("div",bt,[r(i(l(d)("setting.mod.add.header.title"))+" ",1),t(ie,{content:l(d)("setting.mod.add.header.tip"),effect:"light",placement:"top"},{default:e(()=>[t(se,{size:"14",style:{"margin-left":"2px"}},{default:e(()=>[t(Ze)]),_:1})]),_:1},8,["content"])]),l(b)?(s(),g("div",wt,[t(Me,{trigger:"click",onCommand:be},{dropdown:e(()=>[t(Se,null,{default:e(()=>[t(S,{command:{cmd:"refresh",row:""}},{default:e(()=>[r(i(l(d)("setting.mod.add.header.refresh")),1)]),_:1}),t(S,{command:{cmd:"sync",row:""}},{default:e(()=>[r(i(l(d)("setting.mod.add.header.sync")),1)]),_:1}),t(S,{disabled:l(pe).role!=="admin"||j.value.length===0,command:{cmd:"multiDelete",row:""}},{default:e(()=>[r(i(l(d)("setting.mod.add.header.multiDelete")),1)]),_:1},8,["disabled"]),t(S,{disabled:$.value,command:{cmd:"addClientDisabled",row:""}},{default:e(()=>[r(i(l(d)("setting.mod.add.header.addClientDisabled")),1)]),_:1},8,["disabled"])]),_:1})]),default:e(()=>[t(h,{type:"primary"},{default:e(()=>[r(i(l(d)("setting.mod.add.table.action"))+" ",1),t(se,{class:"el-icon--right"},{default:e(()=>[t(De)]),_:1})]),_:1})]),_:1})])):(s(),g("div",yt,[t(h,{onClick:M},{default:e(()=>[r(i(l(d)("setting.mod.add.header.refresh")),1)]),_:1}),t(ie,{content:l(d)("setting.mod.add.header.syncTooltip"),"show-after":500,effect:"light",placement:"top"},{default:e(()=>[t(h,{loading:ee.value,type:"primary",onClick:he},{default:e(()=>[r(i(l(d)("setting.mod.add.header.sync")),1)]),_:1},8,["loading"])]),_:1},8,["content"]),t(h,{disabled:l(pe).role!=="admin"||j.value.length===0,onClick:ke,type:"danger"},{default:e(()=>[r(i(l(d)("setting.mod.add.header.multiDelete")),1)]),_:1},8,["disabled"]),t(h,{loading:oe.value,type:"warning",icon:l(ut),disabled:$.value,onClick:Ce},{default:e(()=>[r(i(l(d)("setting.mod.add.header.addClientDisabled")),1)]),_:1},8,["loading","icon","disabled"]),te.value==="darwin"?(s(),m(h,{key:0,loading:le.value,type:"success",onClick:je},{default:e(()=>[r(i(l(d)("setting.mod.add.header.export")),1)]),_:1},8,["loading"])):k("",!0)]))])]),default:e(()=>[t(ze,{closable:!1,effect:me.value?"light":"dark",type:"warning"},{default:e(()=>[r(i(l(d)("setting.mod.add.alert")),1)]),_:1},8,["effect"]),t(ze,{closable:!1,"auto-close":1e4,effect:me.value?"light":"dark",type:"primary",style:{"margin-top":"5px"}},{default:e(()=>[r(i(l(d)("setting.mod.add.alert2")),1)]),_:1},8,["effect"]),t(Je,{data:_e.value,border:"",onSelectionChange:Oe,style:{height:"51vh","margin-top":"10px"}},{default:e(()=>[t(U,{type:"selection",width:"55px"}),t(U,{label:l(d)("setting.mod.add.table.name"),sortable:"",prop:"name"},null,8,["label"]),t(U,{label:"ID",prop:"id",sortable:""}),t(U,{label:l(d)("setting.mod.add.table.size")},{default:e(o=>[r(i(l(ct)(o.row.size)),1)]),_:1},8,["label"]),t(U,{label:l(d)("setting.mod.add.table.downloadedReady.title"),sortable:""},{default:e(o=>[o.row.downloadedReady?(s(),m(re,{key:0,size:"small",type:"success"},{default:e(()=>[r(i(l(d)("setting.mod.add.table.downloadedReady.ready")),1)]),_:1})):k("",!0),o.row.downloadedReady?k("",!0):(s(),g(L,{key:1},[o.row.file_url!==""?(s(),m(re,{key:0,size:"small",type:"info"},{default:e(()=>[r(i(l(d)("setting.mod.add.table.downloadedReady.notUGC")),1)]),_:1})):(s(),m(re,{key:1,size:"small",type:"warning"},{default:e(()=>[r(i(l(d)("setting.mod.add.table.downloadedReady.notReady")),1)]),_:1}))],64))]),_:1},8,["label"]),t(U,{label:l(d)("setting.mod.add.table.action")},{default:e(o=>[t(Me,{trigger:"click",onCommand:be},{dropdown:e(()=>[t(Se,null,{default:e(()=>[t(S,{disabled:N.value,command:{cmd:"enable",row:o.row}},{default:e(()=>[r(i(l(d)("setting.mod.add.table.enable")),1)]),_:2},1032,["disabled","command"]),t(S,{disabled:N.value,command:{cmd:"update",row:o.row}},{default:e(()=>[r(i(l(d)("setting.mod.add.table.update")),1)]),_:2},1032,["disabled","command"]),t(S,{disabled:N.value,command:{cmd:"delete",row:o.row}},{default:e(()=>[r(i(l(d)("setting.mod.add.table.delete")),1)]),_:2},1032,["disabled","command"])]),_:2},1024)]),default:e(()=>[t(h,{disabled:N.value,loading:z.value,link:"",type:"primary"},{default:e(()=>[r(i(l(d)("setting.mod.add.table.action"))+" ",1),t(se,{class:"el-icon--right"},{default:e(()=>[t(De)]),_:1})]),_:1},8,["disabled","loading"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})),[[Q,Y.value]])]),_:1})]),_:1})]),_:1},8,["label"]),te.value!=="darwin"?(s(),m(de,{key:0,label:l(d)("setting.mod.tab.setting"),name:"Setting"},{default:e(()=>[t(Fe,{gutter:10},{default:e(()=>[t(ue,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[W((s(),m(K,{style:V(l(b)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[t(ne,{"max-height":l(b)?"45vh":"65vh"},{default:e(()=>[y.value?(s(!0),g(L,{key:0},Z(y.value,(o,D)=>(s(),g(L,null,[o.id===1?(s(),g("div",kt,[p("div",null,[t(Ue,{src:l(Ke),fit:"fill",style:{width:"75px",height:"75px"},onClick:O=>A(o.id,o.file_url)},null,8,["src","onClick"])]),p("div",Ct,[t(h,{link:"",type:"primary",onClick:O=>A(o.id,o.file_url)},{default:e(()=>[r(i(l(d)("setting.mod.setting.right.clientModsDisabled")),1)]),_:2},1032,["onClick"]),p("div",null,[o.enable?(s(),m(I,{key:0,type:"success"},{default:e(()=>[r(i(l(d)("setting.mod.setting.left.enable")),1)]),_:1})):k("",!0),o.enable?k("",!0):(s(),m(I,{key:1,type:"info"},{default:e(()=>[r(i(l(d)("setting.mod.setting.left.disable")),1)]),_:1}))])])])):(s(),g("div",xt,[p("div",null,[t(Ue,{src:o.preview_url,fit:"fill",style:{width:"75px",height:"75px"},onClick:O=>A(o.id,o.file_url)},null,8,["src","onClick"])]),p("div",Dt,[t(h,{link:"",type:"primary",onClick:O=>A(o.id,o.file_url)},{default:e(()=>[r(i(o.name),1)]),_:2},1032,["onClick"]),p("div",null,[o.enable?(s(),m(I,{key:0,type:"success"},{default:e(()=>[r(i(l(d)("setting.mod.setting.left.enable")),1)]),_:1})):k("",!0),o.enable?k("",!0):(s(),m(I,{key:1,type:"info"},{default:e(()=>[r(i(l(d)("setting.mod.setting.left.disable")),1)]),_:1}))])])])),D!==y.value.length-1?(s(),m(Xe,{key:2})):k("",!0)],64))),256)):(s(),g("div",{key:1,style:V(l(b)?"height: 50vh":"height: 70vh"),class:"fcc"},[t(ce,{title:l(d)("setting.mod.setting.left.result"),icon:"warning"},null,8,["title"])],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[Q,J.value]])]),_:1}),t(ue,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[W((s(),m(K,{style:V(l(b)?"height: 50vh; margin: 10px 0 30px 0":"height: 70vh"),shadow:"never"},{header:e(()=>[p("div",St,[p("span",null,i(l(d)("setting.mod.setting.right.header.title")),1),p("div",null,[t(h,{disabled:v.value<2,loading:ae.value,type:"primary",onClick:He},{default:e(()=>[r(i(l(d)("setting.mod.setting.right.header.update")),1)]),_:1},8,["disabled","loading"]),t(h,{disabled:v.value===0,loading:B.value,type:"danger",onClick:Pe},{default:e(()=>[r(i(l(d)("setting.mod.setting.right.header.disable")),1)]),_:1},8,["disabled","loading"])])])]),default:e(()=>[v.value>1?(s(),m(ne,{key:0,"max-height":l(b)?"37vh":"57vh"},{default:e(()=>[P.value.configOptions?(s(),m(xe,{key:0,ref:"modSettingFormRef","label-position":l(b)?"top":"left","label-width":l(b)?"70":"auto",size:l(b)?"small":"large"},{default:e(()=>[t(H,{label:"ID"},{default:e(()=>[t(I,null,{default:e(()=>[r(i(P.value.id),1)]),_:1})]),_:1}),t(H,{label:l(d)("setting.mod.setting.right.name")},{default:e(()=>[t(I,{type:"info"},{default:e(()=>[r(i(y.value[y.value.findIndex(o=>o.id===v.value)].name),1)]),_:1})]),_:1},8,["label"]),(s(!0),g(L,null,Z(P.value.configOptions,o=>(s(),m(ie,{content:o.hover,"show-after":500,effect:"light",placement:"top"},{default:e(()=>[t(H,{label:o.label},{default:e(()=>[t(F,{modelValue:y.value[y.value.findIndex(D=>D.id===v.value)].configurationOptions[o.name],"onUpdate:modelValue":D=>y.value[y.value.findIndex(O=>O.id===v.value)].configurationOptions[o.name]=D,onChange:Re},{default:e(()=>[(s(!0),g(L,null,Z(o.options,D=>(s(),m(f,{label:D.description,value:D.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["label-position","label-width","size"])):(s(),g("div",{key:1,style:V(l(b)?"height: 40vh; margin-top: 10px":"height: 60vh"),class:"fcc"},[t(ce,{title:l(d)("setting.mod.setting.right.result"),icon:"info"},null,8,["title"])],4))]),_:1},8,["max-height"])):k("",!0),v.value===1?(s(),g("div",Mt,[ge.value==="zh"?(s(),g("div",zt,"如果启用此配置，则会禁用玩家的本地模组")):(s(),g("div",Ft,"If enable this configuration option, the game server will Disable player's client mods"))])):k("",!0),v.value===0?(s(),g("div",{key:2,style:V(l(b)?"height: 40vh; margin-top: 10px":"height: 60vh"),class:"fcc"},[t(ce,{title:l(d)("setting.mod.setting.right.result2"),icon:"info"},null,8,["title"])],4)):k("",!0)]),_:1},8,["style"])),[[Q,R.value]])]),_:1})]),_:1})]),_:1},8,["label"])):k("",!0)]),_:1},8,["modelValue"])])}}},Rt=et(Ut,[["__scopeId","data-v-2dad3021"]]);export{Rt as default};
