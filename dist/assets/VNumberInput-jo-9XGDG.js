import{V as J,m as ce}from"./VTextField-rNVqoHjK.js";import{aT as de,I as ve,J as me,h as fe,j as V,a4 as X,a0 as pe,ap as ge,aF as z,aU as be,a2 as k,W as Y,f as we,K as Ne,k as N,a as g,F as R,C as he,s as Z,aj as Q,aL as xe,aq as Pe,aG as A,aV as Ve,aW as De}from"./index-Bnu2ge-9.js";import{u as Ie}from"./VInput-dFZ5Mk8T.js";import{V as B}from"./VDivider-BK7OigPp.js";const Fe=50,Se=500;function ye(n){let{toggleUpDown:L}=n,u=-1,w=-1;de(d);function S(i){d(),D(i),window.addEventListener("pointerup",d),document.addEventListener("blur",d),u=window.setTimeout(()=>{w=window.setInterval(()=>D(i),Fe)},Se)}function d(){window.clearTimeout(u),window.clearInterval(w),window.removeEventListener("pointerup",d),document.removeEventListener("blur",d)}function D(i){L(i==="up")}return{holdStart:S,holdStop:d}}const Ee=me({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:n=>!n||n.length===1},...Pe(ce(),["modelValue","validationValue"])},"VNumberInput"),Ae=ve()({name:"VNumberInput",props:{...Ee()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,L){let{slots:u}=L;const w=fe(),{holdStart:S,holdStop:d}=ye({toggleUpDown:U}),D=Ie(n),i=V(()=>D.isDisabled.value||D.isReadonly.value),y=X(n.focused),{decimalSeparator:ee}=pe(),o=V(()=>n.decimalSeparator?.[0]||ee.value);function h(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const v=t==null?String(e):e.toFixed(t);if(y.value&&c)return Number(v).toString().replace(".",o.value);if(n.minFractionDigits===null||t!==null&&t<n.minFractionDigits)return v.replace(".",o.value);let[P,s]=v.split(".");return s=(s??"").padEnd(n.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${n.minFractionDigits}})0+$`,"g"),""),[P,s].filter(Boolean).join(o.value)}const a=ge(n,"modelValue",null,e=>e??null,e=>e==null?e??null:z(Number(e),n.min,n.max)),x=X(null);be(()=>{y.value&&!i.value&&Number(x.value?.replace(o.value,"."))===a.value||(a.value==null?x.value=null:isNaN(a.value)||(x.value=h(a.value)))});const l=V({get:()=>x.value,set(e){if(e===null||e===""){a.value=null,x.value=null;return}const t=Number(e.replace(o.value,"."));!isNaN(t)&&t<=n.max&&t>=n.min&&(a.value=t,x.value=e)}}),M=V(()=>i.value?!1:(a.value??0)+n.step<=n.max),$=V(()=>i.value?!1:(a.value??0)-n.step>=n.min),r=V(()=>n.hideInput?"stacked":n.controlVariant),H=k(()=>r.value==="split"?"$plus":"$collapse"),K=k(()=>r.value==="split"?"$minus":"$expand"),E=k(()=>r.value==="split"?"default":"small"),C=k(()=>r.value==="stacked"?"auto":"100%"),ne={props:{onClick:T,onPointerup:b,onPointerdown:G,onPointercancel:b}},te={props:{onClick:T,onPointerup:b,onPointerdown:O,onPointercancel:b}};Y(()=>n.precision,()=>W()),Y(()=>n.minFractionDigits,()=>W()),we(()=>{_()});function j(e){if(e==null)return 0;const t=e.toString(),c=t.indexOf(".");return~c?t.length-c:0}function U(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i.value)return;if(a.value==null){l.value=h(z(0,n.min,n.max));return}let t=Math.max(j(a.value),j(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?M.value&&(l.value=h(a.value+n.step,t)):$.value&&(l.value=h(a.value-n.step,t))}function ae(e){if(!e.data)return;const t=e.target,{value:c,selectionStart:v,selectionEnd:P}=t??{},s=c?c.slice(0,v)+e.data+c.slice(P):e.data,m=Ve(s,n.precision,o.value);if(new RegExp(`^-?\\d*${De(o.value)}?\\d*$`).test(s)||(e.preventDefault(),t.value=m,A(()=>l.value=m)),n.precision!=null){if(s.split(o.value)[1]?.length>n.precision){e.preventDefault(),t.value=m,A(()=>l.value=m);const I=(v??0)+e.data.length;t.setSelectionRange(I,I)}n.precision===0&&s.endsWith(o.value)&&(e.preventDefault(),t.value=m,A(()=>l.value=m))}}async function le(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),_(),await A(),e.key==="ArrowDown"?U(!1):U())}function T(e){e.stopPropagation()}function b(e){e.currentTarget?.releasePointerCapture(e.pointerId),e.preventDefault(),d()}function G(e){e.currentTarget?.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),S("up")}function O(e){e.currentTarget?.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),S("down")}function _(){if(i.value||!w.value)return;const e=w.value.value,t=Number(e.replace(o.value,"."));e&&!isNaN(t)?l.value=h(z(t,n.min,n.max)):l.value=null}function W(){i.value||(l.value=a.value!==null&&!isNaN(a.value)?h(a.value,n.precision,!1):null)}function ue(){if(!i.value){if(a.value===null||isNaN(a.value)){l.value=null;return}l.value=a.value.toString().replace(".",o.value)}}function ie(){ue()}function re(){_()}return Ne(()=>{const{modelValue:e,type:t,...c}=J.filterProps(n);function v(){return u.increment?g(Q,{key:"increment-defaults",defaults:{VBtn:{disabled:!M.value,height:C.value,size:E.value,icon:H.value,variant:"text"}}},{default:()=>[u.increment(ne)]}):g(Z,{"aria-hidden":"true","data-testid":"increment",disabled:!M.value,height:C.value,icon:H.value,key:"increment-btn",onClick:T,onPointerdown:G,onPointerup:b,onPointercancel:b,size:E.value,variant:"text",tabindex:"-1"},null)}function P(){return u.decrement?g(Q,{key:"decrement-defaults",defaults:{VBtn:{disabled:!$.value,height:C.value,size:E.value,icon:K.value,variant:"text"}}},{default:()=>[u.decrement(te)]}):g(Z,{"aria-hidden":"true","data-testid":"decrement",disabled:!$.value,height:C.value,icon:K.value,key:"decrement-btn",onClick:T,onPointerdown:O,onPointerup:b,onPointercancel:b,size:E.value,variant:"text",tabindex:"-1"},null)}function s(){return N("div",{class:"v-number-input__control"},[P(),g(B,{vertical:r.value!=="stacked"},null),v()])}function m(){return!n.hideInput&&!n.inset?g(B,{vertical:!0},null):void 0}const I=r.value==="split"?N("div",{class:"v-number-input__control"},[g(B,{vertical:!0},null),v()]):n.reverse||r.value==="hidden"?void 0:N(R,null,[m(),s()]),oe=u["append-inner"]||I,q=r.value==="split"?N("div",{class:"v-number-input__control"},[P(),g(B,{vertical:!0},null)]):n.reverse&&r.value!=="hidden"?N(R,null,[s(),m()]):void 0,se=u["prepend-inner"]||q;return g(J,he({ref:w},c,{modelValue:l.value,"onUpdate:modelValue":f=>l.value=f,focused:y.value,"onUpdate:focused":f=>y.value=f,validationValue:a.value,onBeforeinput:ae,onFocus:ie,onBlur:re,onKeydown:le,class:["v-number-input",{"v-number-input--default":r.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":r.value==="split","v-number-input--stacked":r.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...u,"append-inner":oe?function(){for(var f=arguments.length,F=new Array(f),p=0;p<f;p++)F[p]=arguments[p];return N(R,null,[u["append-inner"]?.(...F),I])}:void 0,"prepend-inner":se?function(){for(var f=arguments.length,F=new Array(f),p=0;p<f;p++)F[p]=arguments[p];return N(R,null,[q,u["prepend-inner"]?.(...F)])}:void 0})}),xe({},w)}});export{Ae as V};
