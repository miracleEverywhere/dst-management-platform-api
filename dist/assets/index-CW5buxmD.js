import{o as ie,g as de,c as me,b as ce,u as pe,r as V,R as z,K as r,f as m,i as I,k as l,l as e,m as p,t as u,j as o,q as c,n as f,v as g,F as _e,y as fe,a1 as ve,ah as R,X as S,B,E as be,C as ge}from"./index-5FXYdO3K.js";import{S as he}from"./index-D-7nx8cJ.js";const ye={class:"page-div"},we={class:"card-header"},xe={class:"tip"},Ce={style:{"margin-top":"5px"}},Ve={style:{"margin-top":"5px"}},Pe={class:"tip"},ke={style:{display:"flex","align-items":"center"}},Ue={class:"el-form-item-msg"},ze={style:{display:"flex","justify-content":"flex-end","padding-top":"10px"}},De=ve({name:"Users"}),Se=Object.assign(De,{setup(We){ie(()=>{P()});const q=de(),d=me(()=>q.language),j=ce(),{t:s}=pe(),D=j.userInfo,E=V([]),P=()=>{z.userList.get().then(i=>{E.value=i.data})},O=i=>{if(i.type==="update"){$(R(i.data));return}i.type==="delete"&&H(R(i.data))},h=V(),a=V({username:"",nickname:"",password:"",disabled:!1,role:"Non-admin",clusterPermission:null,clusterCreationProhibited:!1,maxWorldsPerCluster:2}),Y={username:[{required:!0,message:s("users.formValidateMsg.username")}],nickname:[{required:!0,message:s("users.formValidateMsg.nickname")}],password:[{required:!0,message:s("users.formValidateMsg.password")}],disabled:[{required:!0,message:s("users.formValidateMsg.disabled")}],maxWorldsPerCluster:[{required:!0,message:s("users.formValidateMsg.maxWorldsPerCluster")}]},w=V(!1),x=V(!1),C=V(!1),A=()=>{h.value&&h.value.clearValidate(),C.value=!0,w.value=!0},Q=()=>{h.value.validate(i=>{if(i){x.value=!0;const n={username:a.value.username,nickname:a.value.nickname,password:S(a.value.password),disabled:a.value.disabled,role:a.value.role,clusterPermission:a.value.clusterPermission,clusterCreationProhibited:a.value.clusterCreationProhibited,maxWorldsPerCluster:a.value.maxWorldsPerCluster};z.user.post(n).then(_=>{w.value=!1,B(_.message),P()}).finally(()=>{x.value=!1})}})},$=i=>{a.value=i,C.value=!1,w.value=!0},G=()=>{h.value.validate(i=>{if(i){x.value=!0;const n={username:a.value.username,nickname:a.value.nickname,password:S("nicai"),disabled:a.value.disabled,role:a.value.role,clusterPermission:a.value.clusterPermission,clusterCreationProhibited:a.value.clusterCreationProhibited,maxWorldsPerCluster:a.value.maxWorldsPerCluster};z.user.put(n).then(_=>{w.value=!1,h.value&&h.value.resetFields(),B(_.message),P()}).finally(()=>{x.value=!1})}})},H=i=>{be.confirm(d.value==="zh"?"将执行 删除 操作，是否继续？":"The DELETE operation will be performed. Do you want to continue?",d.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:d.value==="zh"?"确定":"confirm",cancelButtonText:d.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(n,_,k)=>{if(n==="confirm"){_.confirmButtonLoading=!0;const W={username:i.username,nickname:i.nickname,password:S("nicai"),disabled:i.disabled};z.user.delete(W).then(v=>{B(v.message),P(),k()}).finally(()=>{_.confirmButtonLoading=!1})}else k()}}).then(()=>{}).catch(()=>{ge(s("home.canceled"))})},K=()=>{a.value={username:"",nickname:"",password:"",disabled:!1,role:"Non-admin",clusterPermission:null,clusterCreationProhibited:!1}};return(i,n)=>{const _=r("el-button"),k=r("el-collapse-item"),W=r("el-collapse"),v=r("el-table-column"),y=r("el-tag"),X=r("QuestionFilled"),L=r("el-icon"),J=r("el-tooltip"),Z=r("arrow-down"),M=r("el-dropdown-item"),ee=r("el-dropdown-menu"),le=r("el-dropdown"),ae=r("el-table"),te=r("el-card"),U=r("el-col"),T=r("el-row"),F=r("el-input"),b=r("el-form-item"),se=r("el-option"),oe=r("el-select"),ne=r("el-slider"),N=r("el-switch"),re=r("el-form"),ue=r("el-dialog");return m(),I("div",ye,[l(T,{gutter:10},{default:e(()=>[l(U,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(te,{shadow:"never",style:{"min-height":"70vh"}},{header:e(()=>[p("div",we,[p("span",null,u(o(s)("users.accountTitle")),1),l(_,{disabled:o(D).role!=="admin",type:"success",onClick:A},{default:e(()=>[c(u(o(s)("users.actions.create")),1)]),_:1},8,["disabled"])])]),default:e(()=>[l(W,null,{default:e(()=>[l(k,{title:"Tips"},{default:e(()=>[p("div",xe,[p("div",null,u(o(s)("users.tip_1")),1),p("div",Ce,u(o(s)("users.tip_2")),1),p("div",Ve,u(o(s)("users.tip_3")),1)]),p("div",Pe,[p("div",null,u(o(s)("users.tip_4")),1)])]),_:1})]),_:1}),l(ae,{data:E.value,border:"",style:{"margin-top":"10px"}},{default:e(()=>[l(v,{label:o(s)("users.username"),prop:"username"},null,8,["label"]),l(v,{label:o(s)("users.nickname"),prop:"nickname"},null,8,["label"]),l(v,{label:o(s)("users.role"),prop:"role"},{default:e(t=>[l(y,{type:t.row.role==="admin"?"primary":"info"},{default:e(()=>[c(u(t.row.role),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(v,{label:o(s)("users.disabled")},{default:e(t=>[t.row.disabled?g("",!0):(m(),f(y,{key:0,type:"success"},{default:e(()=>[c(u(d.value==="zh"?"启用":"Enabled"),1)]),_:1})),t.row.disabled?(m(),f(y,{key:1,type:"danger"},{default:e(()=>[c(u(d.value==="zh"?"禁用":"Disabled"),1)]),_:1})):g("",!0)]),_:1},8,["label"]),l(v,{label:o(s)("users.clusterCreationProhibited")},{default:e(t=>[t.row.clusterCreationProhibited?g("",!0):(m(),f(y,{key:0,type:"success"},{default:e(()=>[c(u(d.value==="zh"?"可创建":"Y"),1)]),_:1})),t.row.clusterCreationProhibited?(m(),f(y,{key:1,type:"danger"},{default:e(()=>[c(u(d.value==="zh"?"不可创建":"N"),1)]),_:1})):g("",!0)]),_:1},8,["label"]),l(v,null,{header:e(()=>[p("div",ke,[p("span",null,u(o(s)("users.maxWorldsPerCluster")),1),l(J,{content:o(s)("users.maxWorldsPerClusterTip"),effect:"light",placement:"top"},{default:e(()=>[l(L,{size:"14",style:{"margin-left":"2px"}},{default:e(()=>[l(X)]),_:1})]),_:1},8,["content"])])]),default:e(t=>[t.row.role==="admin"?(m(),f(y,{key:0,type:"primary"},{default:e(()=>[c(u(d.value==="zh"?"不限制":"No Limits"),1)]),_:1})):(m(),f(y,{key:1,type:"primary"},{default:e(()=>[c(u(t.row.maxWorldsPerCluster),1)]),_:2},1024))]),_:1}),l(v,{label:o(s)("setting.button.actions"),prop:"actions"},{default:e(t=>[l(le,{disabled:o(D).role!=="admin",trigger:"hover",onCommand:O},{dropdown:e(()=>[l(ee,null,{default:e(()=>[l(M,{command:{type:"update",data:t.row}},{default:e(()=>[c(u(o(s)("users.actions.update")),1)]),_:2},1032,["command"]),l(M,{command:{type:"delete",data:t.row},disabled:t.row.role==="admin"},{default:e(()=>[c(u(o(s)("users.actions.delete")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[l(_,{disabled:o(D).role!=="admin",link:"",type:"primary"},{default:e(()=>[c(u(o(s)("setting.button.actions"))+" ",1),l(L,{class:"el-icon--right"},{default:e(()=>[l(Z)]),_:1})]),_:1},8,["disabled"])]),_:2},1032,["disabled"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})]),_:1})]),_:1}),l(ue,{modelValue:w.value,"onUpdate:modelValue":n[9]||(n[9]=t=>w.value=t),width:"60%",onClosed:K},{default:e(()=>[l(re,{ref_key:"userDialogFormRef",ref:h,model:a.value,rules:Y,"validate-on-rule-change":!1,"label-width":"150",style:{margin:"20px 50px 0 0"}},{default:e(()=>[C.value?(m(),f(b,{key:0,label:o(s)("users.username"),prop:"username"},{default:e(()=>[l(F,{modelValue:a.value.username,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value.username=t)},null,8,["modelValue"])]),_:1},8,["label"])):g("",!0),l(b,{label:o(s)("users.nickname"),prop:"nickname"},{default:e(()=>[l(F,{modelValue:a.value.nickname,"onUpdate:modelValue":n[1]||(n[1]=t=>a.value.nickname=t)},null,8,["modelValue"])]),_:1},8,["label"]),C.value?(m(),f(b,{key:1,label:o(s)("users.password"),prop:"password"},{default:e(()=>[l(F,{modelValue:a.value.password,"onUpdate:modelValue":n[2]||(n[2]=t=>a.value.password=t),autocomplete:"new-password","show-password":""},null,8,["modelValue"]),l(he,{modelValue:a.value.password,"onUpdate:modelValue":n[3]||(n[3]=t=>a.value.password=t)},null,8,["modelValue"]),p("div",Ue,u(o(s)("users.suggestedPassword")),1)]),_:1},8,["label"])):g("",!0),l(b,{label:o(s)("users.clusterPermission"),prop:"clusterPermission"},{default:e(()=>[l(oe,{modelValue:a.value.clusterPermission,"onUpdate:modelValue":n[4]||(n[4]=t=>a.value.clusterPermission=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,disabled:a.value.role==="admin"},{default:e(()=>[(m(!0),I(_e,null,fe(o(q).dstClusters,t=>(m(),f(se,{label:t.clusterDisplayName,value:t.clusterName},null,8,["label","value"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),l(b,{label:o(s)("users.maxWorldsPerCluster"),prop:"maxWorldsPerCluster"},{default:e(()=>[l(ne,{modelValue:a.value.maxWorldsPerCluster,"onUpdate:modelValue":n[5]||(n[5]=t=>a.value.maxWorldsPerCluster=t),max:64,min:0,"show-input":"",size:"small"},null,8,["modelValue"])]),_:1},8,["label"]),l(T,null,{default:e(()=>[l(U,{span:8},{default:e(()=>[l(b,{label:o(s)("users.disabled"),prop:"disabled"},{default:e(()=>[l(N,{modelValue:a.value.disabled,"onUpdate:modelValue":n[6]||(n[6]=t=>a.value.disabled=t),"active-text":d.value==="zh"?"启用":"Enable","active-value":!1,"inactive-text":d.value==="zh"?"禁用":"Disable","inactive-value":!0,"inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),l(U,{span:8},{default:e(()=>[l(b,{label:o(s)("users.admin"),prop:"role"},{default:e(()=>[l(N,{modelValue:a.value.role,"onUpdate:modelValue":n[7]||(n[7]=t=>a.value.role=t),"active-text":d.value==="zh"?"是":"Enable","inactive-text":d.value==="zh"?"否":"Disable","active-value":"admin","inactive-value":"Non-admin","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),l(U,{span:8},{default:e(()=>[l(b,{label:o(s)("users.clusterCreationProhibited"),prop:"role"},{default:e(()=>[l(N,{modelValue:a.value.clusterCreationProhibited,"onUpdate:modelValue":n[8]||(n[8]=t=>a.value.clusterCreationProhibited=t),"active-text":d.value==="zh"?"可创建":"Y","active-value":!1,"inactive-text":d.value==="zh"?"不可创建":"Y","inactive-value":!0,"inline-prompt":"",disabled:a.value.role==="admin",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","active-text","inactive-text","disabled"])]),_:1},8,["label"])]),_:1})]),_:1}),p("div",ze,[C.value?(m(),f(_,{key:0,loading:x.value,type:"primary",onClick:Q},{default:e(()=>[c(u(o(s)("users.submit")),1)]),_:1},8,["loading"])):g("",!0),C.value?g("",!0):(m(),f(_,{key:1,loading:x.value,type:"primary",onClick:G},{default:e(()=>[c(u(o(s)("users.submit")),1)]),_:1},8,["loading"]))])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Se as default};
