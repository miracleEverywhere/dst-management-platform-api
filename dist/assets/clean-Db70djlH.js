import{u as H,a as J,g as $,D as O,G as Q,d as X,H as Y,c as L,o as Z,r as i,w as ee,I as N,J as o,K as le,f as k,i as R,l as a,m as e,z as ae,j as n,n as x,p as c,t as r,F as te,x as se,s as oe,q as ne,C as ce,A as re}from"./index-DtBQZkmr.js";import{l as B}from"./index-CqGaolN4.js";import{f as ue}from"./tools-BzPVPLnk.js";const ie={class:"page-div"},de={class:"card-header"},me={class:"fcc"},he={__name:"clean",setup(ge){const{t:u}=H(),{isMobile:F}=J(),d=$(),g=O();Q();const z=X(),A=Y("refresh");L(()=>d.isDark);const w=L(()=>d.language);Z(()=>{f()});const S=i([]),_=i(!1),f=()=>{_.value=!0;const s={clusterName:d.selectedDstCluster};B.clean.status.get(s).then(t=>{S.value=t.data}).finally(()=>{_.value=!1})},p=["World","Chat","Access","Runtime"],m=i([]),I=s=>{const t=s.length;h.value=t===p.length,v.value=t>0&&t<p.length},h=i(!1),v=i(!1),K=s=>{m.value=s?p:[],v.value=!1},M={World:{zh:"世界日志",en:"World"},Chat:{zh:"聊天日志",en:"Chat"},Access:{zh:"请求日志",en:"Access"},Runtime:{zh:"运行日志",en:"Runtime"}},b=i(!1),T=()=>{if(m.value.length===0){ce(w.value==="zh"?"请至少选择一种日志":"Please select at least one type of log");return}b.value=!0;const s={clusterName:d.selectedDstCluster,logTypes:m.value};B.clean.clean.post(s).then(t=>{re(t.message)}).finally(()=>{b.value=!1,f()})},q=()=>{setTimeout(()=>{g.meta.isKeepAlive&&z.removeKeepAliveName(g.name),A(!1),N(()=>{g.meta.isKeepAlive&&z.addKeepAliveName(g.name),A(!0)})},0)};return ee(()=>d.selectedDstCluster,s=>{s&&N(()=>{q()})},{immediate:!1}),(s,t)=>{const V=o("el-checkbox"),D=o("el-button"),W=o("el-checkbox-group"),y=o("el-tag"),C=o("el-table-column"),j=o("el-table"),E=o("el-card"),G=o("el-col"),P=o("el-row"),U=le("loading");return k(),R("div",ie,[a(P,{gutter:10},{default:e(()=>[a(G,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[a(E,{style:ae(n(F)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[x("div",de,[c(r(n(u)("logs.clean.title"))+" ",1),x("div",me,[a(V,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=l=>h.value=l),indeterminate:v.value,size:"large",style:{"margin-right":"10px"},onChange:K},{default:e(()=>[c(r(n(u)("logs.clean.selectAll")),1)]),_:1},8,["modelValue","indeterminate"]),a(D,{onClick:f},{default:e(()=>[c(r(n(u)("logs.clean.refresh")),1)]),_:1}),a(D,{loading:b.value,type:"danger",onClick:T},{default:e(()=>[c(r(n(u)("logs.clean.button")),1)]),_:1},8,["loading"])])])]),default:e(()=>[x("div",null,[a(W,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=l=>m.value=l),onChange:I},{default:e(()=>[(k(),R(te,null,se(p,l=>a(V,{key:l,label:l,value:l},{default:e(()=>[c(r(M[l][w.value==="zh"?"zh":"en"]),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"]),oe((k(),ne(j,{ref:"tableRef",data:S.value,border:"",style:{"margin-top":"20px"}},{default:e(()=>[a(C,{label:n(u)("logs.clean.type"),prop:"name"},{default:e(l=>[a(y,{type:"primary"},{default:e(()=>[c(r(l.row.name),1)]),_:2},1024)]),_:1},8,["label"]),a(C,{label:n(u)("logs.clean.size"),prop:"size"},{default:e(l=>[a(y,{type:"success"},{default:e(()=>[c(r(n(ue)(l.row.size)),1)]),_:2},1024)]),_:1},8,["label"]),a(C,{label:n(u)("logs.clean.num"),prop:"num"},{default:e(l=>[a(y,{type:"info"},{default:e(()=>[c(r(l.row.num),1)]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[U,_.value]])])]),_:1},8,["style"])]),_:1})]),_:1})])}}};export{he as default};
