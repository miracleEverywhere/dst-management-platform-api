import{u as $e,a as Ie,g as Pe,G as Be,H as Fe,d as Ue,I as Re,c as pe,o as Ke,a2 as V,B as N,r as g,w as Se,J as Y,K as f,L as Te,f as u,i as $,k as a,l as e,j as s,m as p,q as d,t as i,n as m,F as Z,y as ee,x as te,ac as Ae,p as me,a8 as qe,a1 as Me,D as ge}from"./index-BSCyfger.js";const Ee={class:"page-div"},je={class:"card-header"},He={key:0},Ge={key:1},We={class:"card-header"},Je={style:{"margin-top":"20px"}},Oe={class:"card-header"},Qe={style:{"margin-top":"20px"}},Xe={class:"card-header"},Ye={style:{"margin-top":"20px"}},Ze={class:"card-header"},et={class:"fcc"},tt={class:"el-upload__text"},lt={class:"el-upload__tip"},at=Me({name:"settingsPlayer"}),ot=Object.assign(at,{setup(st){const{t:o}=$e(),{isMobile:_e}=Ie(),b=Pe(),B=Be();Fe();const le=Ue(),ae=Re("refresh"),L=pe(()=>b.isDark),k=pe(()=>b.language);Ke(()=>{w()});const w=(n=!1)=>{V.player.list.get({clusterName:b.selectedDstCluster}).then(l=>{var c,r,v;if(q.value=l.data.players,M.value=l.data.uidMap,F.value=[],(((c=l.data.adminList)==null?void 0:c.length)||0)>0)for(let _ of l.data.adminList)_!==""&&F.value.push(_);if(U.value=[],(((r=l.data.blockList)==null?void 0:r.length)||0)>0)for(let _ of l.data.blockList)_!==""&&U.value.push(_);if(R.value=[],(((v=l.data.whiteList)==null?void 0:v.length)||0)>0)for(let _ of l.data.whiteList)_!==""&&R.value.push(_);if(n){let _;k.value==="zh"?_="刷新成功":_="Refresh Success",N(_)}})},se=g("players"),q=g([]),M=g({}),F=g([]),U=g([]),R=g([]),E=n=>{for(let l of F.value)if(l===n)return!0},ne=n=>{for(let l of U.value)if(l===n)return!0},oe=n=>{for(let l of R.value)if(l===n)return!0},ie=n=>{switch(n.type){case"admin":C(n.type,"add",n.uid);break;case"block":C(n.type,"add",n.uid);break;case"white":C(n.type,"add",n.uid);break;case"kick":K(n.type,n.uid);break;case"kill":K(n.type,n.uid);break;case"respawn":K(n.type,n.uid);break;case"despawn":K(n.type,n.uid);break}},C=(n,l,c)=>{const r={clusterName:b.selectedDstCluster,listName:n,type:l,uid:c};V.player.change.post(r).then(v=>{N(v.message),w()})},K=(n,l)=>{const c={clusterName:b.selectedDstCluster,uid:l,type:n};V.player.action.post(c).then(r=>{N(r.message)})},j=n=>n in M.value?" ["+M.value[n]+"]":k.value==="zh"?" [暂未获取到]":" [Not yet obtained]",ve=(n,l)=>{D.value=!1,h.value="",n.paneName==="history"&&W()},H=g([]),G=g(!1),W=(n=!1)=>{G.value=!0,H.value=[];const l={clusterName:b.selectedDstCluster};V.player.history.get(l).then(c=>{for(let r of c.data)r.uid.length===11&&H.value.push(r);if(n){let r;k.value==="zh"?r="刷新成功":r="Refresh Success",N(r)}}).finally(()=>{G.value=!1})},J=g(),S=g(!1),x=g(!1),he=()=>{J.value&&J.value.clearFiles(),S.value=!0,x.value=!1},ye=n=>/\.xls|xlsx$/i.test(n.name)?!0:(ge(k.value==="zh"?"请上传Excel文件":"Please upload a Excel file"),!1),be=n=>{x.value=!0;const l=new FormData;l.append("file",n.file),V.player.addBlockUpload.post(l).then(c=>{w(),N(c.message)}).finally(()=>{S.value=!1,x.value=!1})},ke=()=>{setTimeout(()=>{B.meta.isKeepAlive&&le.removeKeepAliveName(B.name),ae(!1),Y(()=>{B.meta.isKeepAlive&&le.addKeepAliveName(B.name),ae(!0)})},0)},D=g(!1),T=g(),h=g(""),O=()=>{D.value=!0,Y(()=>{T.value.input.focus()})},z=n=>{if(h.value){if(!/^KU_/.test(h.value)){ge(k.value==="zh"?"请输入正确的玩家UID":"Please enter the correct player UID");return}C(n,"add",h.value)}D.value=!1,h.value=""};g(!1),g("");const we=()=>{const n={clusterName:b.selectedDstCluster};V.player.historyClean.post(n).then(l=>{N(l.message)}).finally(()=>{W(!1)})};return Se(()=>b.selectedDstCluster,n=>{n&&Y(()=>{ke()})},{immediate:!1}),(n,l)=>{const c=f("el-button"),r=f("el-table-column"),v=f("el-tag"),_=f("arrow-down"),A=f("el-icon"),y=f("el-dropdown-item"),de=f("el-dropdown-menu"),ue=f("el-dropdown"),re=f("el-table"),Ce=f("el-result"),I=f("el-card"),P=f("el-tab-pane"),Q=f("el-alert"),X=f("el-input"),xe=f("el-tooltip"),Le=f("el-tabs"),De=f("el-col"),ze=f("el-row"),Ve=f("el-upload"),Ne=f("el-dialog"),ce=Te("loading");return u(),$("div",Ee,[a(ze,{gutter:10},{default:e(()=>[a(De,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[a(Le,{modelValue:se.value,"onUpdate:modelValue":l[14]||(l[14]=t=>se.value=t),onTabClick:ve},{default:e(()=>[a(P,{label:s(o)("setting.players"),name:"players"},{default:e(()=>[a(I,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[p("div",je,[d(i(s(o)("setting.players"))+" ",1),p("div",null,[a(c,{size:"default",onClick:l[0]||(l[0]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[q.value?(u(),m(re,{key:0,data:q.value,border:"",size:"small",style:{width:"100%"}},{default:e(()=>[a(r,{label:s(o)("setting.nickName"),prop:"nickName"},null,8,["label"]),a(r,{label:s(o)("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab===""?(u(),$("span",He,i(s(o)("setting.roleFail")),1)):(u(),$("span",Ge,i(t.row.prefab),1))]),_:1},8,["label"]),a(r,{label:s(o)("setting.age"),prop:"age"},{default:e(t=>[t.row.age?(u(),m(v,{key:0,type:"success"},{default:e(()=>[d(i(t.row.age),1)]),_:2},1024)):(u(),m(v,{key:1,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(r,{label:"UID",prop:"uid"}),a(r,{label:s(o)("setting.button.actions"),prop:"actions"},{default:e(t=>[a(ue,{trigger:"hover",onCommand:ie},{dropdown:e(()=>[a(de,null,{default:e(()=>[a(y,{command:{type:"admin",uid:t.row.uid},disabled:E(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(y,{command:{type:"block",uid:t.row.uid},disabled:ne(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(y,{command:{type:"white",uid:t.row.uid},disabled:oe(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),a(y,{command:{type:"kick",uid:t.row.uid},disabled:E(t.row.uid),divided:""},{default:e(()=>[d(i(s(o)("setting.kick")),1)]),_:2},1032,["command","disabled"]),a(y,{command:{type:"kill",uid:t.row.uid}},{default:e(()=>[d(i(s(o)("setting.kill")),1)]),_:2},1032,["command"]),a(y,{command:{type:"respawn",uid:t.row.uid}},{default:e(()=>[d(i(s(o)("setting.respawn")),1)]),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[a(c,{link:"",type:"primary"},{default:e(()=>[d(i(s(o)("setting.button.actions"))+" ",1),a(A,{class:"el-icon--right"},{default:e(()=>[a(_)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])):(u(),m(Ce,{key:1,title:s(o)("setting.noPlayersFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1})]),_:1},8,["label"]),a(P,{label:s(o)("setting.adminList"),name:"adminList"},{default:e(()=>[a(I,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[p("div",We,[d(i(s(o)("setting.adminList"))+" ",1),p("div",null,[a(c,{size:"default",onClick:l[1]||(l[1]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[a(Q,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(i(s(o)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),p("div",Je,[(u(!0),$(Z,null,ee(F.value,t=>(u(),m(v,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("admin","delete",t)},{default:e(()=>[d(i(t+j(t)),1)]),_:2},1032,["effect","onClose"]))),256)),D.value?(u(),m(X,{key:0,ref_key:"InputRef",ref:T,modelValue:h.value,"onUpdate:modelValue":l[2]||(l[2]=t=>h.value=t),placeholder:s(o)("setting.uidPlaceholder"),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[3]||(l[3]=te(t=>z("admin"),["enter"])),onBlur:l[4]||(l[4]=t=>z("admin"))},null,8,["modelValue","placeholder"])):(u(),m(c,{key:1,onClick:O,style:{margin:"5px 5px 0 0"}},{default:e(()=>[d(i(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])]),_:1})]),_:1},8,["label"]),a(P,{label:s(o)("setting.blockList"),name:"blockList"},{default:e(()=>[a(I,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[p("div",Oe,[d(i(s(o)("setting.blockList"))+" ",1),p("div",null,[a(c,{type:"success",onClick:he},{default:e(()=>[d(i(s(o)("setting.blockListItems.uploadButton")),1)]),_:1}),a(c,{size:"default",onClick:l[5]||(l[5]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[p("div",null,[a(Q,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(i(s(o)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),p("div",Qe,[(u(!0),$(Z,null,ee(U.value,t=>(u(),m(v,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("block","delete",t)},{default:e(()=>[d(i(t+j(t)),1)]),_:2},1032,["effect","onClose"]))),256)),D.value?(u(),m(X,{key:0,ref_key:"InputRef",ref:T,modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=t=>h.value=t),placeholder:s(o)("setting.uidPlaceholder"),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[7]||(l[7]=te(t=>z("block"),["enter"])),onBlur:l[8]||(l[8]=t=>z("block"))},null,8,["modelValue","placeholder"])):(u(),m(c,{key:1,onClick:O,style:{margin:"5px 5px 0 0"}},{default:e(()=>[d(i(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])]),_:1})]),_:1},8,["label"]),a(P,{label:s(o)("setting.whiteList"),name:"whiteList"},{default:e(()=>[a(I,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[p("div",Xe,[d(i(s(o)("setting.whiteList"))+" ",1),p("div",null,[a(c,{size:"default",onClick:l[9]||(l[9]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[p("div",null,[a(Q,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(i(s(o)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),p("div",Ye,[(u(!0),$(Z,null,ee(R.value,t=>(u(),m(v,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("white","delete",t)},{default:e(()=>[d(i(t+j(t)),1)]),_:2},1032,["effect","onClose"]))),256)),D.value?(u(),m(X,{key:0,ref_key:"InputRef",ref:T,modelValue:h.value,"onUpdate:modelValue":l[10]||(l[10]=t=>h.value=t),placeholder:s(o)("setting.uidPlaceholder"),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[11]||(l[11]=te(t=>z("white"),["enter"])),onBlur:l[12]||(l[12]=t=>z("white"))},null,8,["modelValue","placeholder"])):(u(),m(c,{key:1,onClick:O,style:{margin:"5px 5px 0 0"}},{default:e(()=>[d(i(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])]),_:1})]),_:1},8,["label"]),a(P,{label:s(o)("setting.historyPlayer"),name:"history"},{default:e(()=>[a(I,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[p("div",Ze,[a(xe,{content:s(o)("setting.historyPlayerTip"),effect:"light",placement:"top"},{default:e(()=>[p("div",et,[d(i(s(o)("setting.historyPlayer"))+" ",1),a(A,null,{default:e(()=>[a(s(Ae))]),_:1})])]),_:1},8,["content"]),p("div",null,[a(c,{size:"default",type:"danger",onClick:we},{default:e(()=>[d(i(s(o)("setting.historyClean")),1)]),_:1}),a(c,{size:"default",onClick:l[13]||(l[13]=t=>W(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[me((u(),m(re,{ref:"tableRef",data:H.value,"max-height":s(_e)?450:550,border:""},{default:e(()=>[a(r,{label:n.$t("setting.nickName"),prop:"nickname"},null,8,["label"]),a(r,{label:n.$t("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab?(u(),m(v,{key:0,type:"success"},{default:e(()=>[d(i(t.row.prefab),1)]),_:2},1024)):(u(),m(v,{key:1,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(r,{label:n.$t("setting.age"),prop:"age",sortable:""},{default:e(t=>[t.row.age?(u(),m(v,{key:0,type:"success"},{default:e(()=>[d(i(t.row.age),1)]),_:2},1024)):(u(),m(v,{key:1,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(r,{label:"UID",prop:"uid"}),a(r,{label:n.$t("setting.button.actions"),prop:"actions"},{default:e(t=>[a(ue,{trigger:"hover",onCommand:ie},{dropdown:e(()=>[a(de,null,{default:e(()=>[a(y,{command:{type:"admin",uid:t.row.uid},disabled:E(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(y,{command:{type:"block",uid:t.row.uid},disabled:ne(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(y,{command:{type:"white",uid:t.row.uid},disabled:oe(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addWhite")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[a(c,{link:"",type:"primary"},{default:e(()=>[d(i(s(o)("setting.button.actions"))+" ",1),a(A,{class:"el-icon--right"},{default:e(()=>[a(_)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","max-height"])),[[ce,G.value]])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(Ne,{modelValue:S.value,"onUpdate:modelValue":l[15]||(l[15]=t=>S.value=t),"close-on-click-modal":!x.value,"close-on-press-escape":!x.value,"show-close":!x.value,title:s(o)("setting.blockListItems.uploadButton"),width:"45%"},{default:e(()=>[me((u(),m(Ve,{ref_key:"uploadRef",ref:J,"before-upload":ye,"http-request":be,limit:1,drag:""},{tip:e(()=>[p("div",lt,i(s(o)("setting.blockListItems.tips")),1)]),default:e(()=>[a(A,{class:"el-icon--upload"},{default:e(()=>[a(s(qe))]),_:1}),p("div",tt,[d(i(s(o)("setting.import.dialog.text1"))+" ",1),p("em",null,i(s(o)("setting.import.dialog.text2")),1)])]),_:1})),[[ce,x.value]])]),_:1},8,["modelValue","close-on-click-modal","close-on-press-escape","show-close","title"])])}}});export{ot as default};
